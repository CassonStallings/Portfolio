(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[125,124],{1128:function(e,t,i){"use strict";i.r(t);var a=i(9),g=i.n(a),a=i(877),m=i.n(a),a=i(1),s=i.n(a);t.default=class{constructor(e,t,i,a,s,o,r,n){this.title=this.sanitizeTitle(e,t),this.shouldUseDisplayPath=n||!1,this.adZone=this.buildAdZone(),this.adTag=this.buildAdURL(i,a,s,o,r)}getParameterByName(e){let t=e;e=window.location.href;t=t.replace(/[[\]]/g,"\\$&");e=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);return e?e[2]?decodeURIComponent(e[2].replace(/\+/g," ")):"":null}buildAdURL(e,t,i,a,s){var o=this.getParameterByName("adzone"),r=this.getParameterByName("cms"),n=this.getParameterByName("cid")||"0";let d=`video_tags%3D__item-tags__%26vport%3D${this.getViewport()}%26video_id%3D__item-mediaid__`;if(g.a&&(o&&(this.adZone="/4160/mv.fc/"+o),r&&(d=d+"%26cms%3D"+r),n)&&(d=d+"%26CID%3D"+n),d=e?d+"%26adslot%3D"+e:d+"%26adslot%3Dpreroll_"+this.title,t?(o=t.split(" ")[0],r=m()(o)?Number(o):o,d=d+"%26artLength%3D"+r):d+="%26artLength%3DNA",i&&(d=d+"%26pos%3D"+i),a&&(d+="%26firstimp%3Dtrue"),window.top.moatPrebidApi){var l=window.top.moatPrebidApi.getMoatTargetingForPage();let e="";for(const h in l)e+=`${h}=${l[h]}&`;(e=e.split("")).pop(),e=e.join(""),e=encodeURIComponent(e),d=d+"%26"+e}if(window.localStorage){n=window.localStorage.getItem("bcDFPTargetingParams");if(n){e=JSON.parse(n);const c=[];e.forEach(e=>c.push(e.key+"%3D"+e.value)),c.length&&(d=d+"%26"+c.join("%26"))}}if(window.googletag&&(t=window.googletag.pubads().getTargeting("bmb")).length&&(d=d+"%26bmb%3d"+t.join(",")),d+=`%26chn=${null==(o=window)||null==(o=o.digitalData)||null==(o=o.ads)||null==(o=o.targeting)||null==(o=o.chn)?void 0:o[0]}%26schn=${null==(r=window)||null==(r=r.digitalData)||null==(r=r.ads)||null==(r=r.targeting)||null==(r=r.schn)?void 0:r[0]}%26tags=`+(null==(i=window)||null==(i=i.digitalData)||null==(i=i.ads)||null==(i=i.targeting)||null==(i=i.tags)?void 0:i[0]),"object"==typeof s&&0<Object.keys(s).length&&!1!==s){let e="";for(const p in s)e+=`${p}=${s[p]}&`;(e=e.split("")).pop(),e=e.join(""),e=encodeURIComponent(e),d=d+"%26"+e}return`//pubads.g.doubleclick.net/gampad/ads?sz=640x360&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&vad_type=linear&vpos=preroll&cms=${this.constructCMSHash()}&iu=${this.adZone}&cust_params=`+d}constructCMSHash(){var e=this.getParameterByName("cms");if(e)return e;var t,i=document.location.href;let a=0,s;if(i&&0!==i.length){for(s=0;s<i.length;s++)t=i.charCodeAt(s),a=(a<<5)-a+t,a&=a;a=(a=Math.abs(a)).toString(36)}return a}sanitizeTitle(e,t){if(t)return t;switch(!0){case null!==e.match(/Homepage/):return"homepage";case null!==e.match(/Infinite/):return"infinitescroll";default:return"homepage"}}buildAdZone(){let e="/4160/mv.fc";return e=this.shouldUseDisplayPath?(s()(window.digitalData,"ads.adPath")||e)+"/preroll_"+this.title:e+"/__item-category__/__item-series__/preroll_"+this.title}getViewport(){var e;return g.a?1023<(e=window.innerWidth)?"l":e<640?"s":"m":"undefined"}}},1131:function(e,t,i){"use strict";i.r(t),i.d(t,"default",function(){return w});var a=i(9),t=i(0),o=i.n(t),s=i(2),s=i.n(s),r=i(1),n=i.n(r),r=i(869),d=i.n(r),r=i(51),l=i.n(r),r=i(873),h=i.n(r),c=i(1128),p=i(62),g=i(1124),m=i(142),u=i(6);let y=!1,v=!1;a.canUseDOM&&(y=i(113),v=i(874));class w extends t.Component{constructor(){super(),this.state={playingIndex:0,activeTitle:"",userIsActive:!0,firstimp:!1,adDataForMoat:null,calledMoatEventTrackerMarker:{}},this.videoContainerRef=o.a.createRef(),this.MoatApiReference=null,this.adPosition=0,this.lastKnownPlaybackPosition=0,this.lastSystemClock=0,this.mediaInfo={},this.customVideoMetadata={},this.sessionStarted=!1,this.playSent=!1,this.adsPlaying=!1,this.videoCardClick=this.videoCardClick.bind(this),this.generatePreRoll=this.generatePreRoll.bind(this),this.setMoatTracking=this.setMoatTracking.bind(this),this.getVideoImage=this.getVideoImage.bind(this),this.getVideoList=this.getVideoList.bind(this),this.setNextVideo=this.setNextVideo.bind(this),this.onVideoLoad=this.onVideoLoad.bind(this),this.generateShareLink=this.generateShareLink.bind(this),this.onReady=this.onReady.bind(this),this.trackMoatVideoProgress=this.trackMoatVideoProgress.bind(this)}componentDidMount(){this.setState({settings:{arrows:!1,infinite:!1,responsive:[{breakpoint:1024,settings:{slidesToShow:2.3,slidesToScroll:2,slide:".video-slide"}},{breakpoint:1e5,settings:"unslick"}]}}),y&&y(["https://z.moatads.com/jwplayerplugin0938452/moatplugin.js"]),v&&(v.setIdleDuration(5),v.on("idle",()=>{this.setState({userIsActive:!1})}),v.on("wakeup",()=>{this.setState({userIsActive:!0})}))}shouldComponentUpdate(e,t){var i=!this.state.settings,a=this.state.playingIndex!==t.playingIndex,t=this.state.activeTitle!==t.activeTitle;return i||a||t}componentWillUnmount(){a.canUseDOM&&(window.moatjw&&window.moatjw.removeAll(),v)&&(v.off("idle"),v.off("wakeup"))}onVideoLoad(e){this.setState({activeTitle:n()(e,"item.title")})}onReady(){var e=this.props["playerid"];const a=window.jwplayer(e);e=a.getMute()?1:0;(this.player=a).setCurrentCaptions(e),a.on("playlistItem",()=>{var e=this.props["config"];this.customVideoMetadata={playerDimensions:a.getContainer().offsetWidth+"x"+a.getContainer().offsetHeight,abgroup:n()(e,"abgroup","null")},this.lastKnownPlaybackPosition=0,this.lastSystemClock=0,this.playSent=!1}),a.on("beforePlay",()=>{0!==a.getPosition()||this.sessionStarted||(this.sessionStarted=!0)}),a.on("firstFrame",()=>{this.playSent||(this.PlaySent=!0)}),a.on("time",e=>{var t=new Date,t=(this.lastSystemClock=t.getTime(),this.lastKnownPlaybackPosition=e.position,Math.floor(100*e.position/e.duration)),i={};switch(t){case 1:this.state.calledMoatEventTrackerMarker.AdVideoStart||(this.trackMoatVideoProgress("AdVideoStart",a,e),i.AdVideoStart=!0,this.setState({calledMoatEventTrackerMarker:i}));break;case 25:this.state.calledMoatEventTrackerMarker.AdVideoFirstQuartile||(this.trackMoatVideoProgress("AdVideoFirstQuartile",a,e),i.AdVideoFirstQuartile=!0,this.setState({calledMoatEventTrackerMarker:i}));break;case 50:this.state.calledMoatEventTrackerMarker.AdVideoMidpoint||(this.trackMoatVideoProgress("AdVideoMidpoint",a,e),i.AdVideoMidpoint=!0,this.setState({calledMoatEventTrackerMarker:i}));break;case 75:this.state.calledMoatEventTrackerMarker.AdVideoThirdQuartile||(this.trackMoatVideoProgress("AdVideoThirdQuartile",a,e),i.AdVideoThirdQuartile=!0,this.setState({calledMoatEventTrackerMarker:i}));break;case 99:this.state.calledMoatEventTrackerMarker.AdVideoComplete||(this.trackMoatVideoProgress("AdVideoComplete",a,e),i.AdVideoComplete=!0,this.setState({calledMoatEventTrackerMarker:i}))}}),a.on("adTime",e=>{var t=new Date;this.lastSystemClock=t.getTime(),this.lastKnownPlaybackPosition=e.position}),a.on("seek",()=>{}),a.on("seeked",()=>{this.lastKnownPlaybackPosition=a.getPosition()}),a.on("pause",e=>{this.trackMoatVideoProgress("AdPaused",a,e)}),a.on("play",e=>{this.adsPlaying&&(this.adsPlaying=!1),this.trackMoatVideoProgress("AdPlaying",a,e)}),a.on("complete",()=>{this.adsPlaying&&(this.adsPlaying=!1),this.resetSession(),this.state.userIsActive||a.stop(),this.setState({firstimp:!1}),this.state.userIsActive||a.stop()}),a.on("buffer",()=>{}),a.on("bufferFull",()=>{}),a.on("error",()=>{this.resetSession()}),a.on("setupError",()=>{this.resetSession()}),a.on("adImpression",e=>{var t=n()(e,"adtitle","unknown-title"),i=n()(e,"ima.ad.g.adWrapperCreativeIds[0]","unknown-wrapper-creative-id"),a=n()(e,"ima.ad.g.adWrapperIds[0]","unknown-wrapper-id"),e=n()(e,"ima.ad.g.creativeId","unknown-creative-id");this.adStartBreak(t+` | ${i} | ${a} | `+e,this.adPosition,this.lastKnownPlaybackPosition),this.playSent||(this.playSent=!0),this.adsPlaying=!0}),a.on("adPlay",()=>{this.playSent||(this.playSent=!0)}),a.on("adStarted",()=>{}),a.on("adSkipped",()=>{this.adsPlaying=!1}),a.on("adComplete",()=>{}),a.on("adBreakEnd",()=>{this.adsPlaying&&(this.adsPlaying=!1)}),a.on("remove",()=>{this.sessionStarted&&this.resetSession()}),this.setMoatTracking(a)}getVideoImage(e){return e?"https://images.fastcompany.net/image/fetch/w_280,ar_16:9,c_fill,g_auto,q_auto,f_auto,fl_lossy/"+e:""}getVideoList(){var e=this.props["stories"];return e.map((e,t)=>({id:e.mediaid,title:e.title,link:e.link,featured_image:{source:this.getVideoImage(n()(e,"image"))},isPlayerVideo:!0,isVideoActive:this.state.playingIndex===t,index:t}))}setMoatTracking(t){a.canUseDOM&&window.moatjw&&t.on("adImpression",e=>{window.moatjw.add({partnerCode:"mansuetojwint127635890115",player:t,adImpressionEvent:e})})}setNextVideo(){var e=this.state.playingIndex+1;this.setState({playingIndex:e})}resetSession(){this.sessionStarted=!1,this.playSent=!1}adStartBreak(){this.adsPlaying?this.adPosition=this.adPosition+1:(this.adsPlaying=!0,this.adPosition=0)}trackMoatVideoProgress(e,t,i){this.MoatApiReference||(this.MoatApiReference=window.initMoatTracking(this.videoContainerRef.current,this.state.adDataForMoat,i.duration,"mansuetojwcontent613342534978",null)),this.MoatApiReference.dispatchEvent({type:e,adVolume:t.getMute()?0:(t.getVolume()/100).toFixed(1)})}generatePreRoll(){var{data:e,type:t,pos:i,readTime:a}=this.props,s=n()(this.props,"customparams",!1);return l.a.get("dailycookie")||this.state.alreadySawFirstImpression||this.setState({firstimp:!0,alreadySawFirstImpression:!0}),new c.default(n()(e,"title"),t,"preroll_rightrail",a,i,this.state.firstimp,s).adTag}videoCardClick(e,t){var i=this.props["playerid"],i=window.jwplayer(i),a=i.getMute()?1:0;this.setState({playingIndex:t}),i.playlistItem(t),i.setCurrentCaptions(a)}generateShareLink(e){return`https://www.fastcompany.com/video/${Object(m.b)(n()(e.playlist[this.state.playingIndex],"title"))}/`+n()(e.playlist[this.state.playingIndex],"mediaid")}renderSlides(){var e,t=this.state["settings"];const i=this.props["config"];return t?(e=this.getVideoList(),o.a.createElement("div",{className:"video-module-playlist"},o.a.createElement(d.a,t,e.map((e,t)=>o.a.createElement("div",{className:"video-slide video-slide--vertical",key:""+e.id+t},o.a.createElement(g.default,{type:"video",config:i,metadata:e,cardEvent:this.videoCardClick,hasLink:!1,defaultHeight:158,defaultWidth:280})))))):null}render(){var{slugName:e,isPost:t,data:i,playerid:a,hideHeader:s}=this.props;return o.a.createElement("section",{className:"video-row "+(t?"video-row--post":"")},!s&&o.a.createElement(p.default,{linkTo:"//fastcompany.com/videos",slugName:e}),o.a.createElement("div",{className:"video-module"},o.a.createElement("div",{className:"video-module__player-container",ref:this.videoContainerRef},o.a.createElement(h.a,{playerId:a,customProps:{sharing:{link:this.generateShareLink(i)}},playerScript:`https://content.jwplatform.com/libraries/${a}.js`,playlist:`//content.jwplatform.com/feeds/${i.feedid}.json`,generatePrerollUrl:this.generatePreRoll,onReady:this.onReady,playInView:!0,onVideoLoad:this.onVideoLoad,onOneHundredPercent:this.setNextVideo,onError:e=>{u.a.error("Siderail ReactJW Video Player Error",n()(e,"message"))},onSetupError:e=>{u.a.error("Siderail ReactJW Video Player Error",n()(e,"message"))},isMuted:!0,isAutoPlay:!1,playInViewPercentage:100,aspectRatio:"16:9"})),o.a.createElement("div",{className:"video-module__title"},this.state.activeTitle)),this.renderSlides())}}w.defaultProps={stories:[],data:{},slugName:"Video",isPost:!1,readTime:null,type:"",pos:"",customparams:{},hideHeader:!1},w.propTypes={config:s.a.shape({}).isRequired,stories:s.a.arrayOf(s.a.shape({})),data:s.a.shape({}),playerid:s.a.string.isRequired,slugName:s.a.string,isPost:s.a.bool,type:s.a.string,pos:s.a.string,readTime:s.a.string,customparams:s.a.shape({}),hideHeader:s.a.bool}}}]);
//# sourceMappingURL=components-video_module-video_module.f08f69ddb14cbe726ee9.js.map