// For license information, see `https://assets.adobedtm.com/a2ef59fba8e9/d6969c3828c3/launch-1ee49e3e9eb5.js`.
window._satellite=window._satellite||{},window._satellite.container={buildInfo:{minified:!0,buildDate:"2024-03-18T21:04:46Z",turbineBuildDate:"2023-02-22T20:37:26Z",turbineVersion:"27.5.0"},environment:{id:"EN9fa5cca716594d11b0e7497aa3214e6b",stage:"production"},dataElements:{},extensions:{core:{displayName:"Core",hostedLibFilesBaseUrl:"https://assets.adobedtm.com/extensions/EPd22815afd48447aa955be6a3a012e3b5/",modules:{"core/src/lib/events/libraryLoaded.js":{name:"library-loaded",displayName:"Library Loaded (Page Top)",script:function(e,t,n){"use strict";var a=n("./helpers/pageLifecycleEvents");e.exports=function(e,t){a.registerLibraryLoadedTrigger(t)}}},"core/src/lib/actions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(e,t,n,a){"use strict";var i,r,o,s,c=n("@adobe/reactor-document"),l=n("@adobe/reactor-promise"),d=n("./helpers/decorateCode"),u=n("./helpers/loadCodeSequentially"),p=n("../../../node_modules/postscribe/dist/postscribe"),g=n("./helpers/unescapeHtmlCode"),h=n("../helpers/findPageScript").getTurbine,_=(r=function(e){p(c.body,e,{beforeWriteToken:function(e){var t=e.tagName&&e.tagName.toLowerCase();return i&&"script"===t&&(e.attrs.nonce=i),"script"!==t&&"style"!==t||(Object.keys(e.attrs||{}).forEach((function(t){e.attrs[t]=g(e.attrs[t])})),e.src&&(e.src=g(e.src))),e},error:function(e){a.logger.error(e.msg)}})},o=[],s=function(){if(c.body)for(;o.length;)r(o.shift());else setTimeout(s,20)},function(e){o.push(e),s()}),f=function(){if(c.currentScript)return c.currentScript.async;var e=h();return!e||e.async}();e.exports=function(e,t){var n;i=a.getExtensionSettings().cspNonce;var r={settings:e,event:t},o=r.settings.source;if(o)return r.settings.isExternal?u(o).then((function(e){return e?(n=d(r,e),_(n.code),n.promise):l.resolve()})):(n=d(r,o),f||"loading"!==c.readyState?_(n.code):c.write&&!1===a.propertySettings.ruleComponentSequencingEnabled?c.write(n.code):_(n.code),n.promise)}}},"core/src/lib/conditions/path.js":{name:"path",displayName:"Path Without Query String",script:function(e,t,n){"use strict";var a=n("@adobe/reactor-document"),i=n("../helpers/textMatch");e.exports=function(e){var t=a.location.pathname;return e.paths.some((function(e){var n=e.valueIsRegex?new RegExp(e.value,"i"):e.value;return i(t,n)}))}}},"core/src/lib/conditions/domain.js":{name:"domain",displayName:"Domain",script:function(e,t,n){"use strict";var a=n("@adobe/reactor-document"),i=/[|\\{}()[\]^$+*?.-]/g,r=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(i,"\\$&")};e.exports=function(e){var t=a.location.hostname;return e.domains.some((function(e){return t.match(new RegExp("(^|\\.)"+r(e)+"$","i"))}))}}},"core/src/lib/conditions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(e){"use strict";e.exports=function(e,t){return e.source.call(t.element,t,t.target)}}},"core/src/lib/conditions/pathAndQuerystring.js":{name:"path-and-querystring",displayName:"Path And Query String",script:function(e,t,n){"use strict";var a=n("@adobe/reactor-document"),i=n("../helpers/textMatch");e.exports=function(e){var t=a.location.pathname+a.location.search;return e.paths.some((function(e){var n=e.valueIsRegex?new RegExp(e.value,"i"):e.value;return i(t,n)}))}}},"core/src/lib/events/helpers/pageLifecycleEvents.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-window"),i=n("@adobe/reactor-document"),r=-1!==a.navigator.appVersion.indexOf("MSIE 10"),o="WINDOW_LOADED",s="DOM_READY",c="PAGE_BOTTOM",l=[c,s,o],d=function(e,t){return{element:e,target:e,nativeEvent:t}},u={};l.forEach((function(e){u[e]=[]}));var p=function(e,t){l.slice(0,h(e)+1).forEach((function(e){_(t,e)}))},g=function(){return"complete"===i.readyState?o:"interactive"===i.readyState?r?null:s:void 0},h=function(e){return l.indexOf(e)},_=function(e,t){u[t].forEach((function(t){f(e,t)})),u[t]=[]},f=function(e,t){var n=t.trigger,a=t.syntheticEventFn;n(a?a(e):null)};a._satellite=a._satellite||{},a._satellite.pageBottom=p.bind(null,c),i.addEventListener("DOMContentLoaded",p.bind(null,s),!0),a.addEventListener("load",p.bind(null,o),!0),a.setTimeout((function(){var e=g();e&&p(e)}),0),e.exports={registerLibraryLoadedTrigger:function(e){e()},registerPageBottomTrigger:function(e){u[c].push({trigger:e})},registerDomReadyTrigger:function(e){u[s].push({trigger:e,syntheticEventFn:d.bind(null,i)})},registerWindowLoadedTrigger:function(e){u[o].push({trigger:e,syntheticEventFn:d.bind(null,a)})}}}},"core/src/lib/actions/helpers/decorateCode.js":{script:function(e,t,n){"use strict";var a=n("./decorators/decorateGlobalJavaScriptCode"),i=n("./decorators/decorateNonGlobalJavaScriptCode"),r={javascript:function(e,t){return e.settings.global?a(e,t):i(e,t)},html:n("./decorators/decorateHtmlCode")};e.exports=function(e,t){return r[e.settings.language](e,t)}}},"core/src/lib/actions/helpers/loadCodeSequentially.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-promise"),i=n("./getSourceByUrl"),r=a.resolve();e.exports=function(e){var t=new a((function(t){var n=i(e);a.all([n,r]).then((function(e){var n=e[0];t(n)}))}));return r=t,t}}},"core/node_modules/postscribe/dist/postscribe.js":{script:function(e,t){var n,a;n=this,a=function(){return function(e){function t(a){if(n[a])return n[a].exports;var i=n[a]={exports:{},id:a,loaded:!1};return e[a].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var i=a(n(1));e.exports=i.default},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function r(){}function o(){var e=h.shift();if(e){var t=u.last(e);t.afterDequeue(),e.stream=s.apply(void 0,e),t.afterStreamStart()}}function s(e,t,n){function a(e){e=n.beforeWrite(e),_.write(e),n.afterWrite(e)}(_=new d.default(e,n)).id=g++,_.name=n.name||_.id,c.streams[_.name]=_;var i=e.ownerDocument,s={close:i.close,open:i.open,write:i.write,writeln:i.writeln};l(i,{close:r,open:r,write:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return a(t.join(""))},writeln:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return a(t.join("")+"\n")}});var u=_.win.onerror||r;return _.win.onerror=function(e,t,a){n.error({msg:e+" - "+t+": "+a}),u.apply(_.win,[e,t,a])},_.write(t,(function(){l(i,s),_.win.onerror=u,n.done(),_=null,o()})),_}function c(e,t,n){if(u.isFunction(n))n={done:n};else if("clear"===n)return h=[],_=null,void(g=0);n=u.defaults(n,p);var a=[e=/^#/.test(e)?window.document.getElementById(e.substr(1)):e.jquery?e[0]:e,t,n];return e.postscribe={cancel:function(){a.stream?a.stream.abort():a[1]=r}},n.beforeEnqueue(a),h.push(a),_||o(),e.postscribe}t.__esModule=!0;var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.default=c;var d=i(n(2)),u=a(n(4)),p={afterAsync:r,afterDequeue:r,afterStreamStart:r,afterWrite:r,autoFix:!0,beforeEnqueue:r,beforeWriteToken:function(e){return e},beforeWrite:function(e){return e},done:r,error:function(e){throw new Error(e.msg)},releaseAsync:!1},g=0,h=[],_=null;l(c,{streams:{},queue:h,WriteStream:d.default})},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var n=p+t,a=e.getAttribute(n);return d.existy(a)?String(a):a}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=p+t;d.existy(n)&&""!==n?e.setAttribute(a,n):e.removeAttribute(a)}t.__esModule=!0;var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},l=i(n(3)),d=a(n(4)),u=!1,p="data-ps-",g="ps-style",h="ps-script",_=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e),this.root=t,this.options=n,this.doc=t.ownerDocument,this.win=this.doc.defaultView||this.doc.parentWindow,this.parser=new l.default("",{autoFix:n.autoFix}),this.actuals=[t],this.proxyHistory="",this.proxyRoot=this.doc.createElement(t.nodeName),this.scriptStack=[],this.writeQueue=[],s(this.proxyRoot,"proxyof",0)}return e.prototype.write=function(){var e;for((e=this.writeQueue).push.apply(e,arguments);!this.deferredRemote&&this.writeQueue.length;){var t=this.writeQueue.shift();d.isFunction(t)?this._callFunction(t):this._writeImpl(t)}},e.prototype._callFunction=function(e){var t={type:"function",value:e.name||e.toString()};this._onScriptStart(t),e.call(this.win,this.doc),this._onScriptDone(t)},e.prototype._writeImpl=function(e){this.parser.append(e);for(var t=void 0,n=void 0,a=void 0,i=[];(t=this.parser.readToken())&&!(n=d.isScript(t))&&!(a=d.isStyle(t));)(t=this.options.beforeWriteToken(t))&&i.push(t);i.length>0&&this._writeStaticTokens(i),n&&this._handleScriptToken(t),a&&this._handleStyleToken(t)},e.prototype._writeStaticTokens=function(e){var t=this._buildChunk(e);return t.actual?(t.html=this.proxyHistory+t.actual,this.proxyHistory+=t.proxy,this.proxyRoot.innerHTML=t.html,u&&(t.proxyInnerHTML=this.proxyRoot.innerHTML),this._walkChunk(),u&&(t.actualInnerHTML=this.root.innerHTML),t):null},e.prototype._buildChunk=function(e){for(var t=this.actuals.length,n=[],a=[],i=[],r=e.length,o=0;o<r;o++){var s=e[o],c=s.toString();if(n.push(c),s.attrs){if(!/^noscript$/i.test(s.tagName)){var l=t++;a.push(c.replace(/(\/?>)/," "+p+"id="+l+" $1")),s.attrs.id!==h&&s.attrs.id!==g&&i.push("atomicTag"===s.type?"":"<"+s.tagName+" "+p+"proxyof="+l+(s.unary?" />":">"))}}else a.push(c),i.push("endTag"===s.type?c:"")}return{tokens:e,raw:n.join(""),actual:a.join(""),proxy:i.join("")}},e.prototype._walkChunk=function(){for(var e=void 0,t=[this.proxyRoot];d.existy(e=t.shift());){var n=1===e.nodeType;if(!n||!o(e,"proxyof")){n&&(this.actuals[o(e,"id")]=e,s(e,"id"));var a=e.parentNode&&o(e.parentNode,"proxyof");a&&this.actuals[a].appendChild(e)}t.unshift.apply(t,d.toArray(e.childNodes))}},e.prototype._handleScriptToken=function(e){var t=this,n=this.parser.clear();n&&this.writeQueue.unshift(n),e.src=e.attrs.src||e.attrs.SRC,(e=this.options.beforeWriteToken(e))&&(e.src&&this.scriptStack.length?this.deferredRemote=e:this._onScriptStart(e),this._writeScriptToken(e,(function(){t._onScriptDone(e)})))},e.prototype._handleStyleToken=function(e){var t=this.parser.clear();t&&this.writeQueue.unshift(t),e.type=e.attrs.type||e.attrs.TYPE||"text/css",(e=this.options.beforeWriteToken(e))&&this._writeStyleToken(e),t&&this.write()},e.prototype._writeStyleToken=function(e){var t=this._buildStyle(e);this._insertCursor(t,g),e.content&&(t.styleSheet&&!t.sheet?t.styleSheet.cssText=e.content:t.appendChild(this.doc.createTextNode(e.content)))},e.prototype._buildStyle=function(e){var t=this.doc.createElement(e.tagName);return t.setAttribute("type",e.type),d.eachKey(e.attrs,(function(e,n){t.setAttribute(e,n)})),t},e.prototype._insertCursor=function(e,t){this._writeImpl('<span id="'+t+'"/>');var n=this.doc.getElementById(t);n&&n.parentNode.replaceChild(e,n)},e.prototype._onScriptStart=function(e){e.outerWrites=this.writeQueue,this.writeQueue=[],this.scriptStack.unshift(e)},e.prototype._onScriptDone=function(e){e===this.scriptStack[0]?(this.scriptStack.shift(),this.write.apply(this,e.outerWrites),!this.scriptStack.length&&this.deferredRemote&&(this._onScriptStart(this.deferredRemote),this.deferredRemote=null)):this.options.error({msg:"Bad script nesting or script finished twice"})},e.prototype._writeScriptToken=function(e,t){var n=this._buildScript(e),a=this._shouldRelease(n),i=this.options.afterAsync;e.src&&(n.src=e.src,this._scriptLoadHandler(n,a?i:function(){t(),i()}));try{this._insertCursor(n,h),n.src&&!a||t()}catch(e){this.options.error(e),t()}},e.prototype._buildScript=function(e){var t=this.doc.createElement(e.tagName);return d.eachKey(e.attrs,(function(e,n){t.setAttribute(e,n)})),e.content&&(t.text=e.content),t},e.prototype._scriptLoadHandler=function(e,t){function n(){e=e.onload=e.onreadystatechange=e.onerror=null}function a(){n(),null!=t&&t(),t=null}function i(e){n(),o(e),null!=t&&t(),t=null}function r(e,t){var n=e["on"+t];null!=n&&(e["_on"+t]=n)}var o=this.options.error;r(e,"load"),r(e,"error"),c(e,{onload:function(){if(e._onload)try{e._onload.apply(this,Array.prototype.slice.call(arguments,0))}catch(t){i({msg:"onload handler failed "+t+" @ "+e.src})}a()},onerror:function(){if(e._onerror)try{e._onerror.apply(this,Array.prototype.slice.call(arguments,0))}catch(t){return void i({msg:"onerror handler failed "+t+" @ "+e.src})}i({msg:"remote script failed "+e.src})},onreadystatechange:function(){/^(loaded|complete)$/.test(e.readyState)&&a()}})},e.prototype._shouldRelease=function(e){return!/^script$/i.test(e.nodeName)||!!(this.options.releaseAsync&&e.src&&e.hasAttribute("async"))},e}();t.default=_},function(e){var t;t=function(){return function(e){function t(a){if(n[a])return n[a].exports;var i=n[a]={exports:{},id:a,loaded:!1};return e[a].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var i=a(n(1));e.exports=i.default},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=i(n(2)),s=i(n(3)),c=a(n(6)),l=n(5),d={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,startTag:/^</,chars:/^[^<]/},u=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e),this.stream=n;var i=!1,s={};for(var l in o)o.hasOwnProperty(l)&&(a.autoFix&&(s[l+"Fix"]=!0),i=i||s[l+"Fix"]);i?(this._readToken=(0,c.default)(this,s,(function(){return t._readTokenImpl()})),this._peekToken=(0,c.default)(this,s,(function(){return t._peekTokenImpl()}))):(this._readToken=this._readTokenImpl,this._peekToken=this._peekTokenImpl)}return e.prototype.append=function(e){this.stream+=e},e.prototype.prepend=function(e){this.stream=e+this.stream},e.prototype._readTokenImpl=function(){var e=this._peekTokenImpl();if(e)return this.stream=this.stream.slice(e.length),e},e.prototype._peekTokenImpl=function(){for(var e in d)if(d.hasOwnProperty(e)&&d[e].test(this.stream)){var t=s[e](this.stream);if(t)return"startTag"===t.type&&/script|style/i.test(t.tagName)?null:(t.text=this.stream.substr(0,t.length),t)}},e.prototype.peekToken=function(){return this._peekToken()},e.prototype.readToken=function(){return this._readToken()},e.prototype.readTokens=function(e){for(var t=void 0;t=this.readToken();)if(e[t.type]&&!1===e[t.type](t))return},e.prototype.clear=function(){var e=this.stream;return this.stream="",e},e.prototype.rest=function(){return this.stream},e}();for(var p in t.default=u,u.tokenToString=function(e){return e.toString()},u.escapeAttributes=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=(0,l.escapeQuotes)(e[n],null));return t},u.supports=o,o)o.hasOwnProperty(p)&&(u.browserHasFlaw=u.browserHasFlaw||!o[p]&&p)},function(e,t){"use strict";t.__esModule=!0;var n=!1,a=!1,i=window.document.createElement("div");try{var r="<P><I></P></I>";i.innerHTML=r,t.tagSoup=n=i.innerHTML!==r}catch(e){t.tagSoup=n=!1}try{i.innerHTML="<P><i><P></P></i></P>",t.selfClose=a=2===i.childNodes.length}catch(e){t.selfClose=a=!1}i=null,t.tagSoup=n,t.selfClose=a},function(e,t,n){"use strict";function a(e){var t=e.indexOf("-->");if(t>=0)return new l.CommentToken(e.substr(4,t-1),t+3)}function i(e){var t=e.indexOf("<");return new l.CharsToken(t>=0?t:e.length)}function r(e){var t,n,a;if(-1!==e.indexOf(">")){var i=e.match(d.startTag);if(i){var r=(t={},n={},a=i[2],i[2].replace(d.attr,(function(e,i){arguments[2]||arguments[3]||arguments[4]||arguments[5]?arguments[5]?(t[arguments[5]]="",n[arguments[5]]=!0):t[i]=arguments[2]||arguments[3]||arguments[4]||d.fillAttr.test(i)&&i||"":t[i]="",a=a.replace(e,"")})),{v:new l.StartTagToken(i[1],i[0].length,t,n,!!i[3],a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))});if("object"===(void 0===r?"undefined":c(r)))return r.v}}}function o(e){var t=r(e);if(t){var n=e.slice(t.length);if(n.match(new RegExp("</\\s*"+t.tagName+"\\s*>","i"))){var a=n.match(new RegExp("([\\s\\S]*?)</\\s*"+t.tagName+"\\s*>","i"));if(a)return new l.AtomicTagToken(t.tagName,a[0].length+t.length,t.attrs,t.booleanAttrs,a[1])}}}function s(e){var t=e.match(d.endTag);if(t)return new l.EndTagToken(t[1],t[0].length)}t.__esModule=!0;var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.comment=a,t.chars=i,t.startTag=r,t.atomicTag=o,t.endTag=s;var l=n(4),d={startTag:/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,endTag:/^<\/([\-A-Za-z0-9_]+)[^>]*>/,attr:/(?:([\-A-Za-z0-9_]+)\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))|(?:([\-A-Za-z0-9_]+)(\s|$)+)/g,fillAttr:/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i}},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0,t.EndTagToken=t.AtomicTagToken=t.StartTagToken=t.TagToken=t.CharsToken=t.CommentToken=t.Token=void 0;var i=n(5),r=(t.Token=function e(t,n){a(this,e),this.type=t,this.length=n,this.text=""},t.CommentToken=function(){function e(t,n){a(this,e),this.type="comment",this.length=n||(t?t.length:0),this.text="",this.content=t}return e.prototype.toString=function(){return"<!--"+this.content},e}(),t.CharsToken=function(){function e(t){a(this,e),this.type="chars",this.length=t,this.text=""}return e.prototype.toString=function(){return this.text},e}(),t.TagToken=function(){function e(t,n,i,r,o){a(this,e),this.type=t,this.length=i,this.text="",this.tagName=n,this.attrs=r,this.booleanAttrs=o,this.unary=!1,this.html5Unary=!1}return e.formatTag=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n="<"+e.tagName;for(var a in e.attrs)if(e.attrs.hasOwnProperty(a)){n+=" "+a;var r=e.attrs[a];void 0!==e.booleanAttrs&&void 0!==e.booleanAttrs[a]||(n+='="'+(0,i.escapeQuotes)(r)+'"')}return e.rest&&(n+=" "+e.rest),e.unary&&!e.html5Unary?n+="/>":n+=">",null!=t&&(n+=t+"</"+e.tagName+">"),n},e}());t.StartTagToken=function(){function e(t,n,i,r,o,s){a(this,e),this.type="startTag",this.length=n,this.text="",this.tagName=t,this.attrs=i,this.booleanAttrs=r,this.html5Unary=!1,this.unary=o,this.rest=s}return e.prototype.toString=function(){return r.formatTag(this)},e}(),t.AtomicTagToken=function(){function e(t,n,i,r,o){a(this,e),this.type="atomicTag",this.length=n,this.text="",this.tagName=t,this.attrs=i,this.booleanAttrs=r,this.unary=!1,this.html5Unary=!1,this.content=o}return e.prototype.toString=function(){return r.formatTag(this,this.content)},e}(),t.EndTagToken=function(){function e(t,n){a(this,e),this.type="endTag",this.length=n,this.text="",this.tagName=t}return e.prototype.toString=function(){return"</"+this.tagName+">"},e}()},function(e,t){"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e?e.replace(/([^"]*)"/g,(function(e,t){return/\\/.test(t)?t+'"':t+'\\"'})):t}t.__esModule=!0,t.escapeQuotes=n},function(e,t){"use strict";function n(e){return e&&"startTag"===e.type&&(e.unary=s.test(e.tagName)||e.unary,e.html5Unary=!/\/>$/.test(e.text)),e}function a(e,t){var a=e.stream,i=n(t());return e.stream=a,i}function i(e,t){var n=t.pop();e.prepend("</"+n.tagName+">")}function r(){var e=[];return e.last=function(){return this[this.length-1]},e.lastTagNameEq=function(e){var t=this.last();return t&&t.tagName&&t.tagName.toUpperCase()===e.toUpperCase()},e.containsTagName=function(e){for(var t,n=0;t=this[n];n++)if(t.tagName===e)return!0;return!1},e}function o(e,t,o){function s(){var t=a(e,o);t&&d[t.type]&&d[t.type](t)}var l=r(),d={startTag:function(n){var a=n.tagName;"TR"===a.toUpperCase()&&l.lastTagNameEq("TABLE")?(e.prepend("<TBODY>"),s()):t.selfCloseFix&&c.test(a)&&l.containsTagName(a)?l.lastTagNameEq(a)?i(e,l):(e.prepend("</"+n.tagName+">"),s()):n.unary||l.push(n)},endTag:function(n){l.last()?t.tagSoupFix&&!l.lastTagNameEq(n.tagName)?i(e,l):l.pop():t.tagSoupFix&&(o(),s())}};return function(){return s(),n(o())}}t.__esModule=!0,t.default=o;var s=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,c=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i}])},e.exports=t()},function(e,t){"use strict";function n(e){return null!=e}function a(e){return"function"==typeof e}function i(e,t,n){var a=void 0,i=e&&e.length||0;for(a=0;a<i;a++)t.call(n,e[a],a)}function r(e,t,n){for(var a in e)e.hasOwnProperty(a)&&t.call(n,a,e[a])}function o(e,t){return e=e||{},r(t,(function(t,a){n(e[t])||(e[t]=a)})),e}function s(e){try{return Array.prototype.slice.call(e)}catch(a){var t=(n=[],i(e,(function(e){n.push(e)})),{v:n});if("object"===(void 0===t?"undefined":p(t)))return t.v}var n}function c(e){return e[e.length-1]}function l(e,t){return!(!e||"startTag"!==e.type&&"atomicTag"!==e.type||!("tagName"in e)||!~e.tagName.toLowerCase().indexOf(t))}function d(e){return l(e,"script")}function u(e){return l(e,"style")}t.__esModule=!0;var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.existy=n,t.isFunction=a,t.each=i,t.eachKey=r,t.defaults=o,t.toArray=s,t.last=c,t.isTag=l,t.isScript=d,t.isStyle=u}])},"object"==typeof t&&"object"==typeof e?e.exports=a():"function"==typeof define&&define.amd?define([],a):"object"==typeof t?t.postscribe=a():n.postscribe=a()}},"core/src/lib/actions/helpers/unescapeHtmlCode.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-document").createElement("div");e.exports=function(e){return a.innerHTML=e,a.textContent||a.innerText||e}}},"core/src/lib/helpers/findPageScript.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-document"),i=function(e){for(var t=a.querySelectorAll("script"),n=0;n<t.length;n++){var i=t[n];if(e.test(i.src))return i}},r=function(){return i(new RegExp(/(launch|satelliteLib)-[^\/]+.js(\?.*)?$/))};e.exports={getTurbine:r,byRegexPattern:i}}},"core/src/lib/actions/helpers/decorators/decorateGlobalJavaScriptCode.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-promise");e.exports=function(e,t){return{code:"<script>\n"+t+"\n</script>",promise:a.resolve()}}}},"core/src/lib/actions/helpers/decorators/decorateNonGlobalJavaScriptCode.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-promise"),i=0;e.exports=function(e,t){var n="_runScript"+ ++i,r=new a((function(t,i){_satellite[n]=function(r){delete _satellite[n],new a((function(t){t(r.call(e.event.element,e.event,e.event.target,a))})).then(t,i)}}));return{code:'<script>_satellite["'+n+'"](function(event, target, Promise) {\n'+t+"\n});</script>",promise:r}}}},"core/src/lib/actions/helpers/decorators/decorateHtmlCode.js":{script:function(e,t,n,a){"use strict";var i=n("@adobe/reactor-promise"),r=0,o={};window._satellite=window._satellite||{},window._satellite._onCustomCodeSuccess=function(e){var t=o[e];t&&(delete o[e],t.resolve())},window._satellite._onCustomCodeFailure=function(e){var t=o[e];t&&(delete o[e],t.reject())};var s=function(e){return-1!==e.indexOf("${reactorCallbackId}")},c=function(e,t){return e.replace(/\${reactorCallbackId}/g,t)},l=function(e){return e.settings.isExternal};e.exports=function(e,t){var n;return l(e)&&(t=a.replaceTokens(t,e.event)),s(t)?(n=new i((function(e,t){o[String(r)]={resolve:e,reject:t}})),t=c(t,r),r+=1):n=i.resolve(),{code:t,promise:n}}}},"core/src/lib/actions/helpers/getSourceByUrl.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-load-script"),i=n("@adobe/reactor-promise"),r=n("../../helpers/findPageScript").byRegexPattern,o={},s={},c=function(e){return s[e]||(s[e]=a(e)),s[e]};_satellite.__registerScript=function(e,t){var n;if(document.currentScript)n=document.currentScript.getAttribute("src");else{var a=new RegExp(".*"+e+".*");n=r(a).getAttribute("src")}o[n]=t},e.exports=function(e){return o[e]?i.resolve(o[e]):new i((function(t){c(e).then((function(){t(o[e])}),(function(){t()}))}))}}},"core/src/lib/helpers/textMatch.js":{script:function(e){"use strict";e.exports=function(e,t){if(null==t)throw new Error("Illegal Argument: Pattern is not present");return null!=e&&("string"==typeof t?e===t:t instanceof RegExp&&t.test(e))}}}}}},company:{orgId:"A8AB776A5245B4220A490D44@AdobeOrg",dynamicCdnEnabled:!1},property:{name:"NEWS - CNBC Phoenix web",settings:{domains:["cnbc.com"],undefinedVarsReturnEmpty:!0,ruleComponentSequencingEnabled:!0},id:"PR0c41a7bac2304d74a290a8b62f6b5d2a"},rules:[{id:"RL06a0a5c022654097bc63181e3d2aa9fb",name:"50 - Sailthru On Select [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/select/*|/select/|/select$",valueIsRegex:!0}]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"(function () {\n  const el = document.createElement('script');\n  el.src = 'https://ak.sail-horizon.com/spm/spm.v1.min.js';\n  document.head.appendChild(el);\n})();",language:"javascript"},timeout:2e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"/* globals BI */\nwindow.BI.wrapWithOneTrustCat4(function() {\n  BI.waitForObjAvailable(['Sailthru'], 50, function() {\n    window.Sailthru.init({ customerId: '3eba32054e8bb0ab42143893885f95b2' });\n  });\n});\n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RL137e54f0f15e4678a80d753575adbf43",name:"50 - Twitter Conversion Capture - tracking landing page [d: cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/heres-what-to-listen-for-in-a-corporate-earnings-call-with-investors/",valueIsRegex:!0},{value:"/buffett-whitepaper/",valueIsRegex:!0},{value:"/cramerguide/",valueIsRegex:!0},{value:"/jointheclub/",valueIsRegex:!0},{value:"the-chart-signals-that-top-investing-pros-use/",valueIsRegex:!0},{value:"sign-up-for-cnbc-newsletters/"}]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"/* globals BI */\n(function () {\n  function loadTwitterUWTScript() {\n    if (!window.twq) {\n      (function (e, t, n) {\n      // Define the twq object and initialize it if it doesn't exist\n        var twq = e.twq || (e.twq = function () {\n          twq.exe ? twq.exe.apply(twq, arguments) : twq.queue.push(arguments);\n        });\n        twq.version = '1.1';\n        twq.queue = [];\n        var script = t.createElement(n);\n        script.async = true;\n\n        // Set the source URL for the UWT script\n        script.src = 'https://static.ads-twitter.com/uwt.js';\n\n        // Find the first script element in the document\n        var firstScript = t.getElementsByTagName(n)[0];\n\n        // Insert the UWT script before the first script element in the document\n        firstScript.parentNode.insertBefore(script, firstScript);\n\n        // Call the 'config' method to configure the UWT with the provided ID\n        if (window.twq) {\n          twq('config', 'o42zz');\n        }\n\n        BI.waitForObjAvailable(['__EventBus__'], 50, function() {\n          window.__EventBus__.on('click', function (e) {\n            if (clickEventFilter(e) && window.twq ) {\n              twq('event', 'tw-o42zz-oha22', {});\n            }\n          });\n        });\n\n      })(window, document, 'script');\n    }\n  }\n\n  const buttonElementConditions = function (buttonNodeEvent) {\n\n    //corporate earnings site button //chart signals site has exact same event types\n    const componentSubmitIdSiteOne = buttonNodeEvent.id === 'whitePaperFormSubmit';\n    const freeDownloadTextContentSiteOne = buttonNodeEvent.textContent === 'FREE DOWNLOAD';\n    const typeSubmitSiteOne = buttonNodeEvent.type === 'submit';\n\n    //buffet whitepaper\n    const componentSubmitIdSiteTwo = buttonNodeEvent.id === 'submit';\n    const freeDownloadTextContentSiteTwo = buttonNodeEvent.textContent === 'Submit';\n    const typeSubmitSiteTwo = buttonNodeEvent.type === 'submit';\n\n    //cramer guide\n    const componentSubmitIdSiteThree = buttonNodeEvent.id === 'nl-page-submit';\n    const freeDownloadTextContentSiteThree = buttonNodeEvent.textContent === 'GET THE FREE GUIDE';\n    const typeSubmitSiteThree = buttonNodeEvent.type === 'submit';\n\n    //jointheclub\n    const componentSubmitIdSiteFour = buttonNodeEvent.id === 'nl-page-submit';\n    const freeDownloadTextContentSiteFour = buttonNodeEvent.textContent === 'Subscribe';\n    const typeSubmitSiteFour = buttonNodeEvent.type === 'submit';\n\n    //need to handle cnbc newsletter somehow\n\n    const corporateEarningsEvent = componentSubmitIdSiteOne && freeDownloadTextContentSiteOne && typeSubmitSiteOne;\n    const buffetWhitePaperEvent = componentSubmitIdSiteTwo && freeDownloadTextContentSiteTwo && typeSubmitSiteTwo;\n    const cramerGuideEvent = componentSubmitIdSiteThree && freeDownloadTextContentSiteThree && typeSubmitSiteThree;\n    const joinTheClubEvent = componentSubmitIdSiteFour && freeDownloadTextContentSiteFour && typeSubmitSiteFour;\n\n    return corporateEarningsEvent || buffetWhitePaperEvent || cramerGuideEvent || joinTheClubEvent;\n\n  };\n\n  const clickEventFilter = function (bteEvent) {\n    if (\n      Object.prototype.hasOwnProperty.call(bteEvent, 'eventObject') &&\n    typeof bteEvent.eventObject === 'object' &&\n    bteEvent.eventObject instanceof HTMLElement) {\n      const nodeEvent = bteEvent.eventObject;\n      if (nodeEvent.tagName === 'BUTTON') {\n        return buttonElementConditions(nodeEvent);\n      }\n    }\n    return false;\n\n  };\n\n  BI.wrapWithOneTrust({\n    fn: loadTwitterUWTScript,\n    featureName: 'Twitter Pagecall',\n    categories: [4,7],\n  });\n\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RL1489d28e39de4208ae11f87892ab8554",name:"50 - Action - phx_zephr_* [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"/* globals $t, s, __CNBC_META_DATA, BI */\n(function () {\n  function track(actionContextData) {\n    BI.waitForObjAvailable(['s', 's.tl'], 50, function () {\n      s.contextData = {};\n      s.contextData = actionContextData;\n      s.tl(true, 'o', 'Zephr Template Event');\n      s.manageVars('clearVars');\n    });\n  }\n\n  function convertEventData(friendlyEventName, data) {\n    return {\n      'cnbc.action': `Zephr Template ${friendlyEventName}: ${__CNBC_META_DATA.id}`,\n      'cnbc.brand': __CNBC_META_DATA.brand != undefined ? __CNBC_META_DATA.brand : 'NA',\n      'cnbc.platform': 'web',\n      'cnbc.outcomeType': `${data.outcomeType ?? 'NA'}`,\n      'cnbc.outcomeID': `${data.outcomeId ?? 'NA'}`,\n      'cnbc.outcomeDetail': `${data.outcomeDetail?? 'NA'}`,\n    };\n  }\n\n  $t('on', 'phx_zephr_load', function (e, data) {\n    track(convertEventData('Appear', data));\n  });\n\n  $t('on', 'phx_zephr_click', function (e, data) {\n    track(convertEventData(`Click: ${data.action}`, data));\n  });\n\n  $t('on', 'phx_zephr_close', function (e, data) {\n    track(convertEventData('Close', data));\n  });\n\n  $t('on', 'phx_zephr_email_submit', function (e, data) {\n    track(convertEventData('Email Submit', data));\n  });\n\n  $t('on', 'phx_zephr_expand', function (e, data) {\n    track(convertEventData('Expand', data));\n  });\n})();\n",
language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RL15269f86e239427eb4775fc7dbf574e6",name:"50 - Rokt Conversion Capture - tracking landing page [d: cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/heres-what-to-listen-for-in-a-corporate-earnings-call-with-investors/",valueIsRegex:!0},{value:"/buffett-whitepaper/",valueIsRegex:!0},{value:"/cramerguide/",valueIsRegex:!0},{value:"/jointheclub/",valueIsRegex:!0},{value:"/the-chart-signals-that-top-investing-pros-use/",valueIsRegex:!0},{value:"sign-up-for-cnbc-newsletters/",valueIsRegex:!0}]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"/* globals BI */\n(function () {\n  function loadRoktSnippet() {\n    (function (window, document, source, accountId, integrationName, e, w, a, _) {\n      window._ROKT_ = integrationName;\n      window[integrationName] = window[integrationName] || {\n        id: accountId,\n        h: w,\n        lc: [],\n        it: new Date(),\n        onLoaded: function (c) {\n          window[integrationName].lc.push(c);\n        },\n      };\n      a = document.createElement('script');\n      a.type = 'text/javascript';\n      a.async = true;\n      a.src = source;\n      if (e) {\n        a.integrity = e;\n        a.crossOrigin = 'anonymous';\n      }\n      _ = document.getElementsByTagName('script')[0];\n      _.parentNode.insertBefore(a, _);\n    })(\n      window,\n      document,\n      'https://apps.rokt.com/wsdk/integrations/snippet.js',\n      '3017129197477095999', // the ids are the same for snippet.js and launcher.js, not sure if we need both of these scripts\n      'rokt'\n    );\n\n    window.rokt.onLoaded(function(rokt) {\n      rokt.setAttributes({\n        emailsha256: ''\n      });\n    });\n  }\n\n  async function loadRoktLauncher() {\n    const target = document.head || document.body;\n    const script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = 'https://apps.rokt.com/wsdk/integrations/launcher.js';\n    script.fetchpriority = 'high';\n    script.crossOrigin = 'anonymous';\n    script.async = true;\n    script.id = 'rokt-launcher';\n    target.appendChild(script);\n    await new Promise((resolve) =>\n      window.Rokt\n        ? resolve()\n        : document\n          .getElementById('rokt-launcher')\n          .addEventListener('load', () => resolve())\n    );\n\n    await window.Rokt.createLauncher({\n      accountId: '3017129197477095999', //account id given from rokt team\n    });\n  }\n\n  /* SNIPAF: {\"name\": \"button_element_conditions\", \"version\":\"1.0\"} */\n  const buttonElementConditions = function (buttonNodeEvent) {\n    //corporate earnings site button //chart signals site has exact same event types\n    const componentSubmitIdSiteOne = buttonNodeEvent.id === 'whitePaperFormSubmit';\n    const freeDownloadTextContentSiteOne = buttonNodeEvent.textContent === 'FREE DOWNLOAD';\n    const typeSubmitSiteOne = buttonNodeEvent.type === 'submit';\n\n    //buffet whitepaper\n    const componentSubmitIdSiteTwo = buttonNodeEvent.id === 'submit';\n    const freeDownloadTextContentSiteTwo = buttonNodeEvent.textContent === 'Submit';\n    const typeSubmitSiteTwo = buttonNodeEvent.type === 'submit';\n\n    //cramer guide\n    const componentSubmitIdSiteThree = buttonNodeEvent.id === 'nl-page-submit';\n    const freeDownloadTextContentSiteThree = buttonNodeEvent.textContent === 'GET THE FREE GUIDE';\n    const typeSubmitSiteThree = buttonNodeEvent.type === 'submit';\n\n    //jointheclub\n    const componentSubmitIdSiteFour = buttonNodeEvent.id === 'nl-page-submit';\n    const freeDownloadTextContentSiteFour = buttonNodeEvent.textContent === 'Subscribe';\n    const typeSubmitSiteFour = buttonNodeEvent.type === 'submit';\n\n    /* need to handle cnbc newsletter once that's added to adobe in work AFT-975 */\n\n    const corporateEarningsEvent = componentSubmitIdSiteOne && freeDownloadTextContentSiteOne && typeSubmitSiteOne;\n    const buffetWhitePaperEvent = componentSubmitIdSiteTwo && freeDownloadTextContentSiteTwo && typeSubmitSiteTwo;\n    const cramerGuideEvent = componentSubmitIdSiteThree && freeDownloadTextContentSiteThree && typeSubmitSiteThree;\n    const joinTheClubEvent = componentSubmitIdSiteFour && freeDownloadTextContentSiteFour && typeSubmitSiteFour;\n\n    return corporateEarningsEvent || buffetWhitePaperEvent || cramerGuideEvent || joinTheClubEvent;\n\n  };\n  /* SNIPAF: END*/\n\n  /* SNIPAF: {\"name\": \"click_event_filter\", \"version\":\"1.0\"} */\n  const clickEventFilter = function (bteEvent) {\n    if (\n      Object.prototype.hasOwnProperty.call(bteEvent, 'eventObject') &&\n    typeof bteEvent.eventObject === 'object' &&\n    bteEvent.eventObject instanceof HTMLElement) {\n      const nodeEvent = bteEvent.eventObject;\n      if (nodeEvent.tagName === 'BUTTON') {\n        return buttonElementConditions(nodeEvent);\n      }\n    }\n    return false;\n  };\n  /* SNIPAF: END*/\n\n\n  function checkEventOccurence() {\n    BI.waitForObjAvailable(['__EventBus__'], 50, function() {\n      /* \ud83d\ude80 call our snippet and launcher when button is clicked \ud83d\ude80 */\n      window.__EventBus__.on('click', function (e) {\n        if (clickEventFilter(e) ) {\n          loadRoktSnippet();\n          loadRoktLauncher();\n        }\n      });\n    });\n  }\n\n  BI.wrapWithOneTrust({\n    fn: checkEventOccurence,\n    featureName: 'Rokt Pagecall',\n    categories: [4,7],\n  });\n})();",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RL20af75256c69444c84b6c851aaccbd56",name:"30 - VWO Tag [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:30}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"/* globals BI, mps */\nfunction vwoScript() {\n  const BRAND_ID_MAP = {\n    'cnbc.com': 612803,\n  };\n\n  const CNBC_DOMAIN = 'cnbc.com';\n\n  const topLevelDomain = (function () {\n    const validDomains = ['cnbc.com'];\n    const isAmp = location.hash.indexOf('amp=1') != -1;\n    const ampDomainOverride = (location.hash.split('domain=')[1] || '').split('&')[0];\n    let topLevelDomain =\n      (isAmp && ampDomainOverride) || document.location.hostname.match(/[^./]+\\.[^./]+$/)[0];\n    topLevelDomain = validDomains.indexOf(topLevelDomain) != -1 ? topLevelDomain : 'cnbc.com';\n\n    return topLevelDomain;\n  })();\n\n  const brand = BRAND_ID_MAP[topLevelDomain];\n  const el = document.createElement('script');\n  el.src = `https://dev.visualwebsiteoptimizer.com/lib/${brand || BRAND_ID_MAP[CNBC_DOMAIN]}.js`;\n  document.head.appendChild(el);\n}\n\n// OneTrust GDPR Wrapper for VWO\n// Category 7 - Content Selection / Personalized Content\n(function() {\n  BI.waitForObjAvailable(['mps', 'mps.geo', 'mps.geo.data'], 40, function() {\n    if (mps) {\n      mps.optCAT7Enabled = true;\n      var optanonCookie =\n        document &&\n        document.cookie &&\n        document.cookie\n          .split(';')\n          .map(s => s.trim())\n          .find(s => s.startsWith('OptanonConsent'));\n      var categoryEnabledRegexC7 = /groups=[^&]*%2C7%3A1/;\n      mps.optConsentContentMeasurement = categoryEnabledRegexC7.test(optanonCookie);\n\n      if (mps.geo.inGroup('eea')) {\n        if (mps.optConsentContentMeasurement) {\n          mps.optCAT7Enabled = true;\n        } else {\n          mps.optCAT7Enabled = false;\n        }\n      }\n\n      if(mps.optCAT7Enabled) {\n        //Content Selection / Personalized Content code goes here\n        console.log('VWO - CAT7 - Enabled');\n        vwoScript();\n      } else {\n        console.log('VWO - CAT7 - Disabled');\n      }\n    }\n  });\n})();",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RL2b65d8a47f114d24801a05a56035c3b1",name:"30 - AB Admiral Tag [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"/* globals BI, __CNBC_META_DATA */\n(function(){\n\n  // Gets an object whose entries are cookie values\n  function getCookies(names = []) {\n    function matches(e) {\n      return names.filter(n => e.startsWith(`${n}=`)).length;\n    }\n\n    var entries = document.cookie\n      .split(';')\n      .map(entry => entry.trim())\n      .filter(matches)\n      .map(entry => entry.split('='));\n\n    return Object.fromEntries(entries);\n  }\n  function checkProOrIcUser() {\n    BI.waitForObjAvailable(['__CNBC_META_DATA', '__CNBC_META_DATA.user'], 50, function() {\n      const cnbcUser = __CNBC_META_DATA.user;\n      const proUser = cnbcUser.isPro;\n      const icUser = cnbcUser.isInvestingClubUser;\n\n      BI.waitForObjAvailable(['admiral'], 50, () => {\n        if (proUser || icUser )\n          window.admiral('targeting', 'pause');\n      });\n    });\n  }\n\n  const { userEmail, userSession } = getCookies(['userEmail', 'userSession']);\n  // on page init we first check if a user is logged in\n  // if not, we call admiral api and set targeting ready, if they are logged in we check if they're pro or ic user\n  callLoader();\n  if (!userEmail || !userSession) {\n    BI.waitForObjAvailable(['admiral'], 50, () => {\n      window.admiral('targeting', 'ready');\n    });\n\n  } else {\n    checkProOrIcUser();\n  }\n\n  function loadAdmiralScript() {\n    !(function (document, tagName) {\n      var scriptTag = document.createElement(tagName);\n      var firstScriptTag = document.getElementsByTagName(tagName)[0];\n      scriptTag.async = 1;\n      scriptTag.src = 'https://acidpigs.com/v2/0/cfgPonIZy0vzBw2WwDUYHDKQ6jLZ5cQibbFroY_JQFu4xDnvmXqd8OEvwhd_5aVLhuUfg';\n      firstScriptTag.parentNode.insertBefore(scriptTag, firstScriptTag);\n    })(document, 'script'), (function (window, namespace) {\n\n      window[namespace] = window[namespace] || function () {\n        //initialization code to be run before any publisher code that uses Admiral's API\n        (window[namespace].q = window[namespace].q || []).push(arguments);\n\n      };\n      // pause the targeting call until we update our custom targeting\n      window[namespace]('targeting', 'pause');\n\n    })(window, 'admiral');\n\n    !(function (window, namespace, type) {\n      function setAdmiralEngaged() {\n        if ((function checkLocalStorage() {\n          try {\n            var localStorageValue = localStorage.getItem('v4ac1eiZr0');\n            return localStorageValue && 0 < localStorageValue.split(',')[4];\n          } catch (error) {\n            console.error('An error occurred:', error);\n          }\n          return false;\n        })()) {\n          var pubads = window[namespace].pubads();\n          if (typeof pubads.setTargeting === type) {\n            pubads.setTargeting('admiral-engaged', 'true');\n          }\n        }\n      }\n\n      var googletag = window[namespace] = window[namespace] || {};\n      googletag.cmd = googletag.cmd || [];\n      if (typeof googletag.pubads === type) {\n        setAdmiralEngaged();\n      } else if (typeof googletag.cmd.unshift === type) {\n        googletag.cmd.unshift(setAdmiralEngaged);\n      } else {\n        googletag.cmd.push(setAdmiralEngaged);\n      }\n    })(window, 'googletag', 'function');\n  }\n\n  function callLoader() {\n    BI.wrapWithOneTrust({\n      fn: loadAdmiralScript,\n      featureName: 'Admiral Pagecall',\n      categories: [7]\n    });\n  }\n})();",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RL2d620de9e98741e7872cf6239d803a5e",name:"60 - Affiliate link CID append [BizDev, d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return new Promise((function(e){BI.waitForObjAvailable(["__CNBC_META_DATA","__CNBC_META_DATA.queryParams"],50,(function(){const t=["mobile-native","native-tablet","native-android-mobile","native-android-tablet"];(e=>{if("object"!=typeof e||!e.$DEVICE$)return!1;const n=e?.$DEVICE$;return"string"==typeof n?t.includes(n):!!Array.isArray(n)&&n.some((e=>t.includes(e)))})(__CNBC_META_DATA.queryParams)?e(!1):e(!0)}))}))}},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"/* global BI */\n(function () {\n  const logEvent = window.BI?.console?.build('Affiliate Links') ?? Function.prototype;\n\n  /* SNIPAF: {\"name\": \"modify_affiliate_links\", \"version\":\"1.0\"} */\n  // A function that uses a list of \"link modifier\" objects to add\n  // query parameters to the hrefs of link elements.\n  function modifyAffiliateLinks({\n    modifiers = [],\n    dependencies = [],\n    timeLimitInSeconds = 5,\n    logEvent = Function.prototype,\n  }) {\n    window.BI.waitForObjAvailable(dependencies, timeLimitInSeconds, doModification, 1000);\n\n    function doModification() {\n      modifiers.forEach(mod => {\n        document.querySelectorAll(mod.linkSelector).forEach((link) => {\n          try {\n            let url = new URL(link.href);\n            let urlBackup = new URL(url.href);\n\n            try {\n              mod.apply({ url, link });\n            }\n            catch (e) {\n              url = urlBackup;\n              let err = String(e);\n              logEvent(`Error - ${mod.name}`, { err, link, mod, url });\n            }\n\n            if (url.href != link.href) {\n              link.href = url.href;\n\n              logEvent(`Link Modified - ${mod.name}:`, {\n                before: urlBackup.href,\n                after: url.href\n              });\n            }\n          }\n          catch (e) {\n            let err = String(e);\n            logEvent(`Unexpected Error - ${mod.name}:`, { err, link });\n          }\n        });\n      });\n    }\n  }\n  /* SNIPAF: END*/\n\n  const engineConfig = {\n    timeLimitInSeconds: 7,\n    logEvent,\n    dependencies: [\n      '__CNBC_META_DATA',\n      '__CNBC_META_DATA.id',\n      'mParticle',\n      'mParticle.Identity',\n      'mParticle.Identity.getCurrentUser',\n      'mParticle.getDeviceId'\n    ],\n    modifiers: [\n      {\n        name: 'Engine DocId',\n        linkSelector: 'a[href*=\"engine.tech\"]',\n        apply: function({ url }) {\n          const docId = window.__CNBC_META_DATA?.id ?? null;\n          url.searchParams.set('tag.docId', docId);\n        },\n      },\n      {\n        name: 'Engine Platform',\n        linkSelector: 'a[href*=\"engine.tech\"]',\n        apply: function({ url }) {\n          url.searchParams.set('tag.platform', 'web');\n        },\n      },\n      {\n        name: 'Engine Referrer',\n        linkSelector: 'a[href*=\"engine.tech\"]',\n        apply: function({ url }) {\n          try {\n            let referrerHost = document.referrer ? new URL(document.referrer).host : 'na';\n            let encodedReferrerHost = encodeURI(referrerHost.replace(/[^a-zA-Z0-9]+/g, '-'));\n            url.searchParams.set('tag.referrer', encodedReferrerHost);\n          }\n          catch (e) {\n            url.searchParams.set('tag.referrer', 'na');\n          }\n        },\n      },\n      {\n        name: 'Engine MPID',\n        linkSelector: 'a[href*=\"engine.tech\"]',\n        apply: function({ url }) {\n          let mpid = window.mParticle?.Identity?.getCurrentUser()?.getMPID() ?? null;\n          url.searchParams.set('tag.mpid', mpid);\n        },\n      },\n      {\n        name: 'Engine Device Id',\n        linkSelector: 'a[href*=\"engine.tech\"]',\n        apply: function({ url }) {\n          let deviceId = window.mParticle?.getDeviceId() ?? null;\n          url.searchParams.set('tag.deviceId', deviceId);\n        },\n      }\n    ]\n  };\n\n  const moneyConfig = {\n    timeLimitInSeconds: 7,\n    logEvent,\n    dependencies: [\n      '__CNBC_META_DATA',\n      '__CNBC_META_DATA.id',\n      'mParticle',\n      'mParticle.Identity',\n      'mParticle.Identity.getCurrentUser',\n      'mParticle.getDeviceId'\n    ],\n    modifiers: [\n      {\n        name: 'Money S1',\n        linkSelector: 'a[href*=\"secure.money\"]',\n        apply: function({ url }) {\n          const docId = window.__CNBC_META_DATA?.id ?? null;\n          url.searchParams.set('s1', docId);\n        },\n      },\n      {\n        name: 'Money S2',\n        linkSelector: 'a[href*=\"secure.money\"]',\n        apply: function({ url }) {\n          url.searchParams.set('s2', 'web');\n        },\n      },\n      {\n        name: 'Money S3',\n        linkSelector: 'a[href*=\"secure.money\"]',\n        apply: function({ url }) {\n          try {\n            let referrerHost = document.referrer ? new URL(document.referrer).host : 'na';\n            let encodedReferrerHost = encodeURI(referrerHost.replace(/[^a-zA-Z0-9]+/g, '-'));\n            url.searchParams.set('s3', encodedReferrerHost);\n          }\n          catch (e) {\n            url.searchParams.set('s3', 'na');\n          }\n        },\n      },\n      {\n        name: 'Money S4',\n        linkSelector: 'a[href*=\"secure.money\"]',\n        apply: function({ url }) {\n          let mpid = window.mParticle?.Identity?.getCurrentUser()?.getMPID() ?? null;\n          url.searchParams.set('s4', mpid);\n        },\n      },\n      {\n        name: 'Money S5',\n        linkSelector: 'a[href*=\"secure.money\"]',\n        apply: function({ url }) {\n          let deviceId = window.mParticle?.getDeviceId() ?? null;\n          url.searchParams.set('s5', deviceId);\n        },\n      },\n      {\n        name: 'Money S6',\n        linkSelector: 'a[href*=\"secure.money\"]',\n        apply: function({ url, link }) {\n          let moduleName = link.dataset?.rvModule ?? 'na';\n          url.searchParams.set('s6', moduleName);\n        },\n      },\n    ],\n  };\n\n  const bankRateConfig = {\n    timeLimitInSeconds: 7,\n    logEvent,\n    dependencies: [\n      '__CNBC_META_DATA',\n      '__CNBC_META_DATA.id'\n    ],\n    modifiers: [\n      {\n        name: 'Bankrate Sub-ID',\n        linkSelector: 'a[href*=\"bankrate.com/landing/select\"]',\n        apply: function({ url }) {\n          const docId = window.__CNBC_META_DATA?.id ?? null;\n          url.searchParams.delete('sub-id'); //remove sub-id if it is available\n          url.searchParams.set('s1', docId); //and replace with s1\n        },\n      }\n    ]\n  };\n\n  BI.wrapWithOneTrust({\n    featureName: 'Modify Affiliate Links - engine.tech',\n    categories: [4,7],\n    fn: function () {\n      modifyAffiliateLinks(engineConfig);\n    },\n  });\n\n  BI.wrapWithOneTrust({\n    featureName: 'Modify Affiliate Links - secure.money',\n    categories: [4,7],\n    fn: function () {\n      modifyAffiliateLinks(moneyConfig);\n    },\n  });\n\n  BI.wrapWithOneTrust({\n    featureName: 'Modify Affiliate Links - bankrate.com',\n    categories: [4,7],\n    fn: function () {\n      modifyAffiliateLinks(bankRateConfig);\n    },\n  });\n})();",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RL30e5fc00f12c4e258a33d9438d3c6469",name:"10 - Load $t Tracking Service [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:10}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["msnbc.com","nbcnews.com","today.com","telemundo.com","cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:'\n/*!******************\nTracking Service $t\nVersion: 2.4.1\nBuilt: 2017-08-24T19:35:07.994Z\n*********************/\n!function(e,t){var n=function(){var n=function(e){return"function"==typeof n[e]?n[e].apply(n,Array.prototype.slice.call(arguments,1)):arguments.length>0?n.get.apply(n,arguments):n.list.apply(n,arguments)},r=function(e,t){n.errorLog.push(e),(!t||n.debug>=1)&&i("$t error - "+e)},i=e.console?function(){e.console.log.apply(e.console,arguments)}:function(){},o=function(e,t){e=e||{};for(var n in t)"object"==typeof t[n]?e[n]=o(e[n],t[n]):e[n]=t[n];return e},s=function(e,t){var i=!1;return/^[^a-zA-Z_$]|[^0-9a-zA-Z_$]/.test(e)&&(i="validation: "+e+" is not a valid variable name"),t||void 0===n.eventLog[e]||(i="validation: "+e+" is already registered"),!i||(r(i),!1)},a={exp:36e5,key:"ts_data.",save:function(t,n,r){var i=(new Date).getTime(),o={eventData:n,timestamp:i};i=r?i+r:i+this.exp;var s=/\\w+\\.\\w+$/.exec(e.location.hostname);return this.cookie.set({name:this.key+t,value:JSON.stringify(o),path:"/",expires:new Date(i),domain:s}),n},load:function(e){var t=null;return!!(t=this.cookie.get(this.key+e))&&(t=JSON.parse(t),(new Date).getTime()<t.timestamp?t.eventData:void 0)},listEvents:function(){var e,t=[];e=this.cookie.keys();for(var n in e)isNaN(n)||(n=e[n]),-1!=n.indexOf(this.key)&&t.push(n.split(this.key)[1]);return t},cookie:{get:function(e){var n=t.cookie.split(e+"=");return 2===n.length&&decodeURI(n.pop().split(";").shift())},set:function(e){var n=e.name+"="+encodeURI(e.value)+";";e.expires&&(n+="expires="+e.expires.toUTCString()+";"),n+=e.path?"path="+e.path+";":"",n+=e.domain?"domain="+e.domain+";":"",n+=e.secure?"secure;":"",n+=e.httpOnly?"httpOnly;":"",t.cookie=n},keys:function(){var e=[],n=t.cookie;if(""===n)return e;for(var r=n.split("; "),i=r.length;i--;){var o=r[i].split("=");e[i]=o[0]}return e}}},c={listeners:{},trigger:function(e,t,i){if(this.listeners[t]&&this.listeners[t].length>0)for(var o=0;this.listeners[t][o];o++){var s=this.listeners[t][o];try{s.apply(n,[{type:t},i])}catch(e){r("Cant execute callback for: "+t+". "+e.stack)}}},bind:function(e,t,n){void 0===this.listeners[t]&&(this.listeners[t]=[]),this.listeners[t].push(n)}},f=function(t){if(t=t.split("."),void 0!==e[t[0]]){for(var n=e[t[0]],i=1;t.length>i;i++){if(null===n||void 0===n[t[i]])return r("TRAM convert - undefined - "+t.join().replace(/,/g,"."),!0),!1;n=n[t[i]]}return!function(e){if("object"==typeof e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}return!1}(n)&&n||!1}return r("TRAM convert - missing root obj - "+t[0],!0),!1},l={},v={uniqueKey:"$t_nbc_crossEvent",srcUrl:[e.location.protocol,"//",e.location.host,e.location.pathname].join(""),listen:function(){var t=this.uniqueKey,r=this.srcUrl,i=e.addEventListener?"addEventListener":"attachEvent",o=function(e){try{return JSON.parse(e)}catch(e){return null}};(0,e[i])("attachEvent"==i?"onmessage":"message",function(i){if("string"==typeof i.data&&i.data.substring(0,t.length)===t){var s=o(i.data.replace(t,""));s&&s.action&&s.srcUrl!==r&&("track"!==s.action[0]&&"register"!==s.action[0]||(n.apply(n,s.action),parent!==e&&parent.postMessage(i.data,"*")))}},!1)},send:function(e){var t=this.uniqueKey,n={action:e,srcUrl:this.srcUrl};parent.postMessage(t+JSON.stringify(n),"*")}},u={};return n.version="2.4.1",n.debug=0,n.errorLog=[],n.eventLog={},n.track=function(t,n,s){if(void 0!==this.eventLog[t]){if("object"!=typeof s&&(s={}),n=n||!0,this.eventLog[t]=n,s.persistent){var f=!1;s.expires&&(f=1e3*s.expires),a.save(t,n,f)}if(0!==t.indexOf("_")&&c.trigger(this,"eventTracked",{eventType:t,eventData:n}),u[t]&&u[t].remote){if("object"==typeof n&&!n.$t_remote){var l=[e.location.protocol,"//",e.location.host,e.location.pathname].join("");o(n,{$t_remote:l})}v.send(["track",t,n])}return c.trigger(this,t,n),(1==this.debug&&0!==t.indexOf("_")||2==this.debug)&&i("*Tracking service: "+t+" triggered"),!0}return r("unable to track: "+t),!1},n.register=function(e,t){"object"!=typeof t&&(t={}),t=u[e[f]]=o(u[e[f]]||{},t);for(var n="",i=a.listEvents(),c={},f=0;i[f];f++)c[i[f]]=!0;for("string"==typeof e&&(e=[e]),f=0;e[f];f++){if(!0===c[e[f]])return!0;s(e[f],t.allowDuplicate)?(this.eventLog[e[f]]=null,t.remote&&v.send(["register",e[f],t])):n+=e[f]+","}return!n||(r("could not register: "+n),!1)},n.registeredEvents=function(e){var t=!1,r=[];0===(e=e||"").indexOf("_")&&(t=!0,e=e.substr(1));for(var i in n.eventLog)-1==i.indexOf(e)||0===i.indexOf("_")&&!t||r.push(i);return r},n.bindTrack=function(e){c.bind(this,"eventTracked",e)},n.on=function(e,t){"string"==typeof e&&(e=[e]);for(var n=0;e[n];n++)c.bind(this,e[n],t)},n.load=function(e,t,n){void 0===l[e]?"string"==typeof t?(l[e]={},l[e].info={ref:t,options:n}):r("TRAM load - object reference must be string"):r("TRAM load - object name taken")},n.get=function(e,t){var r=e.split(".")[0];if(t=void 0!==t?t:"",n.eventLog[r]||l[r]){n.eventLog[r]&&(e="$t."+e,r="$t"),e=e.replace(r,l[r].info.ref);var i=f(e);return i||t}return t},n.list=function(e){if(e)n.eventLog[e]?(i(e+" : event info"),i(n.eventLog[e])):l[e]?void 0!==window[l[e].info.ref.split(".")[0]]?(i(e+" : "+l[e].info.ref),i(f(l[e].info.ref))):i(e+" : "+l[e].info.ref+" : Not present"):i(e+" :  Empty or not defined");else{i("%cversion: %s","font-weight:bold;",n.version),i("%cevents:","font-weight:bold;");for(var t in n.eventLog)if(0!==t.indexOf("_")||2==n.debug){var r=u[t]&&u[t].remote?"(remote)":"";n.eventLog[t]?i("%c* %s %s fired %O","color:#B80;",t,r,n.eventLog[t]):(r=u[t]&&u[t].remote?"(remote)":"",i("%s %s",t,r))}i("%cTRAM objects:","font-weight:bold;");for(var o in l)i("%s : %s : %O",o,l[o].info.ref,f(l[o].info.ref));n.errorLog.length>0&&i("%clog: %O","font-weight:bold;",n.errorLog)}},function(){var e=a.listEvents();if(!e)return!1;for(var t=0;e[t];t++){var r=a.load(e[t]);r&&(n.eventLog[e[t]]=r)}}(),n.load("$t","$t.eventLog"),v.listen(),n};if(void 0!==e.$t){if(!parseFloat(e.$t.version)>0){var r=e.$t("getSaves");e.$t=n();for(var i=0;r[i];i++)e.$t.apply(e.$t,r[i])}}else e.$t=n()}(window,document);\n  \n//load data layers\n$t(\'load\',\'CNBC_META\',\'__CNBC_META_DATA\');\n\n',language:"javascript"},timeout:2e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"/* globals $t */\n// Intercepting $t events emitted from within iframes.\n// This script is intended to be a temporary workaround\n// while remote event functionality is being repaired.\n// https://github.com/cnbc/WEB.Zephr/pull/65\n(function() {\n  window.addEventListener('message', event => {\n    if (event.data.sender === '$t') {\n      const { action, eventType, options } = event.data;\n      $t(action, eventType, options);\n    }\n  });\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RL54c69cd2baaa4dffb74e2855715b5249",name:"50 - GTag - ecom_click_track [d:cnbc.com, regex_path]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/select/|/select$",valueIsRegex:!0}]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"/* globals BI */\nfunction loadScript(script) {\n  var s = document.createElement('script'),\n    el = document.getElementsByTagName('script')[0];\n  s.async = true;\n  s.src = (document.location.protocol == 'https:' ? 'https://' : 'http://') + script;\n  el.parentNode.insertBefore(s, el);\n}\n\n// Google Tag Manager script & tracking for outbound commerce clicks\n(function () {\n  var topLevelDomain = document.location.hostname.match(/[^./]+\\.[^./]+$/)[0];\n  loadScript('www.googletagmanager.com/gtag/js?id=AW-938818781');\n\n  window.dataLayer = window.dataLayer || [];\n\n  function gtag() {\n    window.dataLayer.push(arguments);\n  }\n\n  gtag('js', new Date());\n  gtag('config', 'AW-938818781');\n\n  var reportGtagConversion = function (sendTo) {\n    gtag('event', 'conversion', {\n      allow_custom_scripts: true,\n      send_to: sendTo,\n      // in the snippet in the ticket,\n      // the callback changes the window location to a new url\n      // i don't think we need to do that\n      //event_callback: callback\n    });\n    // unsure if we need to return anything\n    //return false;\n  };\n\n  var commerceLinkElementConditions = function (linkNode) {\n    var linkURL = linkNode.getAttribute('href');\n    var linkTarget = linkNode.getAttribute('target');\n    var linkRel = linkNode.getAttribute('rel');\n    var linkDataSet = linkNode.dataset.analyticsId;\n    if (linkURL && linkTarget && linkRel && linkDataSet) {\n      var linkOutbound = new URL(linkURL).hostname.match(/[^./]+\\.[^./]+$/)[0] !== topLevelDomain;\n      var targetBlank = linkTarget === '_blank';\n      var linkSponsored = linkRel === 'sponsored';\n      var analyticsId = ['LEARN MORE', 'CARDTITLE'].includes(linkDataSet.split(':')[0]);\n      // link domain does not equal page domain\n      // & link opens in a new window\n      // & link rel is sponsored\n      // & dataset has CARDTITLE or LEARN MORE\n      return linkOutbound && targetBlank && linkSponsored && analyticsId;\n    }\n    return false;\n  };\n\n  var clickEventFilter = function (bteEvent) {\n    if (\n      Object.prototype.hasOwnProperty.call(bteEvent, 'eventObject') &&\n      typeof bteEvent.eventObject === 'object' &&\n      bteEvent.eventObject instanceof HTMLElement\n    ) {\n      var node = bteEvent.eventObject;\n      if (node.tagName === 'A') {\n        return commerceLinkElementConditions(node);\n      } else if (node.tagName === 'IMG') {\n        if (node.parentNode && node.parentNode.tagName === 'A') {\n          return commerceLinkElementConditions(node.parentNode);\n        }\n      }\n    }\n    return false;\n  };\n\n  window.BI.wrapWithOneTrustCat4(function gtmTrackOutboundSponsoredLink() {\n    BI.waitForObjAvailable(['__EventBus__'], 50, function() {\n      window.__EventBus__.on('click', function (e) {\n        if (clickEventFilter(e)) {\n          reportGtagConversion('AW-938818781/l6-KCLzlhpMYEN351L8D');\n        }\n      });\n    });\n  });\n\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RL58dac462812c4574bef754938478c438",name:"60 - univideo - product adapter (mparticle) [univideo, d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:"/* global $t, BI, mParticle */\n(function () {\n  var logEvent = (function () {\n    var logGroup = 'uni_mparticle';\n    var logger = function (event, data) {\n      if (BI && BI.console) {\n        BI.console.log(event, data, logGroup);\n      }\n    };\n    logger.logGroup = logGroup;\n    return logger;\n  })();\n\n  const uniEvent = window.uniVideo && window.uniVideo.event || {};\n  var _playheadPosition = 0;\n  var _secondsWatched = 0;\n  const noValue = 'not available';\n\n  $t('on', 'uni_videoEvent', function (_e, data) {\n    const { eventType, videoData, videoState } = data;\n    // Turn off mParticle tracking if event is from a cvsdk player\n    if (videoData.playbackAdapter !== 'cvsdk') { return; }\n\n    const isLinear = videoData.streamType === 'linear';\n    let eventName;\n\n    // Distinguishing between on-demand and live video streams\n    switch (eventType) {\n      case uniEvent.PLAY:\n        if (videoState.playState === 'stop') {\n          // This indicates the \"start\" event\n          eventName = isLinear ? 'Linear Start' : 'VOD Clip Start';\n        }\n        _playheadPosition = videoData.playheadPosition;\n        break;\n      case uniEvent.SEGMENT_START:\n        eventName = isLinear ? 'Linear Program Start' : 'VOD Program Start';\n        break;\n      case uniEvent.AD_PLAY:\n        eventName = isLinear ? 'Linear Ad Start' : 'Ad Start';\n        break;\n      case uniEvent.AD_BREAK_START:\n        eventName = isLinear ? 'Linear Ad Pod Start' : 'Ad Pod Start';\n        break;\n      case uniEvent.PAUSE:\n        _secondsWatched = _secondsWatched + Math.round((videoData.playheadPosition - _playheadPosition)/1000);\n        break;\n      case uniEvent.STOP:\n        eventName = isLinear ? 'Linear End' : 'VOD Clip Stop';\n        _secondsWatched = _secondsWatched + Math.round((videoData.playheadPosition - _playheadPosition)/1000);\n        break;\n      case uniEvent.COMPLETE:\n        eventName = isLinear ? 'Linear Complete' : 'VOD Clip Complete';\n        break;\n      case uniEvent.SEGMENT_END:\n        eventName = isLinear ? 'Linear Program End' : 'VOD Program Complete';\n        break;\n      case uniEvent.AD_COMPLETE:\n        eventName = isLinear ? 'Linear Ad End' : 'Ad Complete';\n        break;\n      case uniEvent.AD_BREAK_COMPLETE:\n        eventName = isLinear ? 'Linear Ad Pod End' : 'Ad Pod Complete';\n        break;\n      default:\n        eventName = null;\n        break;\n    }\n\n    // Skipping events that don't have a counterpart in mparticle\n    if (!eventName) return;\n\n    var customContextData = {\n      'Video Screen Mode': videoState.fullScreen ? 'Full' : 'Normal',\n      ...(eventName === 'Linear End') && {'Duration Watched': _secondsWatched},\n      ...buildCustomContextData(videoData),\n    };\n\n    // Passing mparticle event to be handled by another function.\n    trackMParticle(eventName, 'Navigation', customContextData);\n  });\n\n  // mparticle is loaded differently than in ramen, so we are flattening, and calling it in this function\n  function trackMParticle(eventName, eventType, customData) {\n    // set aam_uuid and MID from adobe\n    var aam_uuid = window.s && (window.s.cookieRead instanceof Function) &&  window.s.cookieRead('aam_uuid') || noValue;\n    var aam_mid = window.s && window.s.visitor && window.s.visitor.getMarketingCloudVisitorID() || noValue;\n\n    var uxExperiment = (function () {\n      //example 2147483647~rv=8~id=b7c90f942ae0282250a0418fbf11f00a~rn=MSNBC_Video_Player_vs._Bento%20B'\n      var cookieName = (function () {\n        let videoDomain = customData.Product || noValue;\n        if (videoDomain === 'nbcnews.com') {\n          return 'akaas_NBCNews';\n        } else if (videoDomain === 'msnbc.com') {\n          return 'akaas_MSNBC';\n        } else if (videoDomain === 'today.com') {\n          return 'akaas_TODAY';\n        } else if (videoDomain === 'cnbc.com') {\n          return 'akaas_CNBC';\n        }\n        else return null;\n      })();\n      var returnString = 'false';\n      var value = window.s && (window.s.cookieRead instanceof Function) && window.s.cookieRead(cookieName).split('~') || '';\n      if (value.length >= 2) {\n        returnString = value[1];\n      }\n      return returnString;\n    })();\n\n    var globalData = {\n      'adobe uuid': aam_uuid || noValue,\n      'adobe marketing cloud': aam_mid || noValue,\n      'ui experiment': window.s && window.s.custGetQS && window.s.custGetQS('icid') || noValue,\n      'ux experiment': uxExperiment,\n      'campaign id': BI && BI.userInfo && BI.userInfo.get('cid') || noValue,\n      'sailthru visitor': BI && BI.userInfo && BI.userInfo.get('sailthru_visitor') || noValue,\n      'airship id': BI && BI.userInfo && BI.userInfo.get('airship_id') || noValue,\n      'isAmp': 'false',\n    };\n\n    var combinedData = Object.assign({}, globalData, customData);\n    // remove any keys that have noValue\n    var filteredData = Object.keys(combinedData).reduce(function (filteredData, key) {\n      if (combinedData[key] !== noValue && combinedData[key] !== '') filteredData[key] = combinedData[key];\n      return filteredData;\n    }, {});\n\n    BI.waitForObjAvailable(['mParticle'], 200, function () {\n      var resolvedEventType = mParticle.EventType[eventType] || null;\n      logEvent(eventName, filteredData);\n      mParticle.logEvent(eventName, resolvedEventType, filteredData || {});\n    });\n  }\n\n  function buildCustomContextData(videoData) {\n    let formattedDate = new Date(Date.now()).toLocaleDateString();\n\n    var customContextData = {\n      'Product': videoData.custom.videoDomain || noValue,\n      'Platform': 'web',\n      'Referrer': document.referrer || 'None',\n      'User Agent': window.navigator.userAgent,\n      'Video ID': videoData.custom.episodeGuid || noValue,\n      'Video GUID': videoData.custom.episodeGuid || noValue,\n      'Video Title': videoData.title || noValue,\n      'Video Brand Domain': videoData.newsNetwork || noValue,\n      'Brand': videoData.newsNetwork || noValue,\n      'Show': videoData.custom.program || videoData.newsNetwork || noValue,\n      'Video Content Source': videoData.newsNetwork || noValue,\n      'Video Air Date': videoData.dateBroadcast !== '' ? new Date(videoData.dateBroadcast).toLocaleDateString('en-US') : formattedDate,\n      'Entitlement': 'Restricted', //(tempPassEnabled && !selectedMvpdId) ? 'TempPass' : authRestricted; const authRestricted = (assetInfoObj?.authRequired) ? 'Restricted' : 'Unrestricted';\n      'Video Duration': videoData.custom.runtime || 3600,\n      'Video Type': videoData.videoType.toLowerCase() || noValue,\n      'Video Player Name': videoData.playbackAdapter.toUpperCase() || noValue,\n      'Video Initiation': videoData.playInitiate || 'Manual',\n      'Video Publish Date': videoData.datePublished !== '' ? new Date(videoData.datePublished).toLocaleDateString('en-US') : formattedDate,\n      'Video Playlist Name': videoData.playlistLabel || 'None',\n      'Video Playlist ID': videoData.playlistId || 'None',\n    };\n\n    return customContextData;\n  }\n})();",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RL5d5b3d65a7b642fc940c084cdd16f9de",name:"15 - BI Tools [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:15}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"(function () {\n    var PREFIX = 'BI_';\n\n    window.BI = window.BI || {}\n\n    function returnPairs(modName) {\n        // if no module is given, we are going to return all BI cookies\n        var prefix = modName ? PREFIX + modName : PREFIX;\n        var pairs = document.cookie.split('; ').filter(function (key) { return key.indexOf(prefix) == 0 });\n        var result = {};\n        pairs.forEach(function (pair) {\n            var keyValueArray = pair.split('=');\n            // remove the prefix on the cookie\n            keyValueArray[0] = keyValueArray[0].replace(prefix + '_', '')\n            result[keyValueArray[0]] = keyValueArray[1];\n        })\n        return result;\n    }\n\n    window.BI.cookie = {\n        // should only get one key/value pair at a time\n        write: function (modName, key, data, expiration) {\n            if (data) {\n                modName = modName ? modName : 'GLOBAL';\n                var prefixedKey = PREFIX + modName + '_' + key;\n                document.cookie = prefixedKey.trim() + '=' + data + '; expires=' + expiration + '; path=/';\n            }\n        },\n        read: function (modName, key) {\n            // if we only get the module name, return all cookies in that module\n            if (modName && !key) {\n                return returnPairs(modName);\n            }\n            // if we get both the module and cookie name, return that specific cookie\n            else if (modName && key) {\n                var prefixedKey = PREFIX + modName + '_' + key;\n                var b = document.cookie.match('(^|[^;]+)\\\\s*' + prefixedKey + '\\\\s*=\\\\s*([^;]+)');\n                return b ? b.pop() : '';\n            }\n            // return all BI cookies if nothing is given\n            else {\n                return returnPairs();\n            }\n        },\n        remove: function(modName, key) {\n            window.BI.cookie.write(modName, key, 'true', 'Thu, 01 Jan 1970 00:00:00 GMT')\n        },\n    }\n\n    window.BI.userInfo = {\n        save: function (userInfo, expiration) {\n            for (var key in userInfo) {\n                // default is a 30min expiration\n                var dt = new Date();\n                dt.setMinutes(dt.getMinutes() + 30);\n                // UI is the modName to pass to the cookie writer\n                if (expiration) window.BI.cookie.write('UI', key, userInfo[key], expiration)\n                // if no expiration is given, use the default 30min\n                else window.BI.cookie.write('UI', key, userInfo[key], dt.toGMTString());\n            }\n        },\n        get: function (key) {\n            // we only want to get the UI module cookies\n            return window.BI.cookie.read('UI', key);\n        },\n        remove: function(key) {\n            window.BI.cookie.remove('UI', key);\n        }\n    }\n})()",language:"javascript"},timeout:2e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"//BI console\n(function (window) {\n  var hasConsole = function () {\n    return window.console && window.console.log;\n  };\n  var prefix = 'BIConsole.';\n\n  var cleanJSON = function(data){\n    var resultJSON = {};\n    try {\n      resultJSON = JSON.parse(JSON.stringify(data));\n    }catch(e){\n      resultJSON = data;\n    }\n    return resultJSON;\n  };\n  window.BI = window.BI || {};\n  window.BI.console = {\n    list: function (searchKey) {\n      searchKey = searchKey || '';\n      var result = {};\n      for (var key in localStorage) {\n        if (key.indexOf(prefix) != -1 && key.split(prefix)[1].indexOf(searchKey) != -1) {\n          result[key.replace(prefix,'')] = localStorage.getItem(key);\n        }\n      }\n      return result;\n    },\n    off: function (key) {\n      var keys = this.list(key);\n      var result = {};\n      for (key in keys) {\n        localStorage.setItem(prefix + key, false);\n        result[key] = false;\n      }\n      return result;\n    },\n    on: function (key) {\n      var keys = this.list(key);\n      var result = {};\n      for (key in keys) {\n        localStorage.setItem(prefix + key, true);\n        result[key] = true;\n      }\n      return result;\n    },\n    log: function (event, data, eventSource) {\n      eventSource = eventSource || 'gen';\n      var logKey = window.localStorage.getItem(prefix + eventSource);\n      if (hasConsole && logKey && logKey.toLowerCase() === 'true') {\n\n        console.log('%c BI:%s %c%s%c @ %s : %O', 'font-weight:normal', eventSource, 'font-weight:bold', event, 'font-weight:normal', (new Date()).toISOString().split('T')[1], cleanJSON(data));\n      } else {\n        window.localStorage.setItem(prefix + eventSource, false);\n      }\n    },\n    build: function (logGroup) {\n      var log = this.log;\n      var logger = function(event, data) {\n        log(event, data, logGroup);\n      };\n      logger.logGroup = logGroup;\n      logger('log group initiated');\n      return logger;\n    }\n  };\n})(window);\n",language:"javascript"},timeout:2e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"(function () {\n    var topLevelDomain = document.location.hostname.match(/[^./]+\\.[^./]+$/)[0];\n    window.BI = window.BI || {};\n    window.BI.brand = (function () {\n        var settings = {}\n        var brandSettings = function (product) {\n            //add default setting\n            if (settings[product] && settings[product][topLevelDomain]) {\n                return settings[product][topLevelDomain];\n            } else {\n                return false\n            }\n        }\n        brandSettings.setProduct = function (product, data) {\n            settings[product] = data;\n        }\n        brandSettings.getProduct = function (product) {\n            if (product) {\n                return settings[product];\n            } else {\n                return settings;\n            }\n        }\n        brandSettings.getDomain = function (domain) {\n            var domainValues = {}\n            if (!domain) {\n                domain = topLevelDomain;\n            }\n            var product;\n            for (product in settings) {\n                if (settings[product][domain]) {\n                    domainValues[product] = settings[product][domain];\n                } else {\n                    domainValues[product] = 'no settings';\n                }\n            }\n            return domainValues;\n        }\n        return brandSettings;\n    })();\n})();",language:"javascript"},timeout:2e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"/* globals BI */\n(function() {\n  var logEvent = (function () {\n    var logGroup = 'waitForObjAvailable';\n    var logger = function (event, data) {\n\n      if (window.BI && window.BI.console) {\n        window.BI.console.log(event, data, logGroup);\n      }\n    };\n    logger.logGroup = logGroup;\n    return logger;\n  })();\n\n  window.BI.waitForObjAvailable = function waitForObjAvailable(objStrArray, tries, callback, interval=100){\n    var allObjsAvailable = function(objStrArray){\n      for (var i = 0; i < objStrArray.length; i++) {\n        var obj = ('.'+objStrArray[i]).split('.').reduce(function(prev, cur){return prev[cur]? prev[cur] : window[cur];});\n        if (typeof obj === 'undefined') {\n          return false;\n        }\n      }\n      return true;\n    };\n    if (!allObjsAvailable(objStrArray)) {\n      if (tries > 0) {\n        setTimeout(function() {\n          BI.waitForObjAvailable(objStrArray, tries - 1, callback, interval);\n        }, interval);\n      } else {\n        logEvent('not available', { objStrArray, tries, callback, interval });\n      }\n    } else {\n      logEvent('available', { objStrArray, tries, callback, interval });\n      callback();\n    }\n  };\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"/* eslint-disable no-console */\n(function() {\n  var ENABLED = 'feature_enabled_by_onetrust';\n  var DISABLED = 'feature_disabled_by_onetrust';\n\n  window.$t('register', ENABLED);\n  window.$t('register', DISABLED);\n\n  window.BI.wrapWithOneTrustCat4 = function(fn, featureName = fn.name) {\n    window.BI.waitForObjAvailable(['mps', 'mps.geo', 'mps.geo.data'], 50, function() {\n      let mps = window.mps;\n      if (mps) {\n        mps.optCAT4Enabled = true;\n\n        var optanonCookie =\n          document &&\n          document.cookie &&\n          document.cookie\n            .split(';')\n            .map(s => s.trim())\n            .find(s => s.startsWith('OptanonConsent'));\n\n        var categoryEnabledRegexC4 = /groups=[^&]*%2C4%3A1/;\n        mps.optConsentAdMeasurement = categoryEnabledRegexC4.test(optanonCookie);\n\n        if (mps.geo.inGroup('eea')) {\n          if (mps.optConsentAdMeasurement) {\n            mps.optCAT4Enabled = true;\n\n          } else {\n            mps.optCAT4Enabled = false;\n          }\n        }\n      }\n\n      const eventData = { policy: 'CAT4', featureName };\n\n      if (mps.optCAT4Enabled === true) {\n        window.$t('track', ENABLED, eventData);\n        fn();\n      }\n      else {\n        window.$t('track', DISABLED, eventData);\n      }\n    });\n  };\n\n  window.BI.wrapWithOneTrustCat7 = function(fn, featureName = fn.name) {\n    window.BI.waitForObjAvailable(['mps', 'mps.geo', 'mps.geo.data'], 50, function() {\n      let mps = window.mps;\n      if (mps) {\n        mps.optCAT7Enabled = true;\n        var optanonCookie =\n          document &&\n          document.cookie &&\n          document.cookie\n            .split(';')\n            .map(s => s.trim())\n            .find(s => s.startsWith('OptanonConsent'));\n\n        var categoryEnabledRegexC7 = /groups=[^&]*%2C7%3A1/;\n        mps.optConsentContentMeasurement = categoryEnabledRegexC7.test(optanonCookie);\n\n        if (mps.geo.inGroup('eea')) {\n          if (mps.optConsentContentMeasurement) {\n            mps.optCAT7Enabled = true;\n          } else {\n            mps.optCAT7Enabled = false;\n          }\n        }\n\n        const eventData = { policy: 'CAT7', featureName };\n\n        if(mps.optCAT7Enabled) {\n          window.$t('track', ENABLED, eventData);\n          fn();\n        } else {\n          window.$t('track', DISABLED, eventData);\n        }\n      }\n    });\n\n  };\n\n  window.BI.wrapWithOneTrust = function({\n    fn = Function.prototype,\n    featureName = 'Unspecified Feature',\n    categories = [],\n  }) {\n    window.BI.waitForObjAvailable(['mps', 'mps.geo', 'mps.geo.data'], 50, function() {\n      let mps = window.mps;\n      let validCategories = categories.filter(c => ([4,6,7].includes(c)));\n\n      // Iterating over categories, filtering out unacceptable values\n      for (var category of validCategories) {\n        if (!mps) return;\n\n        let categoryEnabledFlag = `optCAT${category}Enabled`;\n        mps[categoryEnabledFlag] = true;\n\n        var optanonCookie =\n          document &&\n          document.cookie &&\n          document.cookie\n            .split(';')\n            .map(s => s.trim())\n            .find(s => s.startsWith('OptanonConsent'));\n\n        var categoryEnabledRegex = new RegExp(`groups=[^&]*%2C${category}%3A1`);\n        mps.optConsentAdMeasurement = categoryEnabledRegex.test(optanonCookie);\n\n        if (mps.geo.inGroup('eea')) {\n          if (mps.optConsentAdMeasurement) {\n            mps[categoryEnabledFlag] = true;\n          } else {\n            mps[categoryEnabledFlag] = false;\n          }\n        }\n      }\n\n      // Exiting early if any of the categories apply\n      for (var cat of validCategories) {\n        let categoryEnabledFlag = `optCAT${cat}Enabled`;\n\n        if (mps[categoryEnabledFlag] === false) {\n          window.$t('track', DISABLED, { policy: `CAT${cat}`, featureName });\n          return;\n        }\n      }\n\n      // Enabling the feature if none of the categories apply\n      window.$t('track', ENABLED, { featureName, categories });\n      fn();\n\n    });\n  };\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RL604578d22d584c719608fb48fd52eae2",name:"30 - MPS - Omniture Pagecall",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:30}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,
source:"/* eslint-disable */\n/*global __CNBC_META_DATA, mps, adobe, Optanon, BI */\n//Omni Setup\nvar s={};\nvar s_account='';\nif (document.location.host == 'www.cnbc.com' || document.location.host == 'dealornodeal.cnbc.com') {\n  s_account='nbcucnbcglobal,nbcucnbcall';\n}else{\n  s_account='nbcucnbcglobaldev';\n}\nvar s_omniServer='oimg.nbcuni.com';\nvar s_omniSecureServer='osimg.nbcuni.com';\nvar s_linkInternalFilters='javascript:,cnbc.com,taboolainternal,cnbcevents.com,cnbccouncils.com';\nvar currentURL = window.location.href || '';\n\nfunction deleteBedrockCookie() {\n  if (typeof window === 'undefined') {\n    return;\n  }\n  document.cookie = 'bedrocktrk=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/';\n  document.cookie = 'bedrocktrk=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;domain=.cnbc.com';\n}\n\n//Omni Execute\nwindow._executeOmniture = function() {\n//mps._loadJS('https://fm.cnbc.com/applications/cnbc.com/resources/files/2020/04/27/AppMeasurement.js?v=1.0',function(){\n  mps._loadJS('https://fm.cnbc.com/applications/cnbc.com/resources/files/2021/09/23/AppMeasurement.js',function(){\n\n    mps._log('**** LOADED: Omniture JS (AppMeasurement)');\n    var ALPHA_NUM_REGEX = /[^a-z0-9 ]+/gi;\n    var SPACE_FORMAT_REGEX = /\\s\\s+/g;\n\n\n    s.pageName = (!__CNBC_META_DATA.pageName) ? ('NA') : (__CNBC_META_DATA.pageName);\n    s.pageURL=window.location.toString();\n    if (__CNBC_META_DATA.id === '100' && currentURL.includes('watchlist/#!/watchlist') && !currentURL.includes('news')) {\n      s.pageName = 'Watchlist List';\n    } else if (__CNBC_META_DATA.id === '100' && currentURL.includes('news')) {\n      s.pageName = 'Watchlist News';\n    } else if (__CNBC_META_DATA.id === '100') {\n      s.pageName = 'Watchlist Dashboard'; \n    }\n\n    if (__CNBC_META_DATA.id === '100' && typeof __CNBC_META_DATA.watchlistPageLoaded == 'undefined') {\n      s.pageName = 'Investing Tools|Watchlist|Ignore';\n    }\n\n    s.pageURL = window.location.toString();\n\n    //referrer work around begins\n    window.__CNBC_Settings = window.__CNBC_Settings || {};\n    if (!window.__CNBC_Settings.loaded) {\n      window.__CNBC_Settings.referrer = document.referrer;\n    }\n    window.__CNBC_Settings.loaded = true;\n    s.referrer = window.__CNBC_Settings.referrer;\n    window.__CNBC_Settings.referrer = location.href;\n    //referrer work around ends\n\n    var isInvestingClubContent = false;\n    var isRegisteredOnly = false;\n\n    if (__CNBC_META_DATA && __CNBC_META_DATA.contentClassification && __CNBC_META_DATA.contentClassification.includes('investingClub')) {\n      isInvestingClubContent = true;\n    }\n\n    if (__CNBC_META_DATA && __CNBC_META_DATA.contentClassification && __CNBC_META_DATA.contentClassification.includes('registeredOnly')) {\n      isRegisteredOnly = true;\n    }\n\n    s.contextData['cnbc.pageURL'] = location.href;\n    s.contextData['cnbc.cleanurl'] = location.host + location.pathname;\n    s.contextData['cnbc.tags'] = (!__CNBC_META_DATA.relatedTagsFilteredFormatted) ? ('NA') : (__CNBC_META_DATA.relatedTagsFilteredFormatted);\n    s.contextData['cnbc.project'] = (!__CNBC_META_DATA.projectContentFormatted) ? ('NA') : (__CNBC_META_DATA.projectContentFormatted);\n    s.contextData['cnbc.team'] = (!__CNBC_META_DATA.projectTeamContentFormatted) ? ('NA') : (__CNBC_META_DATA.projectTeamContentFormatted);\n    s.contextData['cnbc.template'] = (!__CNBC_META_DATA.template) ? ('NA') : (__CNBC_META_DATA.template);\n    s.contextData['cnbc.brand'] = (!__CNBC_META_DATA.brand) ? ('NA') : (__CNBC_META_DATA.brand);\n\n    // assetstatus\n    if (__CNBC_META_DATA.premium == true) {\n      s.contextData['cnbc.assetstatus'] = 'Premium';\n    }\n    else if (isInvestingClubContent) {\n      s.contextData['cnbc.assetstatus'] = 'investingclub';\n    }\n    else if (isRegisteredOnly) {\n      s.contextData['cnbc.assetstatus'] = 'registeredonly';\n    }\n    else {\n      s.contextData['cnbc.assetstatus'] = 'Unrestricted';\n    }\n\n    s.contextData['cnbc.contenttype'] = (!__CNBC_META_DATA.type) ? ('NA') : (__CNBC_META_DATA.type);\n    s.contextData['cnbc.section'] = 'NA';\n    if (s.contextData['cnbc.contenttype'] == 'franchise'){\n      s.contextData['cnbc.section'] = (__CNBC_META_DATA.tagName.replace(ALPHA_NUM_REGEX, '').replace(SPACE_FORMAT_REGEX, ' ').trim());\n    } else if (__CNBC_META_DATA.section && __CNBC_META_DATA.section.tagName) {\n      s.contextData['cnbc.section'] = (__CNBC_META_DATA.section.tagName.replace(ALPHA_NUM_REGEX, '').replace(SPACE_FORMAT_REGEX, ' ').trim());\n    }\n    //s.contextData['cnbc.sectiontype'] = (!__CNBC_META_DATA.section || !__CNBC_META_DATA.section.subType) ? (\"NA\") : (__CNBC_META_DATA.section.subType);\n    if (s.contextData['cnbc.contenttype'] == 'franchise'){\n      s.contextData['cnbc.sectiontype'] = __CNBC_META_DATA.subType;\n    } else if (__CNBC_META_DATA.section && __CNBC_META_DATA.section.tagName) {\n      s.contextData['cnbc.sectiontype'] = (!__CNBC_META_DATA.section || !__CNBC_META_DATA.section.subType) ? ('NA') : (__CNBC_META_DATA.section.subType);\n    }\n    s.contextData['cnbc.creator'] = (!__CNBC_META_DATA.authorFormatted) ? ('NA') : (__CNBC_META_DATA.authorFormatted);\n    s.contextData['cnbc.hier1'] = (!__CNBC_META_DATA.sectionHierarchy[0]) ? ('NA') : (__CNBC_META_DATA.sectionHierarchy[0].tagNameFormattedFull);\n    s.contextData['cnbc.hier2'] = (!__CNBC_META_DATA.sectionHierarchy[1]) ? ('NA') : (__CNBC_META_DATA.sectionHierarchy[1].tagNameFormattedFull);\n    s.contextData['cnbc.hier3'] = (!__CNBC_META_DATA.sectionHierarchy[2]) ? ('NA') : (__CNBC_META_DATA.sectionHierarchy[2].tagNameFormattedFull);\n    s.contextData['cnbc.hier4'] = (!__CNBC_META_DATA.sectionHierarchy[3]) ? ('NA') : (__CNBC_META_DATA.sectionHierarchy[3].tagNameFormattedFull);\n    s.contextData['cnbc.hier5'] = (!__CNBC_META_DATA.sectionHierarchy[4]) ? ('NA') : (__CNBC_META_DATA.sectionHierarchy[4].tagNameFormattedFull);\n    s.contextData['cnbc.id'] = (!__CNBC_META_DATA.id) ? ('NA') : (__CNBC_META_DATA.id);\n    s.contextData['cnbc.source'] = (!__CNBC_META_DATA.sourceOrganizationFormatted) ? ('NA') : (__CNBC_META_DATA.sourceOrganizationFormatted);\n    s.contextData['cnbc.firstpubdate'] = (!__CNBC_META_DATA.shortDateFirstPublished) ? ('NA') : (__CNBC_META_DATA.shortDateFirstPublished);\n    s.contextData['cnbc.lastpubdate'] = (!__CNBC_META_DATA.shortDateLastPublished) ? ('NA') : (__CNBC_META_DATA.shortDateLastPublished);\n    s.contextData['cnbc.dateline'] =  (!__CNBC_META_DATA.shortDatePublished) ? ('NA') : (__CNBC_META_DATA.shortDatePublished);\n    s.contextData['cnbc.creatoroverwrite'] = (!__CNBC_META_DATA.creatorOverwriteFormatted) ? ('NA') : (__CNBC_META_DATA.creatorOverwriteFormatted);\n    s.contextData['cnbc.additionalsections'] = (!__CNBC_META_DATA.additionalSectionContentFormatted) ? ('NA') : (__CNBC_META_DATA.additionalSectionContentFormatted);\n    s.contextData['cnbc.platform'] = 'web';\n    // usagerule\n    if (__CNBC_META_DATA.premium == true){\n      s.contextData['cnbc.usagerule'] = 'premium';\n    } else if (isInvestingClubContent) {\n      s.contextData['cnbc.usagerule'] = 'investingclub';\n    } else if (__CNBC_META_DATA.native == true) {\n      s.contextData['cnbc.usagerule'] = 'native';\n    } else if (isRegisteredOnly) {\n      s.contextData['cnbc.usagerule'] = 'registeredonly';\n    } else {\n      s.contextData['cnbc.usagerule'] = 'NA';\n    }\n    s.contextData['cnbc.adblock'] = s.Util.cookieRead('__adblocker');\n    //    if (mps.pagevars.cid != \"100003114\" && mps.pagevars.cid != \"100727362\") {\n    //        s.contextData['cnbc.variationname'] = s.Util.cookieRead('article_experience');\n    //    }\n    //s.contextData['cnbc.variation'] = (! __CNBC_META_DATA.QuoteTVECTAExperimentVariation) ? (\"NA\") : (__CNBC_META_DATA.QuoteTVECTAExperimentVariation);\n\n    s.contextData['cnbc.variation'] = (!__CNBC_META_DATA.variation) ? ('NA') : (__CNBC_META_DATA.variation);\n\n\n    s.contextData['cnbc.packaging'] = (!__CNBC_META_DATA.packaging) ? ('NA') : (__CNBC_META_DATA.packaging);\n    if(mps._ck.r('active_partner_exp')=='xfinity') {\n      s.contextData['cnbc.xfinityheader'] = 'true';\n    } else if (mps.xfinity.checkRef()){\n      s.contextData['cnbc.xfinityheader'] = 'true';\n    } else {\n      s.contextData['cnbc.xfinityheader'] = 'false';\n    }\n    if (__CNBC_META_DATA.ticker) {\n      s.contextData['cnbc.ticker'] = __CNBC_META_DATA.ticker;\n      s.contextData['cnbc.tickerinfo'] = __CNBC_META_DATA.tickerInfo;\n    }\n    if (__CNBC_META_DATA.embeddedContent &&__CNBC_META_DATA.embeddedContent.related.length>0) {\n      s.contextData['cnbc.relatedContent'] = 'true';\n    }\n    else\n    {\n      s.contextData['cnbc.relatedContent'] = 'NA';\n    }\n    if (__CNBC_META_DATA.embeddedContent &&__CNBC_META_DATA.embeddedContent.dataviz.length>0) {\n      s.contextData['cnbc.dataviz'] = 'true';\n    }\n    else\n    {\n      s.contextData['cnbc.dataviz'] = 'NA';\n    }\n    //s.linkInternalFilters+=\",taboolainternal,cnbcevents.com\";\n    s.linkLeaveQueryString=true;\n    // paywall\n    if (mps.pagevars.type != 'franchise') {\n      var isProUser = __CNBC_META_DATA.user && __CNBC_META_DATA.user.isPro;\n      var isICUser = __CNBC_META_DATA.user && __CNBC_META_DATA.user.isInvestingClubUser;\n      var isBundleUser = __CNBC_META_DATA.user && __CNBC_META_DATA.user.hasPurchasedBundle;\n\n      \n      if (__CNBC_META_DATA.premium == true && !isProUser) {\n        s.contextData['cnbc.paywall'] = 'true';\n      } else if (isInvestingClubContent && !isICUser) {\n        s.contextData['cnbc.paywall'] = 'investingclubtrue';\n      }\n    }\n\n    isBundleUser ? s.contextData['cnbc.isBundleuser'] = true : s.contextData['cnbc.isBundleuser'] = 'NA';\n    s.contextData['cnbc.aam_sc'] = s.getAamSegments('aam_sc','aamsc');\n    s.contextData['tve.did'] = s.Util.cookieRead('aam_uuid') ? s.Util.cookieRead('aam_uuid') : (s.Util.cookieRead('aam_did') ? s.Util.cookieRead('aam_did') : 'demdex cookie not set');\n    //console.log(\"delete bedrocktrk cookie\");\n    deleteBedrockCookie();\n    s.contextData['cnbc.bedrock0'] = (!__CNBC_META_DATA.user) ? ('NA') : (__CNBC_META_DATA.user.userId);\n    var getBedrockString = function () {\n      var user = __CNBC_META_DATA.user;\n      if (!user) {\n        return 'NA';\n      }\n      // bedrockData\n      var status;\n      if (user.isPro && user.isInvestingClubUser) {\n        status = 'PRO,investingclub';\n      } else if (user.isPro) {\n        status = 'PRO';\n      } else if (user.isInvestingClubUser) {\n        status = 'investingclub';\n      } else {\n        status = 'free';\n      }\n      var result = `${user.userId}:registered:${status}:logged-in`;\n      return result;\n    };\n    s.contextData['cnbc.bedrockData'] = getBedrockString();\n\n\n    // Setting a variable that indicates that tracking originated\n    // in adobe launch\n    s.contextData['cnbc.isLaunch'] = true;\n\n    // Send mParticle id (mpid)\n    s.contextData['cnbc.mparticleid'] =\n      window.mParticle &&\n      mParticle.Identity &&\n      mParticle.Identity.getCurrentUser() &&\n      mParticle.Identity.getCurrentUser().getMPID()\n        ? mParticle.Identity.getCurrentUser().getMPID()\n        : 'NA';\n\n    //OneTrust GDPR Consent BEGIN\n    if (!document.cookie.match(/^(.*;)?\\s*OptanonConsent\\s*=\\s*[^;]+(.*)?$/)) {\n      mps.optConsentLoaded = false;\n      adobe.optIn.denyAll();\n      console.log('ADOBE CONSENT - OptanonConsent Cookie Does Not Exist');\n\n    } else {\n      mps.optConsentLoaded = true;\n      console.log('ADOBE CONSENT - OptanonConsent Cookie Exists');\n    }\n\n    var optanonCookie =\ndocument &&\ndocument.cookie &&\ndocument.cookie\n  .split(';')\n  .map(s => s.trim())\n  .find(s => s.startsWith('OptanonConsent'));\n    var categoryEnabledRegexC7 = /groups=[^&]*%2C7%3A1/;\n    mps.optConsentContentMeasurement = categoryEnabledRegexC7.test(optanonCookie);\n    var categoryEnabledRegexC4 = /groups=[^&]*%2C4%3A1/;\n    mps.optConsentAdMeasurement = categoryEnabledRegexC4.test(optanonCookie);\n    var groupsExist = /groups/;\n    mps.optCMActive = groupsExist.test(optanonCookie);\n\n    if (!mps.optConsentContentMeasurement && mps.optConsentLoaded) {\n      adobe.optIn.denyAll(); \n      console.log('ADOBE CONSENT - CAT 7 - Deny All');\n    } else {\n    //console.log('ADOBE CONSENT - Analytics: Yes');\n    }\n    if (!mps.optConsentAdMeasurement && mps.optConsentLoaded) {\n    //console.log('ADOBE CONSENT - AudienceManager: No');\n      adobe.optIn.denyAll(); \n      console.log('ADOBE CONSENT - CAT 4 - Deny All');\n    } else {\n    //console.log('ADOBE CONSENT - AudienceManager: Yes');\n    }\n    if (mps.optConsentAdMeasurement && mps.optConsentContentMeasurement) {\n      adobe.optIn.approveAll();\n      console.log('ADOBE CONSENT - Approve All');\n    }\n    adobe.optIn.complete();\n    //OneTrust GDPR Consent END\n\n    //<?php echo $ovars['append']; ?> //needs to be replaced with clientside append insert\n\n    /************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/\n\n\n    s.t();\n\n\n    if(typeof s === 'object') {\n    /*\n     * Plugin: manageVars v1.5 (requires s.pt utility if using AppMeasurement)\n     */\n      s.manageVars=new Function('c','l','f',''\n    +'var s=this,vl,la,vla;l=l?l:\\'\\';f=f?f:1;if(!s[c])return false;vl=\\'pag'\n    +'eName,purchaseID,channel,server,pageType,campaign,state,zip,events,'\n    +'products,transactionID\\';for(var n=1;n<76;n++)vl+=\\',prop\\'+n+\\',eVar\\'+'\n    +'n;for(n=1;n<6;n++)vl+=\\',hier\\'+n;for(n=1;n<4;n++)vl+=\\',list\\'+n;for(n'\n    +' in s.contextData)vl+=\\',contextData.\\'+n;if(l&&(f==1||f==2)){if(f==1'\n    +')vl=l.replace(\\'[\\\\\\'\\',\\'.\\').replace(\\'\\\\\\']\\',\\'\\');if(f==2){la=l.split(\\','\n    +'\\');vla=vl.split(\\',\\');vl=\\'\\';for(x in la){if(la[x].indexOf(\\'contextDa'\n    +'ta\\')>-1){lax=la[x].split(\\'\\\\\\'\\');la[x]=\\'contextData.\\'+lax[1];}for(y '\n    +'in vla){if(la[x]==vla[y]){vla[y]=\\'\\';}}}for(y in vla){vl+=vla[y]?\\',\\''\n    +'+vla[y]:\\'\\';}}s.pt(vl,\\',\\',c,0);return true;}else if(l==\\'\\'&&f==1){s.p'\n    +'t(vl,\\',\\',c,0);return true;}else return false;');\n      s.clearVars=new Function('t',''\n    +'var s=this;if(t.indexOf(\\'contextData\\')==-1)s[t]=\\'\\';else if(t.indexO'\n    +'f(\\'contextData\\')>-1){var c=t.substring(t.indexOf(\\'.\\')+1);s.contextD'\n    +'ata[c]=\\'\\';}');\n      s.lowercaseVars=new Function('t',''\n    +'var s=this;if(t!=\\'events\\'&&t.indexOf(\\'contextData\\')==-1&&s[t]){s[t]'\n    +'=s[t].toString();if(s[t].indexOf(\\'D=\\')!=0){s[t]=s[t].toLowerCase();'\n    +'}}else if(t.indexOf(\\'contextData\\')>-1){var c=t.substring(t.indexOf('\n    +'\\'.\\')+1);if(s.contextData[c]){s.contextData[c]=s.contextData[c].toSt'\n    +'ring();s.contextData[c]=s.contextData[c].toLowerCase();}}');\n      /*\n     * s.pt utility (runs function f against variables in x)\n     */\n      s.pt=new Function('x','d','f','a',''\n    +'var s=this,t=x,z=0,y,r;while(t){y=t.indexOf(d);y=y<0?t.length:y;t=t'\n    +'.substring(0,y);r=s[f](t,a);if(r)return r;z+=y+d.length;t=x.substri'\n    +'ng(z,x.length);t=z<x.length?t:\\'\\'}return\\'\\';');\n    }\n  });\n  console.log('finished executing omniture now');\n};\n  \nvar fnSoftPage_CNBC_SoftPageView = fnSoftPage_CNBC_SoftPageView || function (data) {\n  var currentURL1 = window.location.href || '';\n  if (__CNBC_META_DATA.premium && __CNBC_META_DATA.user && !__CNBC_META_DATA.user.isPro) {\n    console.log('soft page view console log');\n    return;\n  }\n  if (__CNBC_META_DATA.contentClassification?.includes('investingClub') && __CNBC_META_DATA.user && !__CNBC_META_DATA.user.isInvestingClubUser) {\n    console.log('soft page view console log');\n    return;\n  }\n  if (__CNBC_META_DATA.id === '100' && (currentURL1.includes('edit') || currentURL1.includes('manage'))) {\n    return;\n  }\n  if (typeof Optanon != 'undefined') {\n    if (!mps.optConsentContentMeasurement && mps.optConsentLoaded && mps.optCMActive) {\n      console.log('Soft Refresh Consent - CAT 7 - Deny All');\n    } else {\n      //console.log('Soft Refresh Consent - Analytics: Yes');\n    }\n    if (!mps.optConsentAdMeasurement && mps.optConsentLoaded && mps.optCMActive) {\n      console.log('Soft Refresh Consent - CAT 4 - Deny All');\n    } else {\n      //console.log('Soft Refresh Consent - AudienceManager: Yes');\n    }\n    if (mps.optConsentAdMeasurement && mps.optConsentContentMeasurement && Optanon.GetDomainData().ForceConsent) {\n      __CNBC_META_DATA.watchlistPageLoaded = true;\n      try {\n        s.contextData = {};\n        window._executeOmniture();\n        mps._executemParticle();\n        console.log('Soft Refresh Consent - Approve All');\n      }\n      catch(err) {\n        console.log('Soft Refresh Consent - ERROR');\n      }        \n    } \n    if (!Optanon.GetDomainData().ForceConsent) {\n      __CNBC_META_DATA.watchlistPageLoaded = true;\n      try {\n        s.contextData = {};\n        window._executeOmniture();\n        mps._executemParticle();\n        console.log('Soft Refresh Consent  NO CM- Approve All');\n      }\n      catch(err) {\n        console.log('Soft Refresh Consent - ERROR');\n      } \n    }\n  } else {\n    __CNBC_META_DATA.watchlistPageLoaded = true;\n    try {\n      s.contextData = {};\n      window._executeOmniture();\n      mps._executemParticle();\n      console.log('Soft Refresh Consent  NO CM- Approve All');\n    }\n    catch(err) {\n      console.log('Soft Refresh Consent  NO Optanon - ERROR');\n    }\n  }\n};\n//need to wait for a few dependencies, since it is required for the loaded AppMeasurement.js\nBI.waitForObjAvailable(['BI','mps','mps._loadJS','__EventBus__', 'Visitor','__CNBC_META_DATA'], 40, function(){\n  //map to mps object incause its used somewhere else\n  mps._executeOmniture = window._executeOmniture\n\n  //this timeout is for __CNBC_META_DATA.user, to load the bedrock data.\n  //it is copied from mps, but should be replaced later\n\n  var delayedExecuteOmniture = function() {\n    setTimeout(function(){\n      window._executeOmniture();\n    }, 2000); \n  };\n\n  BI.wrapWithOneTrust({\n    fn: delayedExecuteOmniture,\n    featureName: 'Omniture Pagecall',\n    categories: [4,7],\n  });\n\n  // Event listener triggered from UserProvider component in Phoenix\n  window.__EventBus__.remove('reloadOmniture',   window._executeOmniture);\n  window.__EventBus__.on('reloadOmniture',   window._executeOmniture);\n\n  window.__EventBus__.remove('softpageview', fnSoftPage_CNBC_SoftPageView);\n  window.__EventBus__.on('softpageview', fnSoftPage_CNBC_SoftPageView);\n}); \n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RL7579f0c416d049c78912624ea45a5238",name:"60 - univideo - product adapter (streamsense) [univideo, d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"/* global $t, ns_ */\n(function () {\n  const topLevelDomain = (function () {\n    const validDomains = ['cnbc.com'];\n    const isAmp = location.hash.indexOf('amp=1') != -1;\n    const ampDomainOverride = (location.hash.split('domain=')[1] || '').split('&')[0];\n    let topLevelDomain =\n      (isAmp && ampDomainOverride) || document.location.hostname.match(/[^./]+\\.[^./]+$/)[0];\n    topLevelDomain = validDomains.indexOf(topLevelDomain) != -1 ? topLevelDomain : 'cnbc.com';\n\n    return topLevelDomain;\n  })();\n\n  var logEvent = (function () {\n    var logGroup = 'uni_streamsense';\n    var logger = function (event, data) {\n      if (window.BI && window.BI.console) {\n        window.BI.console.log(event, data, logGroup);\n      }\n    };\n    logger.logGroup = logGroup;\n    return logger;\n  })();\n\n  //determine show name from various asset metadata\n  var deriveShowName = function(videoData) {\n    var showNameOverrides = {\n      'Deadline: White House': 'deadlinewhitehouse',\n      'MTP Daily': 'meetthepress',\n      'Dateline Digital': 'dateline',\n      'TODAY': 'todayallday',\n    };\n\n    var showName = videoData.source;\n\n    //return override if it exists, or format existing string\n    return showNameOverrides[showName] || showName.replaceAll(' ', '').toLowerCase();\n  };\n\n  var uniEvent = window.uniVideo && window.uniVideo.event || {};\n\n  var sites = {\n    'cnbc.com': {\n      st: 'cnbc',\n      pu: 'cnbc',\n      c3: 'cnbc',\n      c6Default: 'cnbc',\n    }\n  };\n\n  var streamingTag = null;\n  var previousVideoStopped = true;\n  var metadata = {};\n  var siteBrand = {};\n\n  for (let domainName of Object.keys(sites)) {\n    if (topLevelDomain && topLevelDomain.includes(domainName)) {\n      siteBrand = sites[domainName];\n    }\n  }\n\n  $t('on', 'uni_videoEvent', function (e, data) {\n    if (window.ns_ && ns_.StreamingTag && ns_.StreamingTag.ContentType) {\n      var videoData = data && data.videoData;\n      var videoState = data && data.videoState || {};\n      //disable comscore for any player that is not cvsdk\n      if (videoData.playbackAdapter != 'cvsdk') { return; }\n\n      var streamContentType = (function () {\n        if (videoData.streamType === 'linear') {\n          return ns_.StreamingTag.ContentType.Live;\n        } else {\n          return ns_.StreamingTag.ContentType.ShortFormOnDemand;\n        }\n      })();\n\n      var videoLength = (function () {\n        if (videoData.streamType === 'linear') {\n          return 0;\n        } else {\n          return videoData.duration;\n        }\n      })();\n\n\n      if (Object.keys(metadata).length == 0) {\n        metadata['ns_st_cl'] = videoLength;\n\n        let videoDataCopy = { ...videoData };\n        let taxonomyShow = $t(e.type + '.videoData.raw.taxonomy.primarySection.name');\n        if (taxonomyShow) videoDataCopy.source = taxonomyShow;\n\n        updateMetadata(videoDataCopy);\n      }\n\n      logEvent(data.eventType, { data: { ...data }, meta: { ...metadata } });\n\n      switch (data.eventType) {\n        case uniEvent.VIDEO_LOADED:\n          //set new streaming tag for each instance, stop previous if needed\n          if (!previousVideoStopped) {\n            streamingTag.stop();\n            logEvent('stop previous', metadata);\n          }\n          streamingTag = new ns_.StreamingTag({ customerC2: '6035083' });\n          logEvent('new streamingTag');\n          previousVideoStopped = false;\n          break;\n\n        case uniEvent.PLAY:\n          if (!videoState.inAd) {\n            if (streamingTag) {\n              streamingTag.playVideoContentPart(metadata, streamContentType);\n              logEvent('play', metadata);\n            }\n          }\n          break;\n        case uniEvent.AD_PLAY:\n          if (streamingTag) {\n            streamingTag.playVideoAdvertisement({ ns_st_cl: videoData.adLength || 0 }, streamContentType);\n            logEvent('play ad', metadata);\n          }\n          break;\n        case uniEvent.AD_COMPLETE:\n          if (streamingTag) {\n            streamingTag.stop();\n            logEvent('stop', metadata);\n          }\n          break;\n        case uniEvent.PAUSE:\n        case uniEvent.STOP:\n        case uniEvent.COMPLETE:\n          if (streamingTag) {\n            streamingTag.stop();\n            logEvent('stop', metadata);\n          }\n          previousVideoStopped = true;\n          break;\n      }\n    }\n  });\n\n  function updateMetadata(videoData) {\n    metadata = {\n      ...metadata,\n      ns_st_ci: videoData.guid || '0', // Content Asset ID\n      ns_st_st: siteBrand.st,\n      ns_st_pu: siteBrand.pu,\n      ns_st_pr: videoData.source || '*null', // Program Title\n      ns_st_ep: videoData.title || '*null', // Episode Title\n      ns_st_sn: '*null', // Episode Season Number\n      ns_st_en: '*null', // Episode Number\n      ns_st_ge: 'News', // Content Genre\n      ns_st_ti: '*null', // TMS ID (unavailable)\n      ns_st_ia: '0', // Identical Ad Assignment Flag\n      ns_st_ce: '0', // Complete Episode Flag\n      ns_st_ddt: '*null', // Digital Air Date (not setup) '2014-10-03'\n      ns_st_tdt: '*null', // TV Air Date (not setup) '2014-10-03'\n      c3: siteBrand.c3 || '*null', // Dictionary Classification Value\n      c4: '*null', // Unused Dictionary Classification Value\n      c6: deriveShowName(videoData) || siteBrand.c6Default // Unused Dictionary Classification Value\n    };\n  }\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RL84940d06cabd4155a4b88425a90acfc4",name:"50 - Action - Stock Screener [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"/*global $t, mParticle, s, __CNBC_META_DATA, BI */\n(function () {\n  function stockScreenerFlow() {\n    function trackAdobe(event) {\n      const actionContextData = {\n        'cnbc.action': event.action,\n        'cnbc.brand': event.brand,\n        'cnbc.platform': event.platform\n      };\n\n      if (event.attributeCategoryList) actionContextData['cnbc.attributeCategoryList'] = event.attributeCategoryList;\n      if (event.attributeCompleteList) actionContextData['cnbc.attributeCompleteList'] = event.attributeCompleteList;\n      if (event.numberofscreen) actionContextData['cnbc.numberofscreen'] = event.numberofscreen;\n      if (event.screeninfo) actionContextData['cnbc.screeninfo'] = event.screeninfo;\n\n      s.linkTrackVars = false;\n      s.contextData = { ...s.contextData, ...actionContextData };\n      const combinedLinkTrackVars = Object.keys(actionContextData).map(key => `contextData.${key}`);\n      s.linkTrackVars = combinedLinkTrackVars.join(',');\n\n      s.tl(true, 'o', event.action, null, 'navigate');\n      for (var item in actionContextData) {\n        delete s.contextData[item];\n      }\n    }\n\n    function trackMparticle(event) {\n      const actionContextData = {\n        'Page Name': event.pageName,\n        'Page Type': event.pageType,\n        'Flow': event.flow,\n        'Platform': event.platform,\n        'Product': event.product,\n        'Referrer': event.referrer,\n        'User Agent': event.userAgent,\n        'Page URL': event.pageUrl,\n      };\n      if (event.attributeCategoryList) actionContextData['Attribute Category List'] = event.attributeCategoryList;\n      if (event.attributeCompleteList) actionContextData['Attribute Complete List'] = event.attributeCompleteList;\n      if (event.numberofscreen) actionContextData['Number of Screen'] = event.numberofscreen;\n      if (event.screeninfo) actionContextData['Screen Info'] = event.screeninfo;\n\n      mParticle.logEvent(\n        event.action, // Event Name\n        mParticle.EventType.Navigation, // Event Type\n        actionContextData, // Event Attributes (custom)\n      );\n    }\n\n    // Builds an object of all values used by Adobe and mParticle from\n    // raw event data, __CNBC_META_DATA, window, and document properties\n    function convertEventData(raw) {\n\n      const eventObject = {\n        action: raw.action,\n        articleId: __CNBC_META_DATA.id || 'NA',\n        brand: __CNBC_META_DATA.brand || 'NA',\n        flow: 'Stock Screener',\n        platform: 'web',\n        product: 'cnbc.com',\n        referrer: document.referrer,\n        userAgent: navigator.userAgent,\n        pageName: __CNBC_META_DATA.pageName || 'NA',\n        pageType: __CNBC_META_DATA.type || 'NA',\n        pageUrl: window.location.toString(),\n      };\n        // Add categoryList and completeList attributes if they exists. Cast boolean to string.\n      if (Object.prototype.hasOwnProperty.call(raw,'attributeCategoryList') && raw.attributeCategoryList !== null) eventObject.attributeCategoryList = `${raw.attributeCategoryList}`;\n      if (Object.prototype.hasOwnProperty.call(raw,'attributeCompleteList') && raw.attributeCompleteList !== null) eventObject.attributeCompleteList = `${raw.attributeCompleteList}`;\n      if (Object.prototype.hasOwnProperty.call(raw,'screeninfo') && raw.screeninfo !== null) eventObject.screeninfo = `${raw.screeninfo}`;\n      if (Object.prototype.hasOwnProperty.call(raw,'numberofscreen') && raw.numberofscreen !== null) eventObject.numberofscreen = `${raw.numberofscreen}`;\n\n      return eventObject;\n    }\n\n    $t('on', 'bte_event', (e, { data, eventName }) => {\n      //let's not send tracking on the cancel and start events, only success\n      const exclusionPhrases = ['EDIT SCREEN START', 'DELETE CANCEL', 'DELETE SCREEN START', 'SAVE CANCEL', 'SAVE SCREEN START', 'EDIT SCREEN CANCEL'];\n\n      if (\n        eventName === 'stockScreenerFlow' &&\n          data.dataset?.analyticId?.startsWith('pro:stockscreener:') &&\n          !exclusionPhrases.some(exclusion => data?.dataset.analyticId.toUpperCase().includes(exclusion))\n      ) {\n        // Destructure data from BTE event with default null values for items that are not guaranteed\n        const {\n          analyticId: action = null,\n          attributeCategoryList = null,\n          attributeCompleteList = null,\n          numberofscreen = null,\n          screeninfo = null\n        } = data.dataset;\n\n\n        // Build event object\n        const eventData = convertEventData({\n          action,\n          attributeCategoryList,\n          attributeCompleteList,\n          numberofscreen,\n          screeninfo\n        });\n\n        BI.waitForObjAvailable(['mParticle', 's', 's.tl'], 50, () => {\n          // track events in Adobe & mParticle\n          if (eventData) {\n            trackAdobe(eventData);\n            trackMparticle(eventData);\n          }\n        });\n      }\n    });\n  }\n\n  BI.wrapWithOneTrust({\n    fn: stockScreenerFlow,\n    featureName: 'Stock Screener Flow',\n    categories: [4,7],\n  });\n\n})();",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RL860b7d2f656e4c3babcae0320f4877b3",name:"60 - univideo - product adapter (heartbeat) [univideo, d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,
source:"(function () {\n  /*global $t, ADB, AppMeasurement, BI, visitor, mps*/\n  $t('register', ['univideo_ahb_adobeAppMeasurmentLoaded', 'univideo_event_hbPassthrough']);\n\n  //setup passthrough event if video events come through before heartbeat is setup\n  var passThroughQueue = [];\n  var heartbeatActive = false;\n  $t('on', 'uni_videoEvent', function (_e, data) {\n    //logEvent('uni_videoEvent_logger', data);\n    if (!heartbeatActive) {\n      passThroughQueue.push(data);\n    }\n\n    if (heartbeatActive) {\n      if (passThroughQueue !== 'read') {\n        passThroughQueue.forEach(queueItemData => {\n          logEvent('heartbeatActive:3:', queueItemData);\n          $t('track', 'univideo_event_hbPassthrough', queueItemData);\n        });\n      }\n      passThroughQueue = 'read';\n      $t('track', 'univideo_event_hbPassthrough', data);\n    }\n  });\n\n  // setup onetrust GDRP consent\n  BI.waitForObjAvailable(\n    ['s', 'AppMeasurement', 'ADB', 'visitor', 'mps', 'mps.geo', 'mps.geo.data'],\n    200,\n    function () {\n      mps.optCAT4Enabled = true;\n      var optanonCookie =\n        document &&\n        document.cookie &&\n        document.cookie\n          .split(';')\n          .map(s => s.trim())\n          .find(s => s.startsWith('OptanonConsent'));\n      var categoryEnabledRegexC4 = /groups=[^&]*%2C4%3A1/;\n      mps.optConsentAdMeasurement = categoryEnabledRegexC4.test(optanonCookie);\n      if (mps.geo.inGroup('eea')) {\n        if (mps.optConsentAdMeasurement) {\n          mps.optCAT4Enabled = true;\n        } else {\n          mps.optCAT4Enabled = false;\n        }\n      }\n\n      if (mps.optCAT4Enabled == true) {\n        //Marketing and Targeted Advertising tracking code goes here\n        // (these console log statements are a holdover from MPS)\n        console.log('Adobe HB - CAT4 - Enabled'); //eslint-disable-line no-console\n        setupHeartbeat(window.s);\n        heartbeatActive = true;\n      } else {\n        console.log('Adobe HB - CAT4 - Disabled'); //eslint-disable-line no-console\n      }\n    }\n  );\n\n  var logEvent = (function () {\n    var logGroup = 'uni_heartbeat';\n    var logger = function (event, data) {\n      if (window.BI && window.BI.console) {\n        window.BI.console.log(event, data, logGroup);\n      }\n    };\n    logger.logGroup = logGroup;\n    return logger;\n  })();\n\n  var uniEvent = (window.uniVideo && window.uniVideo.event) || {};\n  var setupHeartbeat = function (s) {\n    var noValue = 'unknown';\n    // privates\n    var _mediaHeartbeat = null;\n    var _appMeasurement = null;\n    var _playheadPosition = 0;\n    var _startupTime = 0;\n\n    // constructors from adobe for delegate\n    var CustomMediaHeartbeatDelegate = new ADB.va.MediaHeartbeatDelegate();\n    var MediaHeartbeat = ADB.va.MediaHeartbeat; // mapping to match documentation\n\n    CustomMediaHeartbeatDelegate.getCurrentPlaybackTime = function () {\n      // playhead will be 0 for ads.\n      return Math.round(_playheadPosition / 1000) || 0;\n    };\n\n    CustomMediaHeartbeatDelegate.getQoSObject = function () {\n      // dont have QOS data right now (<bitrate>, <startuptime>, <fps>, <droppedFrames>)\n      return MediaHeartbeat.createQoSObject(0, Math.round(_startupTime), 0, 0);\n    };\n\n    var createAMandHBObjects = function (playerName, appVersion) {\n      var debugState =\n        (window.BI && BI.console.list() && BI.console.list()[logEvent.logGroup] === 'true') || false;\n      // create new appMeasurementmain and heartbeat instance\n      if (!_mediaHeartbeat) {\n        // use DTM values since this may load before the page track is complete\n        var appMAccounts = s.allAccounts || []; //get from site specific function\n        // TODO: this shouldnt be cnbc specific, and there needs to be a DEV account for NBCUTVE\n        if (playerName === 'cvsdk') {\n          appMAccounts.push('nbcutve');\n        }\n        // Set-up the AppMeasurement component using values from page version.\n        _appMeasurement = new AppMeasurement(appMAccounts.join());\n        _appMeasurement.visitor = visitor;\n        _appMeasurement.trackingServer = s.trackingServer;\n        _appMeasurement.trackingServerSecure = s.trackingServerSecure;\n        _appMeasurement.charSet = 'UTF-8';\n        _appMeasurement.doPlugins = false;\n        _appMeasurement.ssl = true;\n        $t('track', 'univideo_ahb_adobeAppMeasurmentLoaded', {\n          sc_obj: _appMeasurement,\n        });\n\n        // Media Heartbeat initialization\n        var mediaConfig = new ADB.va.MediaHeartbeatConfig();\n        mediaConfig.trackingServer = 'nbcume.hb.omtrdc.net';\n        mediaConfig.playerName = playerName || noValue; //ex cnbclinear-web-player\n        mediaConfig.debugLogging = debugState; // set this to false for production apps.\n        mediaConfig.ssl = true;\n        mediaConfig.appVersion = appVersion || noValue;\n        mediaConfig.ovp = noValue; // TODO need to populate later\n        mediaConfig.channel = 'On-domain'; //TODO 'Off-domain' if embedded video\n\n        _mediaHeartbeat = new MediaHeartbeat(CustomMediaHeartbeatDelegate, mediaConfig, _appMeasurement);\n      }\n    };\n\n    // setup events\n    $t('on', 'univideo_event_hbPassthrough', function (_e, data) {\n      var videoData = data.videoData || {};\n      var videoState = data.videoState || {};\n      var eventType = data.eventType;\n\n      // if data is coming from queue\n      if (eventType === 'univideo_event_hbPassthrough') {\n        videoData = data.data.videoData;\n        videoState = data.data.videoState;\n        eventType = data.data.eventType;\n        setupHeartbeat();\n      }\n\n      _startupTime = videoState.startupTime;\n\n      if (videoData && videoData.playheadPosition) {\n        _playheadPosition = Math.round(videoData.playheadPosition);\n      }\n\n      if (eventType === uniEvent.PROGRESS) {\n        return;\n      }\n\n      // if the heartbeat instance wasn't created yet, do it now\n      createAMandHBObjects(videoData.playbackAdapter, videoData.custom.appVersion);\n\n      // had to move this out becuase of the pre-load event firing, and not knowing if ad_Start or content_Start firing\n      var startSession = function (customContextData) {\n        // start session on first frame\n\n        if (videoState.playState === 'stop' || videoState.segmentPosition > 1) {\n          var mediaInfo = MediaHeartbeat.createMediaObject(\n            customContextData.videotitle || noValue, // video name\n            customContextData.videoguid || noValue, // video ID\n            (function () {\n              if (videoData.streamType === 'linear') {\n                return -1; // set duration to -1 if its linear\n              } else {\n                return videoData.duration || 0;\n              }\n            })(), // videoLength\n            (function () {\n              // TODO: The JW Player is used to serve \"Live\" video (breaking, Berkshire, etc.)\n              // videoType will be === 'Linear' but HB tracking should be set to 'LIVE'\n              // https://nbcnewsdigital.atlassian.net/browse/AFT-826\n              if (videoData.streamType === 'linear') {\n                if (videoData.custom.adobeLiveStream) {\n                  return MediaHeartbeat.StreamType.LIVE;\n                } else {\n                  return MediaHeartbeat.StreamType.LINEAR;\n                }\n              } else {\n                return MediaHeartbeat.StreamType.VOD; // default VOD\n              }\n            })()\n          );\n          _mediaHeartbeat.trackSessionStart(mediaInfo, customContextData);\n        }\n      };\n\n      var customContextData = {\n        name: videoData?.title,\n        id: videoData?.custom?.vcpsId || '',\n        ...buildCustomContextData(videoData),\n      };\n\n      logEvent(data.eventType, { data: data, contextData: customContextData, state: videoState });\n\n      // specific events\n      switch (eventType) {\n        case uniEvent.VIDEO_LOADED:\n          if (videoState.playState !== 'stop') {\n            // if other video is started while in pause, close out last session, and reset values\n            _mediaHeartbeat.trackSessionEnd();\n          }\n\n          // reload app measurement settings before a videoLoad (to be sure its up to date)\n          _appMeasurement.clearVars();\n          _appMeasurement.pageName = s.pageName;\n          startSession(customContextData);\n          break;\n\n        case uniEvent.PLAY:\n          if (videoState.playState !== 'play') {\n            // if first asset after load\n            _mediaHeartbeat.trackPlay();\n          }\n          break;\n        case uniEvent.PAUSE:\n          _mediaHeartbeat.trackPause();\n          break;\n        case uniEvent.SEEK_START:\n          _mediaHeartbeat.trackEvent(MediaHeartbeat.Event.SeekStart);\n          break;\n        case uniEvent.SEEK_COMPLETE:\n          _mediaHeartbeat.trackEvent(MediaHeartbeat.Event.SeekComplete);\n\n          /* track rewind event (TODO not setup)\n          if (videoData.playheadPosition < videoData.playheadPosition)) {\n            _appMeasurement.contextData = customContextData;\n            _appMeasurement.contextData.videoscrub = 'rewind';\n            _appMeasurement.tl(this, 'o', 'Video Rewind', null);\n          }\n          */\n          break;\n        case uniEvent.COMPLETE: // TODO not setup\n          _mediaHeartbeat.trackComplete();\n          _mediaHeartbeat.trackSessionEnd();\n          break;\n        case uniEvent.STOP:\n          _mediaHeartbeat.trackSessionEnd();\n          break;\n        case uniEvent.AD_BREAK_START:\n          var adBreakInfo = MediaHeartbeat.createAdBreakObject(\n            videoData.custom.adBreakName || noValue, // ad break name, a.k.a. adPodFriendlyName\n            videoState.adBreakPosition, // position\n            videoData.playheadPosition // startTime\n          );\n          _mediaHeartbeat.trackEvent(MediaHeartbeat.Event.AdBreakStart, adBreakInfo);\n          break;\n        case uniEvent.AD_BREAK_COMPLETE:\n          _mediaHeartbeat.trackEvent(MediaHeartbeat.Event.AdBreakComplete);\n          break;\n        case uniEvent.AD_PLAY:\n          //start session if ad play is first\n          startSession(customContextData);\n\n          // for ads, its only ever at the beginings for now, so hard coded\n          var randomAdId = 'rand_' + ((Math.random() * 36 * 100000) | 0).toString(36);\n          var adInfo = MediaHeartbeat.createAdObject(\n            videoData.adName || noValue, // name\n            videoData.adId || randomAdId, // id\n            videoState.adPosition, // position\n            videoData.adLength || 15 // length\n          );\n\n          _mediaHeartbeat.trackEvent(MediaHeartbeat.Event.AdStart, adInfo, customContextData);\n\n          // do the track play AFTER the ad starts\n          if (false || videoState.playState !== 'play') {\n            _mediaHeartbeat.trackPlay();\n          }\n\n          break;\n        case uniEvent.AD_COMPLETE:\n          _mediaHeartbeat.trackEvent(MediaHeartbeat.Event.AdComplete);\n          break;\n        case uniEvent.SEGMENT_START:\n          if (videoState.segmentPosition > 1) {\n            _appMeasurement.clearVars();\n            _appMeasurement.pageName = s.pageName;\n            startSession(customContextData);\n          }\n          var chapterInfo = MediaHeartbeat.createChapterObject(\n            videoData.custom.segmentTitle || videoData.assetID, // CHAPTER_NAME\n            videoState.segmentPosition, //POSITION\n            videoData.custom.runtime || -1, //LENGTH\n            videoState.playheadPosition //START_TIME\n          );\n          _mediaHeartbeat.trackEvent(MediaHeartbeat.Event.ChapterStart, chapterInfo, {\n            segmentType: 'Program',\n            segmentName: videoData.custom.segmentTitle || videoData.assetID,\n          });\n          if (videoState.playState === 'play') {\n            _mediaHeartbeat.trackPlay();\n          } else if (videoState.playState === 'pause') {\n            _mediaHeartbeat.trackPause();\n          }\n          break;\n        case uniEvent.SEGMENT_END:\n          if (videoState.playState === 'play') {\n            // fire ADB HB completion events if segment ends while video is playing\n            _mediaHeartbeat.trackEvent(MediaHeartbeat.Event.ChapterComplete);\n            _mediaHeartbeat.trackComplete();\n          } else if (videoState.playState === 'pause') {\n            _mediaHeartbeat.trackEvent(MediaHeartbeat.Event.ChapterSkip);\n          }\n          _mediaHeartbeat.trackSessionEnd();\n          break;\n        default:\n          break;\n      }\n    });\n  };\n\n  function buildCustomContextData(videoData) {\n    let noValue = 'unknown';\n    let now = new Date();\n    let days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n    const getTwoDigitTime = val => (val < 10 ? `0${val}` : val);\n\n    let customContextData = {\n      playerVersion: videoData.custom.playerVersion || noValue,\n      videoairdate: videoData.dateBroadcast !== '' ? new Date(Date.parse(videoData.dateBroadcast)).toLocaleDateString('en-US') : noValue, //ex '6/4/2023'\n      videopubdate: videoData.datePublished !== '' ? new Date(Date.parse(videoData.datePublished)).toLocaleDateString('en-US') : noValue,\n      videoapp: videoData.custom.appName || noValue,\n      videoappversion: videoData.custom.appVersion || noValue,\n      videocallsign: noValue,\n      videocliptype: noValue,\n      videodate: now.toLocaleDateString(), // format('MM/DD/YYYY')\n      videoday: days[now.getDay()],\n      videodaypart: noValue,\n      videodomain: window.location.hostname || noValue,\n      videoepnumber: videoData.custom.seriesEpisodeNumber || noValue,\n      videoguid: videoData.guid || noValue, //ex '5724738528402108117'\n      videohour: `${getTwoDigitTime(now.getHours())}:00`, // format('HH:00')\n      videoinitiate: videoData.playInitiate || noValue,\n      videominute: `${getTwoDigitTime(now.getHours())}:${getTwoDigitTime(now.getMinutes())}`, // format('HH:mm')\n      videomvpd: videoData.custom.mvpd || noValue, //ex Comcast_SSO\n      videoNetwork: videoData.newsNetwork || 'CNBC',\n      videoplatform: 'PC',\n      videoplayertech: videoData.playbackAdapter || noValue, //ex 'HLS'\n      videoplayerurl: window.location.toString() || noValue,\n      videoprogram: videoData.custom.program || videoData.source || noValue, //ex 'Last Call'\n      videoscreen: 'Normal',\n      videoseason: videoData.custom.tvSeasonNumber || noValue,\n      videostatus:\n        videoData.custom.videoStatus || (videoData.streamType === 'linear' ? 'Unrestricted' : 'Restricted'),\n      videosubcat1: videoData.custom.videosubcat1 || noValue,\n      videosubcat2: videoData.custom.videosubcat2 || noValue,\n      videotitle: videoData.title || noValue, //ex 'Last Call'\n      videotmsid: videoData.custom.episodeGuid || noValue, //ex 'EP046484850064'\n    };\n\n    return customContextData;\n  }\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLa9bb4a76ea9e497fb862287ec4f54072",name:"40 - Convert Big Time Event Bus (BTE) to $t [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:40}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"/* global $t, BI */\n(function () {\n  // Setting up BI console log functions\n  var logEvent = (window.BI && BI.console && BI.console.build('BTE')) || Function.prototype;\n\n  // Defining a list of all \"Big Time Event Bus\" event names\n  const eventList = [\n    'click',\n    'acountflow',\n    'authflow',\n    'authFlow',\n    'proPlayerToggle',\n    'videoPopout',\n    'videoPopoutRef',\n    'videoLinearBackToCNBC',\n    'videoLinear30SecondsWatched',\n    'videoLinear8SecondsWatched',\n    'videoLinearAdComplete',\n    'videoLinearAdPause',\n    'videoLinearAdStart',\n    'videoLinearEvery30SecondsWatched',\n    'videoLinearStart',\n    'videoLinearPause',\n    'videoLinearResume',\n    'videoLinearReturnToLive',\n    'videoLinearScrub',\n    'videoAudioTrackChanged',\n    'videoReplay',\n    'videoCancelEndCardExternal',\n    'videoDockedUndockicon',\n    'videoDockedClose',\n    'videoAdComplete',\n    'videoAdPause',\n    'videoAdStart',\n    'videoComplete',\n    'videoStart',\n    'videoPauseExternal',\n    'videoPause',\n    'videoResume',\n    'videoSeek',\n    'videoClip25',\n    'videoClip50',\n    'videoClip75',\n    'video8SecondsWatched',\n    'video30SecondsWatched',\n    'videoEveryMinuteWatched',\n    'videoShare',\n    'videoEmbedClick',\n    'videoProviderSharing',\n    'videoFullScreen',\n    'videoPlaybackRateChanged',\n    'videoClosedCaption',\n    'videoJumpBack',\n    'jwPlayerLiveStreamReadyEvent',\n    'jwPlayerVodReadyEvent',\n    'subscriptionsFlow',\n    'stockScreenerFlow',\n    'pianoTemplateOnLoad'\n  ];\n\n  $t('register', 'bte_event');\n  BI.waitForObjAvailable(['__EventBus__', '__EventBus__.on'], 50, () => {\n    const BTE = window.__EventBus__;\n    // Converting BTE events to $t, and BI logging them\n    eventList.forEach(function (eventName) {\n      BTE.on(eventName, function (data) {\n        $t('track', 'bte_event', { eventName, data });\n        logEvent(eventName, data);\n      });\n    });\n  });\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"(function () {\n  /* global $t */\n\n  // Registering new events that will fire when a JW Player\n  // instance or video metadata are available.\n  $t('register', 'cnbc_jw_player_loaded');\n  $t('register', 'cnbc_video_metadata_loaded');\n\n  // Handling Metadata Load\n  $t('on', 'bte_event', function (e, data) {\n    switch (data.eventName) {\n      case 'jwPlayerVodReadyEvent':\n      case 'jwPlayerLiveStreamReadyEvent':\n        $t('track', 'cnbc_jw_player_loaded', { JWPlayer: data.data.jwPlayerReference, callingEvent: data.eventName });\n        $t('track', 'cnbc_video_metadata_loaded', { ...data.data });\n        break;\n    }\n  });\n})();",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLaac9bc29c54e48e99b308d75b6fde881",name:"50 - univideo - core  [univideo, d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"(function () {\n  /* global $t */\n  var isEmpty = function (obj) {\n    return Object.keys(obj).length === 0 && obj.constructor === Object;\n  };\n  window.uniVideo = (function () {\n    var extend = function (defaults, options) {\n      var extended = {};\n      var prop;\n      for (prop in defaults) {\n        if (Object.prototype.hasOwnProperty.call(defaults, prop)) {\n          extended[prop] = defaults[prop];\n        }\n      }\n      for (prop in options) {\n        if (Object.prototype.hasOwnProperty.call(options, prop)) {\n          extended[prop] = options[prop];\n        }\n      }\n      return extended;\n    };\n\n    var uniVideo = {};\n\n    uniVideo.event = {\n      PROGRESS: 'PROGRESS',\n      INIT: 'INIT',\n      VIDEO_LOADED: 'VIDEO_LOADED',\n      PLAY: 'PLAY',\n      PAUSE: 'PAUSE',\n      SEEK_START: 'SEEK_START',\n      SEEK_COMPLETE: 'SEEK_COMPLETE',\n      STOP: 'STOP',\n      COMPLETE: 'COMPLETE',\n      AD_BREAK_START: 'AD_BREAK_START',\n      AD_BREAK_COMPLETE: 'AD_BREAK_COMPLETE',\n      AD_PLAY: 'AD_PLAY',\n      AD_COMPLETE: 'AD_COMPLETE',\n      FULLSCREEN: 'FULLSCREEN',\n      SEGMENT_START: 'SEGMENT_START',\n      SEGMENT_END: 'SEGMENT_END'\n    };\n\n    uniVideo.buildUniTrack = function () {\n\n      // register $t event\n      $t('register', 'uni_videoEvent', { allowDuplicate: true }); //if different players are using it\n\n      var videoData = {};\n      var videoDataDefaults = {\n        adId: '',\n        adLength: 0, //seconds\n        adName: '',\n        adBreakName: '', //preroll, midroll, postroll\n        assetID: '', //for SCTE info since no ID or title\n        dateBroadcast: '', //js toIsoString ex: \"2019-11-06T17:52:27.351Z\"\n        datePublished: '', //js toIsoString ex: \"2019-11-06T17:52:27.351Z\"\n        duration: '', //seconds\n        guid: '',\n        mpxId: '',\n        newsNetwork: '',\n        playbackAdapter: '',\n        playheadPosition: 0, // miliseconds\n        playInitiate: '', // (Continuous,Manual,Auto)\n        playListId: '',\n        playListLabel: '',\n        sentiment: '',\n        source: '',\n        streamType: '', // (linear, vod)\n        title: '',\n        videoCount: 0,\n        videoType: '',\n      };\n\n      // video state WHEN the event happened, not after\n      var videoState = {};\n      var videoStateDefaults = {\n        inAd: false,\n        inSegment: false,\n        segmentPosition: 1,\n        adPosition: 1,\n        adBreakPosition: 1,\n        playState: 'stop', //stop, play, pause\n        fullScreen: false,\n        isMuted: false\n      };\n\n      var uniTrack = function (eventName) {\n        $t('track', 'uni_videoEvent', {\n          eventType: eventName,\n          videoData: uniTrack.videoData(),\n          videoState: uniTrack.videoState()\n        });\n      };\n\n      uniTrack.videoData = function (newSettings, setDefaults) {\n        if (isEmpty(videoData)) {\n          videoData = videoDataDefaults;\n        }\n        if (newSettings) {\n          var previousSettings = setDefaults ? videoDataDefaults : videoData;\n          videoData = extend(previousSettings, newSettings);\n        } else {\n          return videoData;\n        }\n      };\n\n      uniTrack.videoState = function (newSettings, setDefaults) {\n        if (isEmpty(videoState)) {\n          videoState = videoStateDefaults;\n        }\n        if (newSettings) {\n          var previousSettings = setDefaults ? videoStateDefaults : videoState;\n          videoState = extend(previousSettings, newSettings);\n        } else {\n          return videoState;\n        }\n      };\n      return uniTrack;\n    };\n    return uniVideo;\n  })();\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLba0a6bff02e148f8ac78e448e32186d1",name:"30 - Streamsense SDK [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:30}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,
source:'/* eslint-disable */\n\n/* Copyright (c) 2016 comScore, Inc.\n    * All rights reserved.\n    * By using this software, you are agreeing to be bound by the\n    * terms of these policies: http://www.comscore.com/About_comScore/Privacy_Policy\n    */\n!function(a,b){false&&"function"==typeof define&&define.a?define([],function(){return a.ns_=b(a.ns_)}):"object"==typeof module&&module.exports?module.exports=b():a.ns_=b(a.ns_)}(this,function(a){a=a||{},a.ns_=a;var b={uid:function(){var a=1;return function(){return+new Date+"_"+a++}}(),filter:function(a,b){var c={};for(var d in b)b.hasOwnProperty(d)&&a(b[d])&&(c[d]=b[d]);return c},extend:function(a){var b,c=arguments.length;a=a||{};for(var d=1;c>d;d++)if(b=arguments[d])for(var e in b)b.hasOwnProperty(e)&&(a[e]=b[e]);return a},getString:function(a,b){var c=String(a);return null==a?b||"na":c},getLong:function(a,b){var c=Number(a);return null==a||isNaN(c)?b||0:c},getInteger:function(a,b){var c=Number(parseInt(a));return null==a||isNaN(c)?b||0:c},getBoolean:function(a,b){var c="true"==String(a).toLowerCase();return null==a?b||!1:c},parseBoolean:function(a,b){return b=b||!1,a?"0"==a?!1:void 0:b},isNotEmpty:function(a){return!this.isEmpty(a)},isEmpty:function(a){return void 0===a||null===a||""===a||a instanceof Array&&0===a.length},indexOf:function(a,b){var c=-1;return this.forEach(b,function(b,d){b==a&&(c=d)}),c},forEach:function(a,b,c){try{if("function"==typeof b)if(c="undefined"!=typeof c?c:null,"number"!=typeof a.length||"undefined"==typeof a[0]){var d="undefined"!=typeof a.__proto__;for(var e in a)a.hasOwnProperty(e)&&(!d||d&&"undefined"==typeof a.__proto__[e])&&"function"!=typeof a[e]&&b.call(c,a[e],e)}else for(var f=0,g=a.length;g>f;f++)b.call(c,a[f],f)}catch(h){}},regionMatches:function(a,b,c,d,e){if(0>b||0>d||b+e>a.length||d+e>c.length)return!1;for(;--e>=0;){var f=a.charAt(b++),g=c.charAt(d++);if(f!=g)return!1}return!0},size:function(a){var b=0;for(var c in a)a.hasOwnProperty(c)&&b++;return b},log:function(a,b){if("undefined"!=typeof b&&b&&"undefined"!=typeof console&&console){var c=new Date,d=c.getHours()+":"+c.getMinutes()+":"+c.getSeconds();console.log(d,a)}},isTrue:function(a){return"undefined"==typeof a?!1:"string"==typeof a?(a=a.toLowerCase(),"true"===a||"1"===a||"on"===a):!!a},toString:function(a){if("undefined"==typeof a)return"undefined";if("string"==typeof a)return a;if("[object Array]"===Object.prototype.toString.call(a))return a.join(",");if(this.size(a)>0){var b="";for(var c in a)a.hasOwnProperty(c)&&(b+=c+":"+a[c]+";");return b}return a.toString()},exists:function(a){return"undefined"!=typeof a&&null!=a},firstGreaterThan0:function(){for(var a=0,b=arguments.length;b>a;a++){var c=arguments[a];if(c>0)return c}return 0},cloneObject:function(a){if(null==a||"object"!=typeof a)return a;var b=function(){function a(){}function b(b){return"object"==typeof b?(a.prototype=b,new a):b}function c(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}function d(){this.copiedObjects=[];var a=this;this.recursiveDeepCopy=function(b){return a.deepCopy(b)},this.depth=0}function e(a,b){var c=new d;return b&&(c.maxDepth=b),c.deepCopy(a)}function f(a){return"undefined"!=typeof window&&window&&window.Node?a instanceof Node:"undefined"!=typeof document&&a===document?!0:"number"==typeof a.nodeType&&a.attributes&&a.childNodes&&a.cloneNode}var g=[];return c.prototype={constructor:c,canCopy:function(){return!1},create:function(a){},populate:function(a,b,c){}},d.prototype={constructor:d,maxDepth:256,cacheResult:function(a,b){this.copiedObjects.push([a,b])},getCachedResult:function(a){for(var b=this.copiedObjects,c=b.length,d=0;c>d;d++)if(b[d][0]===a)return b[d][1]},deepCopy:function(a){if(null===a)return null;if("object"!=typeof a)return a;var b=this.getCachedResult(a);if(b)return b;for(var c=0;c<g.length;c++){var d=g[c];if(d.canCopy(a))return this.applyDeepCopier(d,a)}throw new Error("Unable to clone the following object "+a)},applyDeepCopier:function(a,b){var c=a.create(b);if(this.cacheResult(b,c),this.depth++,this.depth>this.maxDepth)throw new Error("Maximum recursion depth exceeded.");return a.populate(this.recursiveDeepCopy,b,c),this.depth--,c}},e.DeepCopier=c,e.deepCopiers=g,e.register=function(a){a instanceof c||(a=new c(a)),g.unshift(a)},e.register({canCopy:function(){return!0},create:function(a){return a instanceof a.constructor?b(a.constructor.prototype):{}},populate:function(a,b,c){for(var d in b)b.hasOwnProperty(d)&&(c[d]=a(b[d]));return c}}),e.register({canCopy:function(a){return a instanceof Array},create:function(a){return new a.constructor},populate:function(a,b,c){for(var d=0;d<b.length;d++)c.push(a(b[d]));return c}}),e.register({canCopy:function(a){return a instanceof Date},create:function(a){return new Date(a)}}),e.register({canCopy:function(a){return f(a)},create:function(a){return"undefined"!=typeof document&&a===document?document:a.cloneNode(!1)},populate:function(a,b,c){if("undefined"!=typeof document&&b===document)return document;if(b.childNodes&&b.childNodes.length)for(var d=0;d<b.childNodes.length;d++){var e=a(b.childNodes[d]);c.appendChild(e)}}}),{deepCopy:e}}();return b.deepCopy(a)},safeGet:function(a,b){return b=this.exists(b)?b:"",this.exists(a)?a:b},getBrowserName:function(){if(!navigator)return"";var a,b,c=navigator.userAgent||"",d=navigator.appName||"";return-1!=(b=c.indexOf("Opera"))||-1!=(b=c.indexOf("OPR/"))?d="Opera":-1!=(b=c.indexOf("Android"))?d="Android":-1!=(b=c.indexOf("Chrome"))?d="Chrome":-1!=(b=c.indexOf("Safari"))?d="Safari":-1!=(b=c.indexOf("Firefox"))?d="Firefox":-1!=(b=c.indexOf("IEMobile"))?d="Internet Explorer Mobile":"Microsoft Internet Explorer"==d||"Netscape"==d?d="Internet Explorer":(a=c.lastIndexOf(" ")+1)<(b=c.lastIndexOf("/"))?(d=c.substring(a,b),d.toLowerCase()==d.toUpperCase()&&(d=navigator.appName)):d="unknown",d},getBrowserFullVersion:function(){if(!navigator)return"";var a,b,c,d,e=navigator.userAgent||"",f=navigator.appName||"",g=navigator.appVersion?""+parseFloat(navigator.appVersion):"";return-1!=(b=e.indexOf("Opera"))?(g=e.substring(b+6),-1!=(b=e.indexOf("Version"))&&(g=e.substring(b+8))):-1!=(b=e.indexOf("OPR/"))?g=e.substring(b+4):-1!=(b=e.indexOf("Android"))?g=e.substring(b+11):-1!=(b=e.indexOf("Chrome"))?g=e.substring(b+7):-1!=(b=e.indexOf("Safari"))?(g=e.substring(b+7),-1!=(b=e.indexOf("Version"))&&(g=e.substring(b+8))):-1!=(b=e.indexOf("Firefox"))?g=e.substring(b+8):"Microsoft Internet Explorer"==f?(d=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!=d.exec(e)&&(g=parseFloat(RegExp.$1))):"Netscape"==f?(d=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!=d.exec(e)&&(g=parseFloat(RegExp.$1))):g=e.lastIndexOf(" ")+1<(b=e.lastIndexOf("/"))?e.substring(b+1):"unknown",g=g.toString(),-1!=(c=g.indexOf(";"))&&(g=g.substring(0,c)),-1!=(c=g.indexOf(" "))&&(g=g.substring(0,c)),-1!=(c=g.indexOf(")"))&&(g=g.substring(0,c)),a=parseInt(""+g,10),isNaN(a)&&(g=""+parseFloat(navigator.appVersion)),g},browserAcceptsLargeURLs:function(){return"undefined"!=typeof window?(null!==window.ActiveXObject,!0):!0},getNamespace:function(){return a.ns_||a}};return a.StreamSense=a.StreamSense||function(){var c=function(){var a="cs_";return function(){var c="undefined"!=typeof localStorage?localStorage:null;b.extend(this,{get:function(b){return c&&c.getItem(a+b)},set:function(b,d){c&&c.setItem(a+b,d)},has:function(b){return c&&c.getItem(a+b)},remove:function(b){c&&c.removeItem(a+b)},clear:function(){for(var b=0;c&&b<c.length;++b){var d=c.key(b);d.substr(0,a.length)===a&&c.removeItem(d)}}})}}(),d=function(a,b){if("undefined"!=typeof Image){var c=new Image;c.onload=function(){b&&b(200),c=null},c.onerror=function(){b&&b(),c=null},c.src=a}},e=function(a,b,c){c&&"undefined"!=typeof setTimeout&&setTimeout(c,0)},f=function(){return{dir:function(){return null},append:function(a,b,c){},write:function(a,b,c){},deleteFile:function(){return!1},read:function(){return null}}}(),g=function(){return{PLATFORM:"generic",httpGet:d,httpPost:e,Storage:c,IO:f,getCrossPublisherId:function(){return null},getAppName:function(){return h.UNKNOWN_VALUE},getAppVersion:function(){return h.UNKNOWN_VALUE},getVisitorId:function(){return this.getDeviceName()+ +new Date+~~(1e3*Math.random())},getVisitorIdSuffix:function(){return"72"},getDeviceName:function(){return h.UNKNOWN_VALUE},getPlatformVersion:function(){return h.UNKNOWN_VALUE},getPlatformName:function(){return"js"},getRuntimeName:function(){return h.UNKNOWN_VALUE},getRuntimeVersion:function(){return h.UNKNOWN_VALUE},getResolution:function(){return h.UNKNOWN_VALUE},getLanguage:function(){return h.UNKNOWN_VALUE},getPackageName:function(){return null},isConnectionAvailable:function(){return!0},isCompatible:function(){return!0},autoSelect:function(){},setPlatformAPI:function(){},isCrossPublisherIdChanged:function(){return!1},setTimeout:function(a,b){return setTimeout(a,b)},clearTimeout:function(a){return clearTimeout(a)},getDeviceArchitecture:function(){return h.UNKNOWN_VALUE},getConnectionType:function(){return h.UNKNOWN_VALUE},getDeviceJailBrokenFlag:function(){return h.UNKNOWN_VALUE},isConnSecure:function(){return"s"===document.location.href.charAt(4)},processMeasurementLabels:function(){}}}(),h={UNKNOWN_VALUE:"unknown",UNKNOWN_RESOLUTION:"0x0"};b.jsonObjectToStringDictionary=function(a){var b={};for(var c in a){var d=a[c];null===d||void 0===d?b[c]=d:b[c]=a[c]+""}return b},b.getKeys=function(a,b){var c,d=[];for(c in a)b&&!b.test(c)||!a.hasOwnProperty(c)||(d[d.length]=c);return d},b.fixEventTime=function(a){if(a.ns_ts)return parseInt(a.ns_ts);var b=+new Date;return a.ns_ts=String(b),b},b.isBrowser=function(){return"undefined"!=typeof window&&"undefined"!=typeof document},b.addNewPlaybackInterval=function(a,c,d,e){var f={};if(!(d>=c))return b.cloneObject(a);if(f.start=c,f.end=d,0==a.length)return a.push(f),b.cloneObject(a);var g;for(g=0;g<a.length;g++)if(f.start>=a[g].start&&f.end<=a[g].end)return b.cloneObject(a);var h,i=!1;for(h=0;h<a.length;h++)if(h+1===a.length&&f.start>=a[h].start||f.start>=a[h].start&&f.start<a[h+1].start){a.splice(h+1,0,f),i=!0;break}i||a.splice(0,0,f);var j=[a[0]];for(g=1;g<a.length;g++)j[j.length-1].end+e<a[g].start?j.push(a[g]):j[j.length-1].end<a[g].end&&(j[j.length-1].end=a[g].end);return b.cloneObject(j)};var i=function(){var a=["play","pause","pause-on-buffering","end","buffer","buffer-stop","keep-alive","hb","custom","load","start","skstart","adskip","cta","error","trans","drmfa","drmap","drmde","bitrt","playrt","volume","window","audio","video","subs","cdn"];return{PLAY:0,PAUSE:1,PAUSE_ON_BUFFERING:2,END:3,BUFFER:4,BUFFER_STOP:5,KEEPALIVE:6,HEARTBEAT:7,CUSTOM:8,LOAD:9,START:10,SEEK_START:11,AD_SKIP:12,CTA:13,ERROR:14,TRANSFER:15,DRM_FAILED:16,DRM_APPROVED:17,DRM_DENIED:18,BIT_RATE:19,PLAYBACK_RATE:20,VOLUME:21,WINDOW_STATE:22,AUDIO:23,VIDEO:24,SUBS:25,CDN:26,toString:function(b){return a[b]}}}(),j=function(){return{IDLE:0,PLAYBACK_NOT_STARTED:1,PLAYING:2,PAUSED:3,BUFFERING_BEFORE_PLAYBACK:4,BUFFERING_DURING_PLAYBACK:5,BUFFERING_DURING_SEEKING:6,BUFFERING_DURING_PAUSE:7,SEEKING_BEFORE_PLAYBACK:8,SEEKING_DURING_PLAYBACK:9,SEEKING_DURING_BUFFERING:10,SEEKING_DURING_PAUSE:11,PAUSED_DURING_BUFFERING:12}}(),k=function(){var a=["c","s","r"];return{SINGLE_CLIP:0,SEGMENTED:1,REDUCED:2,toString:function(b){return a[b]}}}(),l={STREAMSENSE_VERSION:"5.1.1.160316",MODEL_VERSION:"5.1",DEFAULT_PLAYERNAME:"js_api",DEFAULT_HEARTBEAT_INTERVAL:[{playingtime:6e4,interval:1e4},{playingtime:null,interval:6e4}],DEFAULT_KEEP_ALIVE_INTERVAL:12e5,DEFAULT_PAUSED_ON_BUFFERING_INTERVAL:500,C1_VALUE:"19",C10_VALUE:"js",NS_AP_C12M_VALUE:"1",NS_NC_VALUE:"1",PAGE_NAME_LABEL:"name",RESTRICTED_URL_LENGTH_LIMIT:2048,URL_LENGTH_LIMIT:4096,THROTTLING_DELAY:500,INTERVAL_MERGE_TOLERANCE:500,STANDARD_METADATA_LABELS:["ns_st_ci","ns_st_pr","ns_st_sn","ns_st_en","ns_st_ep","ns_st_ty","ns_st_ct","ns_st_li","ns_st_ad","ns_st_bn","ns_st_tb","ns_st_an","ns_st_ta","ns_st_pu","c3","c4","c6"],LABELS_ORDER:["c1","c2","ca2","cb2","cc2","cd2","ns_site","ca_ns_site","cb_ns_site","cc_ns_site","cd_ns_site","ns_vsite","ca_ns_vsite","cb_ns_vsite","cc_ns_vsite","cd_ns_vsite","ns_alias","ca_ns_alias","cb_ns_alias","cc_ns_alias","cd_ns_alias","ns_ap_an","ca_ns_ap_an","cb_ns_ap_an","cc_ns_ap_an","cd_ns_ap_an","ns_ap_pn","ns_ap_pv","c12","ca12","cb12","cc12","cd12","ns_ak","ns_ap_hw","name","ns_ap_ni","ns_ap_ec","ns_ap_ev","ns_ap_device","ns_ap_id","ns_ap_csf","ns_ap_bi","ns_ap_pfm","ns_ap_pfv","ns_ap_ver","ca_ns_ap_ver","cb_ns_ap_ver","cc_ns_ap_ver","cd_ns_ap_ver","ns_ap_sv","ns_ap_cv","ns_type","ca_ns_type","cb_ns_type","cc_ns_type","cd_ns_type","ns_radio","ns_nc","cs_partner","cs_xcid","ns_ap_ui","ca_ns_ap_ui","cb_ns_ap_ui","cc_ns_ap_ui","cd_ns_ap_ui","ns_ap_gs","ns_st_sv","ns_st_pv","ns_st_smv","ns_st_it","ns_st_id","ns_st_ec","ns_st_sp","ns_st_sc","ns_st_sq","ns_st_ppc","ns_st_apc","ns_st_spc","ns_st_cn","ns_st_ev","ns_st_po","ns_st_cl","ns_st_el","ns_st_sl","ns_st_pb","ns_st_hc","ns_st_mp","ca_ns_st_mp","cb_ns_st_mp","cc_ns_st_mp","cd_ns_st_mp","ns_st_mv","ca_ns_st_mv","cb_ns_st_mv","cc_ns_st_mv","cd_ns_st_mv","ns_st_pn","ns_st_tp","ns_st_ad","ns_st_li","ns_st_ci","ns_st_si","ns_st_pt","ns_st_dpt","ns_st_ipt","ns_st_et","ns_st_det","ns_st_upc","ns_st_dupc","ns_st_iupc","ns_st_upa","ns_st_dupa","ns_st_iupa","ns_st_lpc","ns_st_dlpc","ns_st_lpa","ns_st_dlpa","ns_st_pa","ns_ap_jb","ns_ap_et","ns_ap_res","ns_ap_sd","ns_ap_po","ns_ap_ot","ns_ap_c12m","cs_c12u","ca_cs_c12u","cb_cs_c12u","cc_cs_c12u","cd_cs_c12u","ns_ap_install","ns_ap_updated","ns_ap_lastrun","ns_ap_cs","ns_ap_runs","ns_ap_usage","ns_ap_fg","ns_ap_ft","ns_ap_dft","ns_ap_bt","ns_ap_dbt","ns_ap_dit","ns_ap_as","ns_ap_das","ns_ap_it","ns_ap_uc","ns_ap_aus","ns_ap_daus","ns_ap_us","ns_ap_dus","ns_ap_ut","ns_ap_oc","ns_ap_uxc","ns_ap_uxs","ns_ap_lang","ns_ap_ar","ns_ap_miss","ns_ts","ns_st_ca","ns_st_cp","ns_st_er","ca_ns_st_er","cb_ns_st_er","cc_ns_st_er","cd_ns_st_er","ns_st_pe","ns_st_ui","ca_ns_st_ui","cb_ns_st_ui","cc_ns_st_ui","cd_ns_st_ui","ns_st_bc","ns_st_dbc","ns_st_bt","ns_st_dbt","ns_st_bp","ns_st_lt","ns_st_skc","ns_st_dskc","ns_st_ska","ns_st_dska","ns_st_skd","ns_st_skt","ns_st_dskt","ns_st_pc","ns_st_dpc","ns_st_pp","ns_st_br","ns_st_pbr","ns_st_rt","ns_st_prt","ns_st_ub","ns_st_vo","ns_st_pvo","ns_st_ws","ns_st_pws","ns_st_ki","ns_st_rp","ns_st_bn","ns_st_tb","ns_st_an","ns_st_ta","ns_st_pl","ns_st_pr","ns_st_sn","ns_st_en","ns_st_ep","ns_st_sr","ns_st_ty","ns_st_ct","ns_st_cs","ns_st_ge","ns_st_st","ns_st_ce","ns_st_ia","ns_st_dt","ns_st_ddt","ns_st_tdt","ns_st_tm","ns_st_dtm","ns_st_ttm","ns_st_de","ns_st_pu","ns_st_ti","ns_st_cu","ns_st_fee","ns_st_at","ns_st_pat","ns_st_vt","ns_st_pvt","ns_st_tt","ns_st_ptt","ns_st_cdn","ns_st_pcdn","ns_ap_i1","ns_ap_i2","ns_ap_i3","ns_ap_i4","ns_ap_i5","ns_ap_i6","ns_ap_referrer","ns_clid","ns_campaign","ns_source","ns_mchannel","ns_linkname","ns_fee","gclid","utm_campaign","utm_source","utm_medium","utm_term","utm_content","ns_ecommerce","ns_ec_sv","ns_client_id","ns_order_id","ns_ec_cur","ns_orderline_id","ns_orderlines","ns_prod_id","ns_qty","ns_prod_price","ns_prod_grp","ns_brand","ns_shop","ns_category","category","ns_c","ns_search_term","ns_search_result","ns_m_exp","ns_m_chs","c3","ca3","cb3","cc3","cd3","c4","ca4","cb4","cc4","cd4","c5","ca5","cb5","cc5","cd5","c6","ca6","cb6","cc6","cd6","c10","c11","c13","c14","c15","c16","c7","c8","c9","ns_ap_er"]},m=function(){function a(){function a(){I={},I.ns_st_pt="0",I.ns_st_bt="0",I.ns_st_bc="0",I.ns_st_pc="0",I.ns_st_sq="0",I.ns_st_cl="0",I.ns_st_pn="1",I.ns_st_tp="1",I.ns_st_skc="0",I.ns_st_et="0",I.ns_st_cn="1",I.ns_st_sc="0",I.ns_st_ska="0",I.ns_st_skd="0",I.ns_st_skt="0",I.ns_st_upc="0",I.ns_st_lpc="0",I.ns_st_upa="0",I.ns_st_lpa="0",I.ns_st_ub="0",I.ns_st_br="0",f=!1,e=!1,d=h.UNKNOWN_VALUE,g=NaN,m=0,j=0,i=NaN,n=NaN,p=0,o=0,k=0,s=NaN,q=[],r=[],t=0,u=0,v=0,w=0,x=0,y=0,z=NaN,A=0,B=!1,C=NaN,F=!1,E=0,H=0,D=0,G=0,J=0,K=0,L=0,M=0,N=0}function c(){var a,b,c=0;for(a=0;a<q.length;a++)c+=Math.abs(q[a].end-q[a].start);O.setUniquePlaybackInterval(c);var d=0;for(a=0;a<q.length;a++)b=Math.abs(q[a].end-q[a].start),b>d&&(d=b);O.setLongestPlaybackInterval(d);var e=0;for(a=0;a<r.length;a++)e+=Math.abs(r[a].end-r[a].start);O.setAssetUniquePlaybackInterval(e);var f=0;for(a=0;a<r.length;a++)b=Math.abs(r[a].end-r[a].start),b>f&&(f=b);O.setAssetLongestPlaybackInterval(f)}var d,e,f,g,i,j,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=this,P=l.INTERVAL_MERGE_TOLERANCE;b.extend(this,{getHash:function(){return d},setHash:function(a){d=a},setPlaybackIntervalMergeTolerance:function(a){P=a},getPlaybackIntervalMergeTolerance:function(){return P},setLabels:function(a){null!=a&&b.extend(I,a)},getLabels:function(){return I},setLabel:function(a,b){var c={};c[a]=b,O.setLabels(c)},getLabel:function(a){return I[a]},getClipNumber:function(){return parseInt(O.getLabel("ns_st_cn"))},setClipNumber:function(a){O.setLabel("ns_st_cn",String(a))},getPartNumber:function(){return parseInt(O.getLabel("ns_st_pn"))},createLabels:function(a){var c=a||{};c.ns_st_dbt=String(O.getBufferingTime()-A),A=O.getBufferingTime(),c.ns_st_det=String(O.getElapsedTime()-o),o=O.getElapsedTime(),c.ns_st_dupc=String(O.getUniquePlaybackInterval()-t),t=O.getUniquePlaybackInterval(),parseInt(c.ns_st_dupc)<0&&(c.ns_st_dupc="0");var d;d=b.exists(c.ns_st_upc)?parseInt(c.ns_st_upc):O.getUniquePlaybackInterval(),c.ns_st_iupc=String(d-u),u=d,parseInt(c.ns_st_iupc)<0&&(c.ns_st_iupc="0"),c.ns_st_dupa=String(O.getAssetUniquePlaybackInterval()-v),v=O.getAssetUniquePlaybackInterval(),parseInt(c.ns_st_dupa)<0&&(c.ns_st_dupa="0");var e;e=b.exists(c.ns_st_upa)?parseInt(c.ns_st_upa):O.getAssetUniquePlaybackInterval(),c.ns_st_iupa=String(e-w),w=e,parseInt(c.ns_st_iupa)<0&&(c.ns_st_iupa="0"),c.ns_st_dlpc=String(O.getLongestPlaybackInterval()-x),x=O.getLongestPlaybackInterval(),parseInt(c.ns_st_dlpc)<0&&(c.ns_st_dlpc="0"),c.ns_st_dlpa=String(O.getAssetLongestPlaybackInterval()-y),y=O.getAssetLongestPlaybackInterval(),parseInt(c.ns_st_dlpa)<0&&(c.ns_st_dlpa="0");var g;return g=b.exists(c.ns_st_pt)?parseInt(c.ns_st_pt):O.getPlaybackTime(),c.ns_st_ipt=String(g-k),k=g,c.ns_st_dpt=String(O.getPlaybackTime()-j),j=O.getPlaybackTime(),c.ns_st_dpc=String(O.getPauses()-J),J=O.getPauses(),c.ns_st_dskc=String(O.getSeeks()-K),K=O.getSeeks(),c.ns_st_dbc=String(O.getBuffers()-L),L=O.getBuffers(),c.ns_st_dskt=String(O.getSeekingTime()-D),D=O.getSeekingTime(),c.ns_st_dska=String(O.getSeekingAmount()-G),G=O.getSeekingAmount(),b.extend(c,O.getLabels()),O.setSeekingDirection(0),f&&(c.ns_st_spc=String(M),c.ns_st_apc=String(N)),f||b.parseBoolean(c.ns_st_sc)||(c.ns_st_sc="1"),c},getVideoTrack:function(){return O.getLabel("ns_st_vt")},setVideoTrack:function(a){O.setLabel("ns_st_vt",String(a))},getAudioTrack:function(){return O.getLabel("ns_st_at")},setAudioTrack:function(a){O.setLabel("ns_st_at",String(a))},getSubtitleTrack:function(){return O.getLabel("ns_st_tt")},setSubtitleTrack:function(a){O.setLabel("ns_st_tt",String(a))},getCDN:function(){return O.getLabel("ns_st_cdn")},setCDN:function(a){O.setLabel("ns_st_cdn",String(a))},getClipPlaybackIntervals:function(){return q},setClipPlaybackIntervals:function(a){q=a},getAssetPlaybackIntervals:function(){return r},getUniquePlaybackInterval:function(){return parseInt(O.getLabel("ns_st_upc"))},getAssetUniquePlaybackInterval:function(){return parseInt(O.getLabel("ns_st_upa"))},setAssetUniquePlaybackInterval:function(a){O.setLabel("ns_st_upa",String(a))},setUniquePlaybackInterval:function(a){O.setLabel("ns_st_upc",String(a))},getLongestPlaybackInterval:function(){return parseInt(O.getLabel("ns_st_lpc"))},setLongestPlaybackInterval:function(a){O.setLabel("ns_st_lpc",String(a))},getAssetLongestPlaybackInterval:function(){return parseInt(O.getLabel("ns_st_lpa"))},setAssetLongestPlaybackInterval:function(a){O.setLabel("ns_st_lpa",String(a))},incrementPauses:function(){O.setLabel("ns_st_pc",String(O.getPauses()+1))},incrementSeeks:function(){O.setLabel("ns_st_skc",String(O.getSeeks()+1))},incrementPlayCounter:function(){O.setLabel("ns_st_sq",String(O.getPlayCounter()+1))},getPlayCounter:function(){return parseInt(O.getLabel("ns_st_sq"))},getBufferingTime:function(){return parseInt(O.getLabel("ns_st_bt"))},setBufferingTime:function(a){O.setLabel("ns_st_bt",String(a))},addBufferingTime:function(a){if(!isNaN(z)){var b=O.getBufferingTime();b+=a-z,O.setBufferingTime(b),z=NaN}},setPlaybackStartPosition:function(a){s=parseInt(a)},getPlaybackStartPosition:function(){return s},addInterval:function(a){isNaN(s)||isNaN(a)||(q=b.addNewPlaybackInterval(q,s,a,P),r=b.addNewPlaybackInterval(r,s,a,P),c(),s=NaN)},getElapsedTime:function(){return parseInt(O.getLabel("ns_st_et"))},setElapsedTime:function(a){O.setLabel("ns_st_et",String(a))},addElapsedTime:function(a){if(!isNaN(n)){var b=O.getElapsedTime();b+=a-n,O.setElapsedTime(b),n=NaN}},getElapsedTimestamp:function(){return n},setElapsedTimestamp:function(a){n=a},addPlaybackTime:function(a){if(!isNaN(g)){var b=O.getPlaybackTime();b+=a-g,O.setPlaybackTime(b),g=NaN}},getPlaybackTime:function(){return parseInt(O.getLabel("ns_st_pt"))},getExpectedPlaybackPosition:function(a){return isNaN(g)||(m+=a-g),m},setPlaybackTimeOffset:function(a){m=a},getPlaybackTimeOffset:function(){return m},setPlaybackTime:function(a){O.setLabel("ns_st_pt",String(a))},getPlaybackTimestamp:function(){return g},setPlaybackTimestamp:function(a){g=a},setPreviousPlaybackTime:function(a){j=a},setPreviousPlaybackTimestamp:function(a){i=a},getBufferingTimestamp:function(){return z},setBufferingTimestamp:function(a){z=a},getPauses:function(){return parseInt(O.getLabel("ns_st_pc"))},setPauses:function(a){O.setLabel("ns_st_pc",String(a))},getSeeks:function(){return parseInt(O.getLabel("ns_st_skc"))},setSeeks:function(a){O.setLabel("ns_st_skc",String(a))},setSeeking:function(a){B=a},isSeeking:function(){return B},setCollectingSeekingTime:function(a){F=a},isCollectingSeekingTime:function(){return F},setClipStarted:function(a){e=a},isClipStarted:function(){return e},setPlaybackStarted:function(a){f=a},isPlaybackStarted:function(){return f},setSeekingTimestamp:function(a){C=a},getSeekingTimestamp:function(){return C},addSeekingTime:function(a){if(!isNaN(C)){var b=O.getSeekingTime();b+=a-C,O.setSeekingTime(b),C=NaN}},getSeekingTime:function(){return parseInt(O.getLabel("ns_st_skt"))},setSeekingTime:function(a){O.setLabel("ns_st_skt",String(a))},setSeekingTimeBeforeEnd:function(a){H=a},getSeekingTimeBeforeEnd:function(){return H},setSeekStartPosition:function(a){E=a},getSeekStartPosition:function(){return E},setSeekingAmount:function(a){O.setLabel("ns_st_ska",String(a))},getSeekingAmount:function(){return parseInt(O.getLabel("ns_st_ska"))},addSeekingAmount:function(a){var b=O.getSeekingAmount();b+=Math.abs(a-E),O.setSeekingAmount(b);var c;E==a?c=0:E>a?c=-1:a>E&&(c=1),O.setSeekingDirection(c),E=0},getSeekingDirection:function(){return parseInt(O.getLabel("ns_st_skd"))},setSeekingDirection:function(a){O.setLabel("ns_st_skd",String(a))},resetClipLifecycleLabels:function(){I.ns_st_pt="0",j=0,k=0,I.ns_st_bt="0",A=0,I.ns_st_bc="0",L=0,I.ns_st_pc="0",J=0,I.ns_st_sq="0",I.ns_st_upa="0",v=0,w=0,I.ns_st_et="0",o=0,I.ns_st_lpa="0",y=0,I.ns_st_skt="0",D=0,I.ns_st_ska="0",G=0,I.ns_st_skc="0",K=0},incrementSegmentPlaybackCounter:function(){M++},incrementClipLoadCounter:function(){O.setLabel("ns_st_sc",String(O.getClipLoadCounter()+1))},incrementAssetPlaybackCounter:function(){N++},setPreviousUniquePlaybackInterval:function(a){t=a},setPreviousEventIndependentUniquePlaybackInterval:function(a){u=a},setPreviousLongestPlaybackInterval:function(a){x=a},resetAssetPlaybackCounters:function(){r=[],O.setAssetUniquePlaybackInterval(0),v=0,w=0,O.setAssetLongestPlaybackInterval(0),y=0},setSegmentPlaybackCounter:function(a){M=a},setClipLoadCounter:function(a){O.setLabel("ns_st_sc",String(a))},setAssetPlaybackCounter:function(a){N=a},setLowestPartNumberPlayed:function(a){p=a},getSegmentPlaybackCounter:function(){return M},getClipLoadCounter:function(){return parseInt(O.getLabel("ns_st_sc"))},getAssetPlaybackCounter:function(){return N},getLowestPartNumberPlayed:function(){return p},getBuffers:function(){return parseInt(O.getLabel("ns_st_bc"))},incrementBufferCount:function(){O.setLabel("ns_st_bc",String(O.getBuffers()+1))},getPreviousBufferingTime:function(){return A}}),a()}return a.resetClip=function(a,b,c){for(var d=a.getLabels(),e={},f=0;c&&f<c.length;++f)d.hasOwnProperty(c[f])&&(e[c[f]]=d[c[f]]);b.setLabels(e),b.setPlaybackIntervalMergeTolerance(a.getPlaybackIntervalMergeTolerance())},a}(),n=function(){function a(){function a(){c=new m,f={},f.ns_st_bp="0",f.ns_st_pa="0",f.ns_st_pp="0",f.ns_st_sp="1",f.ns_st_id=String(+new Date),d=NaN,e=NaN,h={},i=0,g=!1,j=!1,k=0}var c,d,e,f,g,h,i,j,k,l=this;b.extend(this,{resetClip:function(){var a=c;c=new m,m.resetClip(a,c)},hashExists:function(a){return null!=h[a]},storeHash:function(a){h[a]={}},removeHash:function(a){delete h[a]},storeClipPlaybackCounters:function(){for(var a in h)if(h.hasOwnProperty(a)&&h[a].clipNumber===c.getClipNumber()){b.extend(h[a],{segmentPlaybackCounter:c.getSegmentPlaybackCounter(),clipLoadCounter:c.getClipLoadCounter(),assetPlaybackCounter:c.getAssetPlaybackCounter(),lowestPartNumberPlayed:c.getLowestPartNumberPlayed(),seeking:c.isSeeking(),seekingTimeBeforeEnd:c.getSeekingTimeBeforeEnd(),seekingStartPosition:c.getSeekStartPosition(),clipPlaybackIntervals:c.getClipPlaybackIntervals(),uniquePlaybackInterval:c.getUniquePlaybackInterval(),longestPlaybackInterval:c.getLongestPlaybackInterval(),videoTrack:c.getVideoTrack(),audioTrack:c.getAudioTrack(),subtitleTrack:c.getSubtitleTrack(),cdn:c.getCDN()});break}},getStoredClipRegisters:function(a){return h[a]},getClipNumber:function(a){return h[a].clipNumber},getMaxClipNumber:function(){return i},storeClipNumber:function(a,b){h[a].clipNumber=b,b>i&&(i=b)},setLabels:function(a){null!=a&&b.extend(f,a)},getLabels:function(){return f},setLabel:function(a,b){var c={};c[a]=b,l.setLabels(c)},getLabel:function(a){return f[a]},getClip:function(){return c},createLabels:function(a){var d=a||{};return j||(d.ns_st_pb=null!=d.ns_st_pb?d.ns_st_pb:"1"),b.extend(d,l.getLabels()),c.isPlaybackStarted()&&(d.ns_st_ppc=String(k)),d},incrementPlayCounter:function(){l.setLabel("ns_st_sp",String(parseInt(l.getLabel("ns_st_sp"))+1))},incrementPauses:function(){l.setLabel("ns_st_pp",String(l.getPauses()+1))},addPlaybackTime:function(a){if(!isNaN(e)){var b=l.getPlaybackTime();b+=a-e,l.setPlaybackTime(b),e=NaN}},addBufferingTime:function(a){if(!isNaN(d)){var b=l.getBufferingTime();b+=a-d,l.setBufferingTime(b),d=NaN}},getBufferingTime:function(){return parseInt(l.getLabel("ns_st_bp"))},setBufferingTime:function(a){l.setLabel("ns_st_bp",String(a))},getPlaybackTime:function(){return parseInt(l.getLabel("ns_st_pa"))},setBufferingTimestamp:function(a){d=a},getBufferingTimestamp:function(){return d},setPlaybackTime:function(a){l.setLabel("ns_st_pa",String(a))},setPlaybackTimestamp:function(a){e=a},getPlaybackTimestamp:function(){return e},getPauses:function(){return parseInt(l.getLabel("ns_st_pp"))},setPauses:function(a){l.setLabel("ns_st_pp",String(a))},isPlaylistStarted:function(){return g},setPlaylistStarted:function(a){g=a},getPlaybackCounter:function(){return k},incrementPlaybackCounter:function(){k++},setFirstEventSent:function(a){j=a}}),a()}return a.resetPlaylist=function(b,c,d){for(var e=b.getClip(),f=b.getLabels(),g={},h=0;d&&h<d.length;h++)f.hasOwnProperty(d[h])&&(g[d[h]]=f[d[h]]);c=new a,c.setLabels(g),m.resetClip(e,c.getClip(),d)},a}(),o=function(){return function(a){function c(){e=1}function d(c){f=b.extend({},c);var d=a.getSSECore().getPixelURL();if(a.getAppCore()){if(a.getSSECore().isProperlyInitialized()){var e=a.getSSECore().getExports().am,g=a.getSSECore().getExports().et,h=e.newApplicationMeasurement(a.getAppCore(),g.HIDDEN,c,d);a.getAppCore().getQueue().offer(h)}}else d&&a.getSSECore().getPlatformAPI().httpGet(a.getSSECore().prepareUrl(d,c))}var e,f,g=this;b.extend(this,{newEvent:function(a){d(a.eventLabels),a.eventType!=i.HEARTBEAT&&g.incrementEventCounter()},getEventCounter:function(){return e},incrementEventCounter:function(){e++},setEventCounter:function(a){e=a},getMeasurementSnapshot:function(){return f}}),c()}}(),p=function(){return function(a){function c(){g=0,h=0}function d(){h++;var c={},d=b.fixEventTime(c);c.ns_st_po=String(a.getPlaylist().getClip().getPlaybackTimeOffset()+(d-a.getPlaylist().getClip().getPlaybackTimestamp())),c.ns_st_pa=String(a.getPlaylist().getPlaybackTime()+(d-a.getPlaylist().getPlaybackTimestamp())),c.ns_st_pt=String(a.getPlaylist().getClip().getPlaybackTime()+(d-a.getPlaylist().getClip().getPlaybackTimestamp())),c.ns_st_dpt=String(d-a.getPlaylist().getClip().getPlaybackTimestamp()),a.getStateMachine().getCurrentState()==j.BUFFERING_DURING_PLAYBACK?(c.ns_st_bp=String(a.getPlaylist().getBufferingTime()+(d-a.getPlaylist().getBufferingTimestamp())),c.ns_st_bt=String(a.getPlaylist().getClip().getBufferingTime()+(d-a.getPlaylist().getClip().getBufferingTimestamp())),c.ns_st_dbt=String(d-a.getPlaylist().getClip().getBufferingTimestamp())):c.ns_st_dbt=String(a.getPlaylist().getClip().getBufferingTime()-a.getPlaylist().getClip().getPreviousBufferingTime()),c.ns_st_et=String(a.getPlaylist().getClip().getElapsedTime()+(d-a.getPlaylist().getClip().getElapsedTimestamp())),c.ns_st_det=String(d-a.getPlaylist().getClip().getElapsedTimestamp());var e=b.cloneObject(a.getPlaylist().getClip().getClipPlaybackIntervals()),f=b.cloneObject(a.getPlaylist().getClip().getAssetPlaybackIntervals());e=b.addNewPlaybackInterval(e,a.getPlaylist().getClip().getPlaybackStartPosition(),parseInt(c.ns_st_po),a.getPlaylist().getClip().getPlaybackIntervalMergeTolerance()),f=b.addNewPlaybackInterval(f,a.getPlaylist().getClip().getPlaybackStartPosition(),parseInt(c.ns_st_po),a.getPlaylist().getClip().getPlaybackIntervalMergeTolerance());var l,m,n=0;for(l=0;l<e.length;l++)n+=Math.abs(e[l].end-e[l].start);c.ns_st_upc=String(n),c.ns_st_dupc=String(n-a.getPlaylist().getClip().getUniquePlaybackInterval());var o=0;for(l=0;l<e.length;l++)m=Math.abs(e[l].end-e[l].start),m>o&&(o=m);c.ns_st_lpc=String(o),c.ns_st_dlpc=String(o-a.getPlaylist().getClip().getLongestPlaybackInterval());var p=0;for(l=0;l<f.length;l++)p+=Math.abs(f[l].end-f[l].start);c.ns_st_upa=String(p),c.ns_st_dupa=String(p-a.getPlaylist().getClip().getAssetUniquePlaybackInterval());var q=0;for(l=0;l<f.length;l++)m=Math.abs(f[l].end-f[l].start),m>q&&(q=m);c.ns_st_lpa=String(q),c.ns_st_dlpa=String(q-a.getPlaylist().getClip().getAssetLongestPlaybackInterval()),c.ns_st_hc=String(a.getHeartbeat().getCount());var r=a.getSSECore().createLabels(i.HEARTBEAT,c,d);a.getEventManager().newEvent(r),g=0,k.resume()}function e(){null!=f&&(a.getSSECore().getPlatformAPI().clearTimeout(f),f=null)}var f,g,h,k=this,m=l.DEFAULT_HEARTBEAT_INTERVAL;b.extend(this,{getCount:function(){return h},setIntervals:function(a){m=a},getInterval:function(a){var b=0;if(null!=m)for(var c=0;c<m.length;c++){var d=m[c],e=d.playingtime;if(!e||e>a){b=d.interval;break}}return b},resume:function(){e();var b=k.getInterval(a.getPlaylist().getClip().getPlaybackTime()+(+new Date-a.getPlaylist().getClip().getPlaybackTimestamp()));if(b>0){var c=g>0?g:b;f=a.getSSECore().getPlatformAPI().setTimeout(d,c)}g=0},pause:function(){e();var b=k.getInterval(a.getPlaylist().getClip().getPlaybackTime()+(+new Date-a.getPlaylist().getClip().getPlaybackTimestamp()));g=b-(a.getPlaylist().getClip().getPlaybackTime()+(+new Date-a.getPlaylist().getClip().getPlaybackTimestamp()))%b}}),c()}}(),q=function(){return function(a){function c(){}function d(){var c={},d=b.fixEventTime(c);c.ns_st_po=String(a.getPlaylist().getClip().getExpectedPlaybackPosition(d)),a.getPlaylist().addPlaybackTime(d),a.getPlaylist().setPlaybackTimestamp(d),a.getPlaylist().getClip().addPlaybackTime(d),a.getPlaylist().getClip().setPlaybackTimestamp(d),a.getStateMachine().getCurrentState()==j.BUFFERING_DURING_PLAYBACK&&(a.getPlaylist().addBufferingTime(d),a.getPlaylist().setBufferingTimestamp(d),a.getPlaylist().getClip().addBufferingTime(d),a.getPlaylist().getClip().setBufferingTimestamp(d)),a.getPlaylist().getClip().addElapsedTime(d),a.getPlaylist().getClip().setElapsedTimestamp(d),a.getPlaylist().getClip().addInterval(parseInt(c.ns_st_po)),a.getPlaylist().getClip().setPlaybackStartPosition(parseInt(c.ns_st_po));\nvar e=a.getSSECore().createLabels(i.KEEPALIVE,c,d);a.getEventManager().newEvent(e),g.resume()}function e(){null!=f&&(a.getSSECore().getPlatformAPI().clearTimeout(f),f=null)}var f,g=this,h=l.DEFAULT_KEEP_ALIVE_INTERVAL;b.extend(g,{resume:function(){e(),f=a.getSSECore().getPlatformAPI().setTimeout(d,h)},pause:function(){e()},setInterval:function(a){h=a},getInterval:function(){return h}}),c()}}(),r=function(){return function(a){function c(){f=j.IDLE,e=null,d=NaN}var d,e,f,g=this;b.extend(g,{eventTypeToState:function(a){if(f==j.IDLE){if(a==i.PLAY)return j.PLAYING;if(a==i.SEEK_START)return j.SEEKING_BEFORE_PLAYBACK;if(a==i.BUFFER)return j.BUFFERING_BEFORE_PLAYBACK}else if(f==j.PLAYBACK_NOT_STARTED){if(a==i.PLAY)return j.PLAYING;if(a==i.SEEK_START)return j.SEEKING_BEFORE_PLAYBACK;if(a==i.BUFFER)return j.BUFFERING_BEFORE_PLAYBACK;if(a==i.END||a==i.AD_SKIP)return j.IDLE}else if(f==j.PLAYING){if(a==i.END||a==i.AD_SKIP)return j.IDLE;if(a==i.BUFFER)return j.BUFFERING_DURING_PLAYBACK;if(a==i.PAUSE)return j.PAUSED;if(a==i.SEEK_START)return j.SEEKING_DURING_PLAYBACK}else if(f==j.PAUSED){if(a==i.END||a==i.AD_SKIP)return j.IDLE;if(a==i.BUFFER)return j.BUFFERING_DURING_PAUSE;if(a==i.PLAY)return j.PLAYING;if(a==i.SEEK_START)return j.SEEKING_DURING_PAUSE}else if(f==j.BUFFERING_BEFORE_PLAYBACK){if(a==i.END||a==i.AD_SKIP)return j.IDLE;if(a==i.PAUSE||a==i.BUFFER_STOP)return j.PLAYBACK_NOT_STARTED;if(a==i.PLAY)return j.PLAYING;if(a==i.SEEK_START)return j.SEEKING_BEFORE_PLAYBACK}else if(f==j.BUFFERING_DURING_PLAYBACK){if(a==i.END||a==i.AD_SKIP)return j.IDLE;if(a==i.PLAY||a==i.BUFFER_STOP)return j.PLAYING;if(a==i.PAUSE_ON_BUFFERING)return j.PAUSED_DURING_BUFFERING;if(a==i.SEEK_START)return j.SEEKING_DURING_BUFFERING;if(a==i.PAUSE)return j.PAUSED}else if(f==j.BUFFERING_DURING_SEEKING){if(a==i.END||a==i.AD_SKIP)return j.IDLE;if(a==i.PLAY)return j.PLAYING;if(a==i.BUFFER_STOP)return j.SEEKING_DURING_PLAYBACK;if(a==i.PAUSE)return j.PAUSED}else if(f==j.BUFFERING_DURING_PAUSE){if(a==i.END||a==i.AD_SKIP)return j.IDLE;if(a==i.PLAY)return j.PLAYING;if(a==i.SEEK_START)return j.SEEKING_DURING_PAUSE;if(a==i.BUFFER_STOP||a==i.PAUSE)return j.PAUSED}else if(f==j.SEEKING_BEFORE_PLAYBACK){if(a==i.END||a==i.AD_SKIP)return j.IDLE;if(a==i.PAUSE)return j.PLAYBACK_NOT_STARTED;if(a==i.PLAY)return j.PLAYING;if(a==i.BUFFER)return j.BUFFERING_BEFORE_PLAYBACK}else if(f==j.SEEKING_DURING_PLAYBACK){if(a==i.END||a==i.AD_SKIP)return j.IDLE;if(a==i.PLAY)return j.PLAYING;if(a==i.PAUSE)return j.PAUSED;if(a==i.BUFFER)return j.BUFFERING_DURING_SEEKING}else if(f==j.SEEKING_DURING_BUFFERING){if(a==i.END||a==i.AD_SKIP)return j.IDLE;if(a==i.PLAY)return j.PLAYING;if(a==i.PAUSE||a==i.BUFFER_STOP)return j.PAUSED}else if(f==j.SEEKING_DURING_PAUSE){if(a==i.END||a==i.AD_SKIP)return j.IDLE;if(a==i.PLAY)return j.PLAYING;if(a==i.PAUSE||a==i.BUFFER_STOP)return j.PAUSED;if(a==i.BUFFER)return j.BUFFERING_DURING_PAUSE}else if(f==j.PAUSED_DURING_BUFFERING){if(a==i.END||a==i.AD_SKIP)return j.IDLE;if(a==i.SEEK_START)return j.SEEKING_DURING_BUFFERING;if(a==i.PAUSE)return j.PAUSED;if(a==i.PLAY||a==i.BUFFER_STOP)return j.PLAYING}return null},getCurrentState:function(){return f},newEvent:function(a,b){var c=g.eventTypeToState(a);f!=c&&(e=f,f=c,d=b)},getPreviousState:function(){return e},getLastStateChangeTimestamp:function(){return d}}),c()}}(),s=function(){return function(a){var c=this;b.extend(c,{onSeekStartWhenPausedOrBufferingDuringPause:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().getClip().isSeeking()?a.getPlaylist().getClip().isCollectingSeekingTime()||(a.getPlaylist().getClip().setSeekingTimestamp(b),a.getPlaylist().getClip().setCollectingSeekingTime(!0)):a.getPlaylist().getClip().incrementSeeks(),a.getPlaylist().getClip().isSeeking()||(a.getPlaylist().getClip().setSeeking(!0),a.getPlaylist().getClip().setCollectingSeekingTime(!0),a.getPlaylist().getClip().setSeekStartPosition(d),a.getPlaylist().getClip().setSeekingTimestamp(b))},onBufferWhenSeekingOrPlayBackNotStartedOrPaused:function(b,c){a.getPlaylist().setBufferingTimestamp(b),a.getPlaylist().getClip().setBufferingTimestamp(b)},onPlayWhenSeekingDuringBufferingOrSeekingDuringPause:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().getClip().isSeeking()&&(a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().addSeekingTime(b),a.getPlaylist().getClip().setCollectingSeekingTime(!1)),a.getPlaylist().getClip().addSeekingAmount(d),a.getPlaylist().getClip().setSeeking(!1)),a.getPlaylist().getClip().incrementPlayCounter(),a.getPlaylist().setPlaybackTimestamp(b),a.getPlaylist().getClip().setPlaybackTimestamp(b),a.getPlaylist().getClip().addElapsedTime(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().setPlaybackStartPosition(d),a.getHeartbeat().resume(),a.getKeepAlive().resume();var e=a.getSSECore().createLabels(i.PLAY,c,b);a.getEventManager().newEvent(e)},onBufferStopWhenBufferingDuringSeekingOrBufferingDuringPause:function(b,c){a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b)},onPauseWhenSeekingDuringPlaybackOrSeekingDuringPause:function(b,c){a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().addSeekingTime(b),a.getPlaylist().getClip().setCollectingSeekingTime(!1))},onEndOrAdSkipWhenSeekingDuringBufferingOrSeekingDuringPause:function(c,d){a.getSSECore().resetHeartbeat(),a.getSSECore().resetKeepAlive(),a.getPlaylist().getClip().addElapsedTime(c);var e=a.getSSECore().createLabels(i.END,d,c);a.getEventManager().newEvent(e),a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().setSeekingTimeBeforeEnd(c-a.getPlaylist().getClip().getSeekingTimestamp()),a.getPlaylist().getClip().setCollectingSeekingTime(!1)),a.getPlaylist().storeClipPlaybackCounters(),a.getPlaylist().getClip().resetClipLifecycleLabels(),a.getPlaylist().getClip().setPlaybackStarted(!1),d.hasOwnProperty("ns_st_pe")&&b.parseBoolean(d.ns_st_pe,!1)&&a.getSSECore().resetPlaylist()},onBufferStopWhenSeekingDuringBufferingOrSeekingDuringPause:function(b,c){a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().addSeekingTime(b),a.getPlaylist().getClip().setCollectingSeekingTime(!1))}})}}(),t=function(){return function(a){var c=this;b.extend(c,{onEndOrAdSkip:function(c,d){a.getPlaylist().addBufferingTime(c),a.getPlaylist().getClip().addBufferingTime(c),a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&a.getPlaylist().getClip().setSeekingTimeBeforeEnd(c-a.getPlaylist().getClip().getSeekingTimestamp()),a.getPlaylist().getClip().resetClipLifecycleLabels(),a.getPlaylist().getClip().setPlaybackStarted(!1),d.hasOwnProperty("ns_st_pe")&&b.parseBoolean(d.ns_st_pe,!1)&&a.getSSECore().resetPlaylist()},onBufferStop:function(b,c){a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b),a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().addSeekingTime(b),a.getPlaylist().getClip().setCollectingSeekingTime(!1))},onSeekStart:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b),a.getPlaylist().getClip().isSeeking()?a.getPlaylist().getClip().isCollectingSeekingTime()||(a.getPlaylist().getClip().setSeekingTimestamp(b),a.getPlaylist().getClip().setCollectingSeekingTime(!0)):a.getPlaylist().getClip().incrementSeeks(),a.getPlaylist().getClip().isSeeking()||(a.getPlaylist().getClip().setSeeking(!0),a.getPlaylist().getClip().setCollectingSeekingTime(!0),a.getPlaylist().getClip().setSeekStartPosition(d),a.getPlaylist().getClip().setSeekingTimestamp(b))},onPause:function(b,c){a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b),a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().addSeekingTime(b),a.getPlaylist().getClip().setCollectingSeekingTime(!1))},onPlay:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b),a.getPlaylist().getClip().isSeeking()&&(a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().addSeekingTime(b),a.getPlaylist().getClip().setCollectingSeekingTime(!1)),a.getPlaylist().getClip().addSeekingAmount(d),a.getPlaylist().getClip().setSeeking(!1)),a.getPlaylist().isPlaylistStarted()||(a.getPlaylist().setPlaylistStarted(!0),a.getPlaylist().incrementPlaybackCounter()),a.getPlaylist().getClip().setClipStarted(!0),a.getPlaylist().getClip().setPlaybackStarted(!0),a.getPlaylist().getClip().incrementSegmentPlaybackCounter(),(0==a.getPlaylist().getClip().getLowestPartNumberPlayed()||parseInt(a.getPlaylist().getClip().getLabels().ns_st_pn)<=a.getPlaylist().getClip().getLowestPartNumberPlayed())&&(a.getPlaylist().getClip().setLowestPartNumberPlayed(parseInt(a.getPlaylist().getClip().getLabels().ns_st_pn)),a.getPlaylist().getClip().incrementAssetPlaybackCounter(),a.getPlaylist().getClip().resetAssetPlaybackCounters()),a.getPlaylist().getClip().incrementPlayCounter(),a.getPlaylist().setPlaybackTimestamp(b),a.getPlaylist().getClip().setPlaybackTimestamp(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().setPlaybackStartPosition(d),a.getSSECore().isLoadingTimeSent()||(c.ns_st_lt=String(a.getSSECore().getLoadTimeOffset()+b-a.getSSECore().getInitTimestamp()),a.getSSECore().setLoadingTimeSent(!0)),a.getHeartbeat().resume(),a.getKeepAlive().resume();var e=a.getSSECore().createLabels(i.PLAY,c,b);a.getEventManager().newEvent(e)}})}}(),u=function(){return function(a){var c=this;b.extend(c,{onEndAndSkip:function(c,d){a.getSSECore().resetHeartbeat(),a.getSSECore().resetKeepAlive(),a.getPlaylist().addBufferingTime(c),a.getPlaylist().getClip().addBufferingTime(c),a.getPlaylist().getClip().addElapsedTime(c);var e=a.getSSECore().createLabels(i.END,d,c);a.getEventManager().newEvent(e),a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().setSeekingTimeBeforeEnd(c-a.getPlaylist().getClip().getSeekingTimestamp()),a.getPlaylist().getClip().setCollectingSeekingTime(!1)),a.getPlaylist().storeClipPlaybackCounters(),a.getPlaylist().getClip().resetClipLifecycleLabels(),a.getPlaylist().getClip().setPlaybackStarted(!1),d.hasOwnProperty("ns_st_pe")&&b.parseBoolean(d.ns_st_pe,!1)&&a.getSSECore().resetPlaylist()},onPause:function(b,c){a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b)},onPlay:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b),a.getPlaylist().getClip().isSeeking()&&(a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().addSeekingTime(b),a.getPlaylist().getClip().setCollectingSeekingTime(!1)),a.getPlaylist().getClip().addSeekingAmount(d),a.getPlaylist().getClip().setSeeking(!1)),a.getPlaylist().getClip().incrementPlayCounter(),a.getPlaylist().setPlaybackTimestamp(b),a.getPlaylist().getClip().setPlaybackTimestamp(b),a.getPlaylist().getClip().addElapsedTime(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().setPlaybackStartPosition(d),a.getHeartbeat().resume(),a.getKeepAlive().resume();var e=a.getSSECore().createLabels(i.PLAY,c,b);a.getEventManager().newEvent(e)}})}}(),v=function(){return function(a){var c=this;b.extend(c,{onPauseOnBuffering:function(b,c){var d=parseInt(c.ns_st_po);a.getSSECore().stopPausedOnBufferingTimer(),a.getHeartbeat().pause(),a.getSSECore().resetKeepAlive(),a.getPlaylist().addPlaybackTime(b),a.getPlaylist().getClip().addPlaybackTime(b),a.getPlaylist().getClip().addElapsedTime(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().addInterval(d),a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b),a.getPlaylist().incrementPauses(),a.getPlaylist().getClip().incrementPauses();var e=a.getSSECore().createLabels(i.PAUSE,c,b);a.getEventManager().newEvent(e),a.getPlaylist().setBufferingTimestamp(b),a.getPlaylist().getClip().setBufferingTimestamp(b),a.getPlaylist().getClip().setPlaybackTimeOffset(d)},onBufferStop:function(b,c){a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b)},onEndOrAdSkip:function(c,d){var e=parseInt(d.ns_st_po);a.getSSECore().resetHeartbeat(),a.getSSECore().resetKeepAlive(),a.getSSECore().stopPausedOnBufferingTimer(),a.getPlaylist().addBufferingTime(c),a.getPlaylist().getClip().addBufferingTime(c),a.getPlaylist().getClip().addPlaybackTime(c),a.getPlaylist().getClip().addElapsedTime(c),a.getPlaylist().getClip().addInterval(e);var f=a.getSSECore().createLabels(i.END,d,c);a.getEventManager().newEvent(f),a.getPlaylist().getClip().resetClipLifecycleLabels(),a.getPlaylist().getClip().setPlaybackStarted(!1),d.hasOwnProperty("ns_st_pe")&&b.parseBoolean(d.ns_st_pe,!1)&&a.getSSECore().resetPlaylist()},onSeekStart:function(b,c){var d=parseInt(c.ns_st_po);a.getSSECore().stopPausedOnBufferingTimer(),a.getPlaylist().addPlaybackTime(b),a.getPlaylist().getClip().addPlaybackTime(b),a.getPlaylist().getClip().addElapsedTime(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().addInterval(d),a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b),a.getPlaylist().getClip().incrementSeeks(),a.getPlaylist().getClip().setSeeking(!0),a.getPlaylist().getClip().setCollectingSeekingTime(!0),a.getPlaylist().getClip().setSeekStartPosition(d),a.getPlaylist().getClip().setSeekingTimestamp(b),a.getPlaylist().incrementPauses(),a.getPlaylist().getClip().incrementPauses();var e=a.getSSECore().createLabels(i.PAUSE,c,b);a.getEventManager().newEvent(e)},onPause:function(b,c){var d=parseInt(c.ns_st_po);a.getSSECore().stopPausedOnBufferingTimer(),a.getPlaylist().addPlaybackTime(b),a.getPlaylist().getClip().addPlaybackTime(b),a.getPlaylist().getClip().addElapsedTime(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().addInterval(d),a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b),a.getPlaylist().incrementPauses(),a.getPlaylist().getClip().incrementPauses();var e=a.getSSECore().createLabels(i.PAUSE,c,b);a.getEventManager().newEvent(e)},onPlay:function(b,c){a.getSSECore().stopPausedOnBufferingTimer(),a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b)}})}}(),w=function(){return function(a){var c=this;b.extend(c,{onEndOrAdSkip:function(c,d){a.getSSECore().resetHeartbeat(),a.getSSECore().resetKeepAlive(),a.getSSECore().stopPausedOnBufferingTimer(),a.getPlaylist().addBufferingTime(c),a.getPlaylist().getClip().addBufferingTime(c),a.getPlaylist().getClip().addElapsedTime(c);var e=a.getSSECore().createLabels(i.END,d,c);a.getEventManager().newEvent(e),a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().setSeekingTimeBeforeEnd(c-a.getPlaylist().getClip().getSeekingTimestamp()),a.getPlaylist().getClip().setCollectingSeekingTime(!1)),a.getPlaylist().storeClipPlaybackCounters(),a.getPlaylist().getClip().resetClipLifecycleLabels(),a.getPlaylist().getClip().setPlaybackStarted(!1),d.hasOwnProperty("ns_st_pe")&&b.parseBoolean(d.ns_st_pe,!1)&&a.getSSECore().resetPlaylist()},onPause:function(b,c){a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b),a.getPlaylist().incrementPauses(),a.getPlaylist().getClip().incrementPauses(),a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().addSeekingTime(b),a.getPlaylist().getClip().setCollectingSeekingTime(!1))},onPlay:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b),a.getPlaylist().getClip().isSeeking()&&(a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().addSeekingTime(b),a.getPlaylist().getClip().setCollectingSeekingTime(!1)),a.getPlaylist().getClip().addSeekingAmount(d),a.getPlaylist().getClip().setSeeking(!1)),a.getPlaylist().getClip().incrementPlayCounter(),a.getPlaylist().setPlaybackTimestamp(b),a.getPlaylist().getClip().setPlaybackTimestamp(b),a.getPlaylist().getClip().addElapsedTime(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().setPlaybackStartPosition(d),a.getHeartbeat().resume(),a.getKeepAlive().resume();var e=a.getSSECore().createLabels(i.PLAY,c,b);a.getEventManager().newEvent(e)}})}}(),x=function(){return function(a){var c=this;b.extend(c,{onBuffer:function(b,c){a.getPlaylist().getClip().setSeekingTime(a.getPlaylist().getClip().getSeekingTimeBeforeEnd()),a.getPlaylist().setBufferingTimestamp(b),a.getPlaylist().getClip().setBufferingTimestamp(b)},onSeekStart:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().getClip().setSeekingTime(a.getPlaylist().getClip().getSeekingTimeBeforeEnd()),a.getPlaylist().getClip().incrementSeeks(),a.getPlaylist().getClip().setSeeking(!0),a.getPlaylist().getClip().setCollectingSeekingTime(!0),a.getPlaylist().getClip().setSeekStartPosition(d),a.getPlaylist().getClip().setSeekingTimestamp(b)},onPlay:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().getClip().setSeekingTime(a.getPlaylist().getClip().getSeekingTimeBeforeEnd()),a.getPlaylist().getClip().isSeeking()&&(a.getPlaylist().getClip().addSeekingAmount(d),a.getPlaylist().getClip().setSeeking(!1)),a.getPlaylist().isPlaylistStarted()||(a.getPlaylist().setPlaylistStarted(!0),a.getPlaylist().incrementPlaybackCounter()),a.getPlaylist().getClip().setClipStarted(!0),a.getPlaylist().getClip().setPlaybackStarted(!0),a.getPlaylist().getClip().incrementSegmentPlaybackCounter(),(0==a.getPlaylist().getClip().getLowestPartNumberPlayed()||parseInt(a.getPlaylist().getClip().getLabel("ns_st_pn"))<=a.getPlaylist().getClip().getLowestPartNumberPlayed())&&(a.getPlaylist().getClip().setLowestPartNumberPlayed(parseInt(a.getPlaylist().getClip().getLabel("ns_st_pn"))),a.getPlaylist().getClip().incrementAssetPlaybackCounter(),a.getPlaylist().getClip().resetAssetPlaybackCounters()),a.getPlaylist().getClip().incrementPlayCounter(),a.getPlaylist().setPlaybackTimestamp(b),a.getPlaylist().getClip().setPlaybackTimestamp(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().setPlaybackStartPosition(d),a.getSSECore().isLoadingTimeSent()||(c.ns_st_lt=String(a.getSSECore().getLoadTimeOffset()+b-a.getSSECore().getInitTimestamp()),a.getSSECore().setLoadingTimeSent(!0)),a.getHeartbeat().resume(),a.getKeepAlive().resume();var e=a.getSSECore().createLabels(i.PLAY,c,b);a.getEventManager().newEvent(e)}})}}(),y=function(){return function(a){var c=this;b.extend(c,{onEndOrAdSkip:function(c,d){a.getSSECore().resetHeartbeat(),a.getSSECore().resetKeepAlive(),a.getPlaylist().getClip().addElapsedTime(c);var e=a.getSSECore().createLabels(i.END,d,c);a.getEventManager().newEvent(e),a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().setSeekingTimeBeforeEnd(c-a.getPlaylist().getClip().getSeekingTimestamp()),a.getPlaylist().getClip().setSeeking(!1)),a.getPlaylist().storeClipPlaybackCounters(),a.getPlaylist().getClip().resetClipLifecycleLabels(),a.getPlaylist().getClip().setPlaybackStarted(!1),d.hasOwnProperty("ns_st_pe")&&b.parseBoolean(d.ns_st_pe,!1)&&a.getSSECore().resetPlaylist()},onPlay:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().getClip().isSeeking()&&(a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().addSeekingTime(b),a.getPlaylist().getClip().setCollectingSeekingTime(!1)),a.getPlaylist().getClip().addSeekingAmount(d),a.getPlaylist().getClip().setSeeking(!1)),a.getPlaylist().getClip().incrementPlayCounter(),a.getPlaylist().setPlaybackTimestamp(b),a.getPlaylist().getClip().setPlaybackTimestamp(b),a.getPlaylist().getClip().addElapsedTime(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().setPlaybackStartPosition(d),a.getHeartbeat().resume(),a.getKeepAlive().resume();var e=a.getSSECore().createLabels(i.PLAY,c,b);a.getEventManager().newEvent(e)}})}}(),z=function(){return function(a){var c=this;b.extend(c,{onEndOrAdSkip:function(c,d){a.getSSECore().resetHeartbeat(),a.getSSECore().resetKeepAlive(),a.getPlaylist().addBufferingTime(c),a.getPlaylist().getClip().addBufferingTime(c),a.getPlaylist().getClip().addElapsedTime(c);var e=a.getSSECore().createLabels(i.END,d,c);a.getEventManager().newEvent(e),a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().setSeekingTimeBeforeEnd(c-a.getPlaylist().getClip().getSeekingTimestamp()),a.getPlaylist().getClip().setCollectingSeekingTime(!1)),a.getPlaylist().storeClipPlaybackCounters(),a.getPlaylist().getClip().resetClipLifecycleLabels(),a.getPlaylist().getClip().setPlaybackStarted(!1),d.hasOwnProperty("ns_st_pe")&&b.parseBoolean(d.ns_st_pe,!1)&&a.getSSECore().resetPlaylist()},onBufferStop:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b),a.getPlaylist().setPlaybackTimestamp(b),a.getPlaylist().getClip().setPlaybackTimestamp(b),a.getPlaylist().getClip().addElapsedTime(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().setPlaybackStartPosition(d),a.getHeartbeat().resume(),a.getKeepAlive().resume();var e=a.getSSECore().createLabels(i.PLAY,c,b);a.getEventManager().newEvent(e)},onSeekStart:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b),a.getPlaylist().getClip().isSeeking()?a.getPlaylist().getClip().isCollectingSeekingTime()||(a.getPlaylist().getClip().setSeekingTimestamp(b),a.getPlaylist().getClip().setCollectingSeekingTime(!0)):a.getPlaylist().getClip().incrementSeeks(),a.getPlaylist().getClip().isSeeking()||(a.getPlaylist().getClip().setSeeking(!0),a.getPlaylist().getClip().setCollectingSeekingTime(!0),a.getPlaylist().getClip().setSeekStartPosition(d),a.getPlaylist().getClip().setSeekingTimestamp(b))},onPause:function(b,c){a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b),a.getPlaylist().incrementPauses(),a.getPlaylist().getClip().incrementPauses()},onPlay:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().addBufferingTime(b),a.getPlaylist().getClip().addBufferingTime(b),a.getPlaylist().getClip().incrementPlayCounter(),a.getPlaylist().setPlaybackTimestamp(b),a.getPlaylist().getClip().setPlaybackTimestamp(b),a.getPlaylist().getClip().addElapsedTime(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().setPlaybackStartPosition(d),a.getHeartbeat().resume(),a.getKeepAlive().resume();var e=a.getSSECore().createLabels(i.PLAY,c,b);a.getEventManager().newEvent(e)}})}}(),A=function(){return function(a){var c=this;b.extend(c,{onEndOrAdSkip:function(c,d){a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().setSeekingTimeBeforeEnd(c-a.getPlaylist().getClip().getSeekingTimestamp()),a.getPlaylist().getClip().setCollectingSeekingTime(!1)),a.getPlaylist().storeClipPlaybackCounters(),a.getPlaylist().getClip().resetClipLifecycleLabels(),a.getPlaylist().getClip().setPlaybackStarted(!1),d.hasOwnProperty("ns_st_pe")&&b.parseBoolean(d.ns_st_pe,!1)&&a.getSSECore().resetPlaylist()},onSeekStart:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().getClip().isSeeking()?a.getPlaylist().getClip().setSeekingTimestamp(b):a.getPlaylist().getClip().incrementSeeks(),a.getPlaylist().getClip().isSeeking()||(a.getPlaylist().getClip().setSeeking(!0),a.getPlaylist().getClip().setCollectingSeekingTime(!0),a.getPlaylist().getClip().setSeekStartPosition(d),a.getPlaylist().getClip().setSeekingTimestamp(b))},onPlay:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().getClip().isSeeking()&&(a.getPlaylist().getClip().addSeekingAmount(d),a.getPlaylist().getClip().setSeeking(!1)),a.getPlaylist().isPlaylistStarted()||(a.getPlaylist().setPlaylistStarted(!0),a.getPlaylist().incrementPlaybackCounter()),a.getPlaylist().getClip().setClipStarted(!0),a.getPlaylist().getClip().setPlaybackStarted(!0),a.getPlaylist().getClip().incrementSegmentPlaybackCounter(),(0==a.getPlaylist().getClip().getLowestPartNumberPlayed()||parseInt(a.getPlaylist().getClip().getLabels().ns_st_pn)<=a.getPlaylist().getClip().getLowestPartNumberPlayed())&&(a.getPlaylist().getClip().setLowestPartNumberPlayed(parseInt(a.getPlaylist().getClip().getLabels().ns_st_pn)),a.getPlaylist().getClip().incrementAssetPlaybackCounter(),a.getPlaylist().getClip().resetAssetPlaybackCounters()),a.getPlaylist().getClip().incrementPlayCounter(),a.getPlaylist().setPlaybackTimestamp(b),a.getPlaylist().getClip().setPlaybackTimestamp(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().setPlaybackStartPosition(d),a.getSSECore().isLoadingTimeSent()||(c.ns_st_lt=String(a.getSSECore().getLoadTimeOffset()+b-a.getSSECore().getInitTimestamp()),a.getSSECore().setLoadingTimeSent(!0)),a.getHeartbeat().resume(),a.getKeepAlive().resume();var e=a.getSSECore().createLabels(i.PLAY,c,b);a.getEventManager().newEvent(e)}})}}(),B=function(){return function(a){var c=this;b.extend(c,{onEndOrAdSkip:function(c,d){var e=parseInt(d.ns_st_po);a.getSSECore().resetHeartbeat(),a.getSSECore().resetKeepAlive(),a.getPlaylist().addPlaybackTime(c),a.getPlaylist().getClip().addPlaybackTime(c),a.getPlaylist().getClip().addElapsedTime(c),a.getPlaylist().getClip().addInterval(e);var f=a.getSSECore().createLabels(i.END,d,c);a.getEventManager().newEvent(f),a.getPlaylist().getClip().resetClipLifecycleLabels(),a.getPlaylist().getClip().setPlaybackStarted(!1),d.hasOwnProperty("ns_st_pe")&&b.parseBoolean(d.ns_st_pe,!1)&&a.getSSECore().resetPlaylist()},onBuffer:function(b,c){a.getSSECore().isPauseOnBufferingEnabled()&&a.getSSECore().startPausedOnBufferingTimer(b,c),a.getPlaylist().getClip().incrementBufferCount(),a.getPlaylist().setBufferingTimestamp(b),a.getPlaylist().getClip().setBufferingTimestamp(b)},onSeekStart:function(b,c){var d=parseInt(c.ns_st_po);a.getHeartbeat().pause(),a.getSSECore().resetKeepAlive(),a.getPlaylist().addPlaybackTime(b),a.getPlaylist().getClip().addPlaybackTime(b),a.getPlaylist().getClip().addElapsedTime(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().addInterval(d),a.getPlaylist().getClip().incrementSeeks(),a.getPlaylist().getClip().setSeeking(!0),a.getPlaylist().getClip().setCollectingSeekingTime(!0),a.getPlaylist().getClip().setSeekStartPosition(d),a.getPlaylist().getClip().setSeekingTimestamp(b),a.getPlaylist().incrementPauses(),a.getPlaylist().getClip().incrementPauses();var e=a.getSSECore().createLabels(i.PAUSE,c,b);a.getEventManager().newEvent(e)},onPause:function(b,c){var d=parseInt(c.ns_st_po);a.getHeartbeat().pause(),a.getSSECore().resetKeepAlive(),a.getPlaylist().addPlaybackTime(b),a.getPlaylist().getClip().addPlaybackTime(b),a.getPlaylist().getClip().addElapsedTime(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().addInterval(d),a.getPlaylist().incrementPauses(),a.getPlaylist().getClip().incrementPauses();var e=a.getSSECore().createLabels(i.PAUSE,c,b);a.getEventManager().newEvent(e)}})}}(),C=function(){return function(a){var c=this;b.extend(c,{onEndOrAdSkip:function(c,d){a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().setSeekingTimeBeforeEnd(c-a.getPlaylist().getClip().getSeekingTimestamp()),a.getPlaylist().getClip().setCollectingSeekingTime(!1)),a.getPlaylist().storeClipPlaybackCounters(),a.getPlaylist().getClip().resetClipLifecycleLabels(),a.getPlaylist().getClip().setPlaybackStarted(!1),d.hasOwnProperty("ns_st_pe")&&b.parseBoolean(d.ns_st_pe,!1)&&a.getSSECore().resetPlaylist()},onPause:function(b,c){a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().addSeekingTime(b),a.getPlaylist().getClip().setCollectingSeekingTime(!1))},onPlay:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().getClip().isSeeking()&&(a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().addSeekingTime(b),a.getPlaylist().getClip().setCollectingSeekingTime(!1)),a.getPlaylist().getClip().addSeekingAmount(d),a.getPlaylist().getClip().setSeeking(!1)),a.getPlaylist().isPlaylistStarted()||(a.getPlaylist().setPlaylistStarted(!0),a.getPlaylist().incrementPlaybackCounter()),a.getPlaylist().getClip().setClipStarted(!0),a.getPlaylist().getClip().setPlaybackStarted(!0),a.getPlaylist().getClip().incrementSegmentPlaybackCounter(),(0==a.getPlaylist().getClip().getLowestPartNumberPlayed()||parseInt(a.getPlaylist().getClip().getLabels().ns_st_pn)<=a.getPlaylist().getClip().getLowestPartNumberPlayed())&&(a.getPlaylist().getClip().setLowestPartNumberPlayed(parseInt(a.getPlaylist().getClip().getLabels().ns_st_pn)),a.getPlaylist().getClip().incrementAssetPlaybackCounter(),a.getPlaylist().getClip().resetAssetPlaybackCounters()),a.getPlaylist().getClip().incrementPlayCounter(),a.getPlaylist().setPlaybackTimestamp(b),a.getPlaylist().getClip().setPlaybackTimestamp(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().setPlaybackStartPosition(d),a.getSSECore().isLoadingTimeSent()||(c.ns_st_lt=String(a.getSSECore().getLoadTimeOffset()+b-a.getSSECore().getInitTimestamp()),a.getSSECore().setLoadingTimeSent(!0)),a.getHeartbeat().resume(),a.getKeepAlive().resume();var e=a.getSSECore().createLabels(i.PLAY,c,b);a.getEventManager().newEvent(e)}})}}(),D=function(){return function(a){var c=this;b.extend(c,{onPause:function(b,c){a.getPlaylist().incrementPauses(),a.getPlaylist().getClip().incrementPauses(),a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().addSeekingTime(b),a.getPlaylist().getClip().setCollectingSeekingTime(!1))}})}}(),E=function(){return function(a){var c=this;b.extend(c,{onEndOrAdSkip:function(c,d){parseInt(d.ns_st_po);a.getSSECore().resetHeartbeat(),a.getSSECore().resetKeepAlive(),a.getPlaylist().getClip().addElapsedTime(c);var e=a.getSSECore().createLabels(i.END,d,c);a.getEventManager().newEvent(e),a.getPlaylist().getClip().isSeeking()&&a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().setSeekingTimeBeforeEnd(c-a.getPlaylist().getClip().getSeekingTimestamp()),a.getPlaylist().getClip().setCollectingSeekingTime(!1)),a.getPlaylist().storeClipPlaybackCounters(),a.getPlaylist().getClip().resetClipLifecycleLabels(),a.getPlaylist().getClip().setPlaybackStarted(!1),d.hasOwnProperty("ns_st_pe")&&b.parseBoolean(d.ns_st_pe,!1)&&a.getSSECore().resetPlaylist()},onPlay:function(b,c){var d=parseInt(c.ns_st_po);a.getPlaylist().getClip().isSeeking()&&(a.getPlaylist().getClip().isCollectingSeekingTime()&&(a.getPlaylist().getClip().addSeekingTime(b),a.getPlaylist().getClip().setCollectingSeekingTime(!1)),a.getPlaylist().getClip().addSeekingAmount(d),a.getPlaylist().getClip().setSeeking(!1)),a.getPlaylist().getClip().incrementPlayCounter(),a.getPlaylist().setPlaybackTimestamp(b),a.getPlaylist().getClip().setPlaybackTimestamp(b),a.getPlaylist().getClip().addElapsedTime(b),a.getPlaylist().getClip().setElapsedTimestamp(b),a.getPlaylist().getClip().setPlaybackStartPosition(d),a.getSSECore().isLoadingTimeSent()||(c.ns_st_lt=String(a.getSSECore().getLoadTimeOffset()+b-a.getSSECore().getInitTimestamp()),a.getSSECore().setLoadingTimeSent(!0)),a.getHeartbeat().resume(),a.getKeepAlive().resume();var e=a.getSSECore().createLabels(i.PLAY,c,b);a.getEventManager().newEvent(e)}})}}(),F=function(){return function(){function a(){f=new G(aa),b.getNamespace().comScore?(ba=b.getNamespace().comScore.exports,f.setAppCore(ba.c())):f.setAppCore(null),f.setKeepAlive(new q(f)),\nf.setHeartbeat(new p(f)),f.setEventManager(new o(f)),f.setStateMachine(new r),f.setPlaylist(new n),$={},m=new x(f),F=new y(f),H=new A(f),I=new B(f),J=new t(f),K=new v(f),L=new w(f),M=new u(f),N=new z(f),O=new C(f),P=new D(f),Q=new E(f),R=new s(f),S=!1,T=0,U=+new Date,V=!0,X=!1,Z=[]}function c(a){var b=f.getStateMachine().getCurrentState();if(b==j.IDLE||b==j.PLAYBACK_NOT_STARTED||b==j.BUFFERING_BEFORE_PLAYBACK||b==j.SEEKING_BEFORE_PLAYBACK){if(a==i.PLAY)return!0}else if(b==j.PLAYING){if(a==i.END||a==i.AD_SKIP||a==i.SEEK_START||a==i.PAUSE)return!0}else if(b==j.PAUSED||b==j.BUFFERING_DURING_PAUSE||b==j.SEEKING_DURING_PLAYBACK||b==j.SEEKING_DURING_BUFFERING||b==j.SEEKING_DURING_PAUSE){if(a==i.END||a==i.AD_SKIP||a==i.PLAY)return!0}else if(b==j.BUFFERING_DURING_PLAYBACK){if(a==i.PAUSE_ON_BUFFERING||a==i.END||a==i.AD_SKIP||a==i.SEEK_START||a==i.PAUSE||a==i.PLAY)return!0}else if(b==j.BUFFERING_DURING_SEEKING){if(a==i.END||a==i.AD_SKIP||a==i.PAUSE||a==i.PLAY)return!0}else if(b==j.PAUSED_DURING_BUFFERING&&(a==i.END||a==i.AD_SKIP||a==i.BUFFER_STOP||a==i.PLAY))return!0;return!1}function d(a,b,d){var e=f.getStateMachine().getCurrentState();a==i.AD_SKIP&&!d.hasOwnProperty("ns_st_ui")&&c(a)?d.ns_st_ui="skip":a==i.SEEK_START&&!d.hasOwnProperty("ns_st_ui")&&c(a)&&(d.ns_st_ui="seek"),e==j.IDLE?a==i.BUFFER?m.onBuffer(b,d):a==i.SEEK_START?m.onSeekStart(b,d):a==i.PLAY&&m.onPlay(b,d):e==j.PLAYBACK_NOT_STARTED?a==i.END||a==i.AD_SKIP?H.onEndOrAdSkip(b,d):a==i.SEEK_START?H.onSeekStart(b,d):a==i.PLAY?H.onPlay(b,d):a==i.BUFFER&&R.onBufferWhenSeekingOrPlayBackNotStartedOrPaused(b,d):e==j.PLAYING?a==i.END||a==i.AD_SKIP?I.onEndOrAdSkip(b,d):a==i.BUFFER?I.onBuffer(b,d):a==i.SEEK_START?I.onSeekStart(b,d):a==i.PAUSE&&I.onPause(b,d):e==j.PAUSED?a==i.END||a==i.AD_SKIP?F.onEndOrAdSkip(b,d):a==i.PLAY?F.onPlay(b,d):a==i.BUFFER?R.onBufferWhenSeekingOrPlayBackNotStartedOrPaused(b,d):a==i.SEEK_START&&R.onSeekStartWhenPausedOrBufferingDuringPause(b,d):e==j.BUFFERING_BEFORE_PLAYBACK?a==i.END||a==i.AD_SKIP?J.onEndOrAdSkip(b,d):a==i.BUFFER_STOP?J.onBufferStop(b,d):a==i.SEEK_START?J.onSeekStart(b,d):a==i.PAUSE?J.onPause(b,d):a==i.PLAY&&J.onPlay(b,d):e==j.BUFFERING_DURING_PLAYBACK?a==i.PAUSE_ON_BUFFERING?K.onPauseOnBuffering(b,d):a==i.BUFFER_STOP?K.onBufferStop(b,d):a==i.END||a==i.AD_SKIP?K.onEndOrAdSkip(b,d):a==i.SEEK_START?K.onSeekStart(b,d):a==i.PAUSE?K.onPause(b,d):a==i.PLAY&&K.onPlay(b,d):e==j.BUFFERING_DURING_SEEKING?a==i.END||a==i.AD_SKIP?L.onEndOrAdSkip(b,d):a==i.PAUSE?L.onPause(b,d):a==i.PLAY?L.onPlay(b,d):a==i.BUFFER_STOP&&R.onBufferStopWhenBufferingDuringSeekingOrBufferingDuringPause(b,d):e==j.BUFFERING_DURING_PAUSE?a==i.END||a==i.AD_SKIP?M.onEndAndSkip(b,d):a==i.PAUSE?M.onPause(b,d):a==i.PLAY?M.onPlay(b,d):a==i.SEEK_START?R.onSeekStartWhenPausedOrBufferingDuringPause(b,d):a==i.BUFFER_STOP&&R.onBufferStopWhenBufferingDuringSeekingOrBufferingDuringPause(b,d):e==j.SEEKING_BEFORE_PLAYBACK?a==i.END||a==i.AD_SKIP?O.onEndOrAdSkip(b,d):a==i.PAUSE?O.onPause(b,d):a==i.PLAY?O.onPlay(b,d):a==i.BUFFER&&R.onBufferWhenSeekingOrPlayBackNotStartedOrPaused(b,d):e==j.SEEKING_DURING_PLAYBACK?a==i.END||a==i.AD_SKIP?Q.onEndOrAdSkip(b,d):a==i.PLAY?Q.onPlay(b,d):a==i.BUFFER?R.onBufferWhenSeekingOrPlayBackNotStartedOrPaused(b,d):a==i.PAUSE&&R.onPauseWhenSeekingDuringPlaybackOrSeekingDuringPause(b,d):e==j.SEEKING_DURING_BUFFERING?a==i.PAUSE?P.onPause(b,d):a==i.BUFFER?R.onBufferWhenSeekingOrPlayBackNotStartedOrPaused(b,d):a==i.PLAY?R.onPlayWhenSeekingDuringBufferingOrSeekingDuringPause(b,d):a==i.END||a==i.AD_SKIP?R.onEndOrAdSkipWhenSeekingDuringBufferingOrSeekingDuringPause(b,d):a==i.BUFFER_STOP&&R.onBufferStopWhenSeekingDuringBufferingOrSeekingDuringPause(b,d):e==j.PAUSED_DURING_BUFFERING?a==i.END||a==i.AD_SKIP?N.onEndOrAdSkip(b,d):a==i.BUFFER_STOP?N.onBufferStop(b,d):a==i.SEEK_START?N.onSeekStart(b,d):a==i.PAUSE?N.onPause(b,d):a==i.PLAY&&N.onPlay(b,d):e==j.SEEKING_DURING_PAUSE&&(a==i.BUFFER?R.onBufferWhenSeekingOrPlayBackNotStartedOrPaused(b,d):a==i.PLAY?R.onPlayWhenSeekingDuringBufferingOrSeekingDuringPause(b,d):a==i.PAUSE?R.onPauseWhenSeekingDuringPlaybackOrSeekingDuringPause(b,d):a==i.END||a==i.AD_SKIP?R.onEndOrAdSkipWhenSeekingDuringBufferingOrSeekingDuringPause(b,d):a==i.BUFFER_STOP&&R.onBufferStopWhenSeekingDuringBufferingOrSeekingDuringPause(b,d)),c(a)&&f.getPlaylist().setFirstEventSent(!0)}function e(a,c){for(var d,e=ea.encodeURIComponent||escape,f=[],g=l.LABELS_ORDER,h=a.split("?"),i=h[0],j=h[1],k=j.split("&"),m=0,n=k.length;n>m;m++){var o=k[m].split("="),p=unescape(o[0]),q=unescape(o[1]);p&&(c[p]=q)}for(var r={},s=0,t=g.length;t>s;s++){var u=g[s];if(c.hasOwnProperty(u)){var v=c[u];"undefined"!=typeof v&&null!=v&&(r[u]=!0,f.push(e(u)+"="+e(c[u])))}}for(var w in c)if(c.hasOwnProperty(w)){if(r[w])continue;var x=c[w];"undefined"!=typeof x&&null!=x&&f.push(e(w)+"="+e(c[w]))}d=i+"?"+f.join("&"),d=d+(d.indexOf("&c8=")<0?"&c8="+e(fa.title):"")+(d.indexOf("&c7=")<0?"&c7="+e(fa.URL):"")+(d.indexOf("&c9=")<0?"&c9="+e(fa.referrer):"");var y=b.browserAcceptsLargeURLs()?l.URL_LENGTH_LIMIT:l.RESTRICTED_URL_LENGTH_LIMIT;if(d.length>y&&d.indexOf("&")>0){var z=d.substr(0,y-8).lastIndexOf("&");d=(d.substring(0,z)+"&ns_cut="+e(d.substring(z+1))).substr(0,y)}return d}var f,m,F,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa=this,ba={},ca=l.DEFAULT_PAUSED_ON_BUFFERING_INTERVAL,da=l.THROTTLING_DELAY;b.extend(aa,{createLabels:function(a,c,d){var e={};if("undefined"!=typeof document){var g=document;e.c7=g.URL,e.c8=g.title,e.c9=g.referrer}return null!=c&&b.extend(e,c),e.ns_ts=null!=e.ns_ts?e.ns_ts:String(+new Date),e.ns_st_ev=null!=e.ns_st_ev?e.ns_st_ev:i.toString(a),e.ns_st_mp=null!=e.ns_st_mp?e.ns_st_mp:l.DEFAULT_PLAYERNAME,e.ns_st_mv=null!=e.ns_st_mv?e.ns_st_mv:l.STREAMSENSE_VERSION,e.ns_st_ub=null!=e.ns_st_ub?e.ns_st_ub:"0",e.ns_st_br=null!=e.ns_st_br?e.ns_st_br:"0",e.ns_st_pn=null!=e.ns_st_pn?e.ns_st_pn:"1",e.ns_st_tp=null!=e.ns_st_tp?e.ns_st_tp:"1",e.ns_st_it=null!=e.ns_st_it?e.ns_st_it:k.toString(k.SINGLE_CLIP),e.ns_st_sv=null!=e.ns_st_sv?e.ns_st_sv:l.STREAMSENSE_VERSION,e.ns_st_smv=null!=e.ns_st_smv?e.ns_st_smv:l.MODEL_VERSION,e.ns_type=null!=e.ns_type?e.ns_type:"hidden",e.ns_st_ec=null!=e.ns_st_ec?e.ns_st_ec:String(f.getEventManager().getEventCounter()),e.ns_st_po=null!=e.ns_st_po?e.ns_st_po:String(f.getPlaylist().getPlaylist().getClip().getExpectedPlaybackPosition(d)),e.ns_st_ki=null!=e.ns_st_ki?e.ns_st_ki:String(f.getKeepAlive().getInterval()),f.getPlaylist().createLabels(e),f.getPlaylist().getClip().createLabels(e),b.extend(e,aa.getLabels()),b.extend(e,c),{eventType:a,eventLabels:e}},newEvent:function(a,b,c,e){aa.stopDelayedTransitionTimer();var g=f.getStateMachine().getCurrentState(),h=f.getStateMachine().eventTypeToState(a);if(null!=h&&h!=g)if(!aa.isThrottlingEnabled()||g!=j.PLAYING&&g!=j.PAUSED||h!=j.PLAYING&&h!=j.PAUSED||e){c.ns_st_po||(f.getStateMachine().getCurrentState()==j.PLAYING&&a==i.BUFFER||f.getStateMachine().getCurrentState()==j.BUFFERING_DURING_PLAYBACK&&a==i.BUFFER_STOP?c.ns_st_po=String(f.getPlaylist().getClip().getPlaybackTimeOffset()+(b-f.getPlaylist().getClip().getPlaybackTimestamp())):c.ns_st_po=String(f.getPlaylist().getClip().getExpectedPlaybackPosition(b))),d(a,b,c);var k=0;isNaN(f.getStateMachine().getLastStateChangeTimestamp())||(k=b-f.getStateMachine().getLastStateChangeTimestamp()),f.getStateMachine().newEvent(a,b);for(var l=0,m=Z.length;m>l;l++)Z[l](g,h,c,k)}else Y=f.getPlatformAPI().setTimeout(function(a,c,d){return function(){aa.newEvent(a,b,d,!0)}}(a,h,c),da)},newPseudoEvent:function(a,b,c){if(a!=i.LOAD&&a!=i.START||f.getStateMachine().getCurrentState()==j.IDLE){a!=i.ERROR||c.ns_st_er||(c.ns_st_er=h.UNKNOWN_VALUE),f.getStateMachine().getCurrentState()!=j.IDLE&&f.getStateMachine().getCurrentState()!=j.PLAYBACK_NOT_STARTED&&f.getStateMachine().getCurrentState()!=j.SEEKING_BEFORE_PLAYBACK&&f.getStateMachine().getCurrentState()!=j.BUFFERING_BEFORE_PLAYBACK&&(f.getPlaylist().getClip().addElapsedTime(b),f.getPlaylist().getClip().setElapsedTimestamp(b));var d,e,g,k=!0,l=!1;switch(a){case i.BIT_RATE:d="ns_st_br",e="ns_st_pbr",l=!0;break;case i.PLAYBACK_RATE:d="ns_st_rt",e="ns_st_prt",l=!0;break;case i.VOLUME:d="ns_st_vo",e="ns_st_pvo",l=!0;break;case i.WINDOW_STATE:d="ns_st_ws",e="ns_st_pws",l=!0;break;case i.AUDIO:d="ns_st_at",e="ns_st_pat",l=!1;break;case i.VIDEO:d="ns_st_vt",e="ns_st_pvt",l=!1;break;case i.SUBS:d="ns_st_tt",e="ns_st_ptt",l=!1;break;case i.CDN:d="ns_st_cdn",e="ns_st_pcdn",l=!1;break;default:k=!1}if(k&&c.hasOwnProperty(d)&&(l?(aa.getLabels().hasOwnProperty(d)&&(g=aa.getLabels()[d],c[e]=g),aa.setLabel(d,c[d])):(f.getPlaylist().getClip().getLabels().hasOwnProperty(d)&&(g=f.getPlaylist().getClip().getLabels()[d],c[e]=g),f.getPlaylist().getClip().setLabel(d,c[d]))),!k||f.getStateMachine().getCurrentState()==j.PLAYING||f.getStateMachine().getCurrentState()==j.BUFFERING_DURING_PLAYBACK){c.ns_st_po||(c.ns_st_po=String(f.getPlaylist().getClip().getExpectedPlaybackPosition(b))),f.getStateMachine().getCurrentState()!=j.PLAYING&&f.getStateMachine().getCurrentState()!=j.BUFFERING_DURING_PLAYBACK||(f.getPlaylist().addPlaybackTime(b),f.getPlaylist().setPlaybackTimestamp(b),f.getPlaylist().getClip().addPlaybackTime(b),f.getPlaylist().getClip().setPlaybackTimestamp(b),f.getPlaylist().getClip().addInterval(parseInt(c.ns_st_po)),f.getPlaylist().getClip().setPlaybackStartPosition(parseInt(c.ns_st_po))),f.getStateMachine().getCurrentState()!=j.BUFFERING_BEFORE_PLAYBACK&&f.getStateMachine().getCurrentState()!=j.BUFFERING_DURING_PAUSE&&f.getStateMachine().getCurrentState()!=j.BUFFERING_DURING_PLAYBACK&&f.getStateMachine().getCurrentState()!=j.BUFFERING_DURING_SEEKING||(f.getPlaylist().addBufferingTime(b),f.getPlaylist().setBufferingTimestamp(b),f.getPlaylist().getClip().addBufferingTime(b),f.getPlaylist().getClip().setBufferingTimestamp(b));var m=aa.createLabels(a,c,b);f.getEventManager().newEvent(m)}}},getState:function(){return f.getStateMachine().getCurrentState()},addListener:function(a){Z.push(a)},removeListener:function(a){Z.splice(b.indexOf(a,Z),1)},getLabel:function(a){return $[a]},getLabels:function(){return $},setLabel:function(a,b){null==b?delete $[a]:$[a]=b},setLabels:function(a){for(var b in a)a.hasOwnProperty(b)&&aa.setLabel(b,a[b])},getPlatformAPI:function(){return f.getAppCore()?f.getAppCore().getPlatformAPI():g},getExports:function(){return ba},isProperlyInitialized:function(){var a=f.getAppCore().getAppContext(),b=f.getAppCore().getSalt(),c=f.getAppCore().getPixelURL();return a&&c&&b},setImplementationType:function(a){f.getStateMachine().getCurrentState()!=j.IDLE||a!=k.SINGLE_CLIP&&a!=k.SEGMENTED&&a!=k.REDUCED||f.getPlaylist().setLabel("ns_st_it",k.toString(a))},setThrottlingDelay:function(a){da=a},getThrottlingDelay:function(){return da},isThrottlingEnabled:function(){return X},setThrottlingEnabled:function(a){X=a},isLoadingTimeSent:function(){return S},setLoadingTimeSent:function(a){S=a},getLoadTimeOffset:function(){return T},setLoadTimeOffset:function(a){T=a},getInitTimestamp:function(){return U},setPauseOnBufferingInterval:function(a){ca=a},getPauseOnBufferingInterval:function(){return ca},isPauseOnBufferingEnabled:function(){return V},setPauseOnBufferingEnabled:function(a){V=a},startPausedOnBufferingTimer:function(a,c){aa.stopPausedOnBufferingTimer(),W=aa.getPlatformAPI().setTimeout(function(){var d={},e=b.fixEventTime(d),f=parseInt(c.ns_st_po);d.ns_st_po=String(f+e-a),aa.newEvent(i.PAUSE_ON_BUFFERING,e,d)},ca)},stopPausedOnBufferingTimer:function(){null!=W&&(aa.getPlatformAPI().clearTimeout(W),W=null)},stopDelayedTransitionTimer:function(){Y&&(aa.getPlatformAPI().clearTimeout(Y),Y=null)},setPixelURL:function(a){if(null==a||0==a.length)return null;var b=decodeURIComponent||unescape,c=a.indexOf("?");if(c>=0){if(c<a.length-1){for(var d=a.substring(c+1).split("&"),e=0,f=d.length;f>e;e++){var g=d[e],h=g.split("=");2==h.length?aa.setLabel(h[0],b(h[1])):1==h.length&&aa.setLabel(l.PAGE_NAME_LABEL,b(h[0]))}a=a.substring(0,c+1)}}else a+="?";return _=a},getPixelURL:function(){return _?_:"undefined"!=typeof ns_p&&"string"==typeof ns_p.src?_=ns_p.src.replace(/&amp;/,"&").replace(/&ns__t=\\d+/,""):"string"==typeof ns_pixelUrl?_=ns_pixelUrl.replace(/&amp;/,"&").replace(/&ns__t=\\d+/,""):null},getSseSM:function(){return f},resetPlaylist:function(a){var b=f.getPlaylist();f.setPlaylist(new n),n.resetPlaylist(b,f.getPlaylist(),a)},resetHeartbeat:function(){f.getHeartbeat().pause(),f.setHeartbeat(new p(f))},resetKeepAlive:function(){f.getKeepAlive().pause(),f.setKeepAlive(new q(f))}});var ea,fa;b.isBrowser()?(ea=window,fa=document):(ea={},fa={location:{href:""},title:"",URL:"",referrer:"",cookie:""}),b.extend(this,{prepareUrl:e}),a()}}(),G=function(){return function(a){var c,d,e,f,g,h,i=this;b.extend(i,{getAppCore:function(){return c},getSSECore:function(){return a},getEventManager:function(){return d},getStateMachine:function(){return e},getHeartbeat:function(){return f},getKeepAlive:function(){return g},getPlaylist:function(){return h},setAppCore:function(a){c=a},setKeepAlive:function(a){g=a},setHeartbeat:function(a){f=a},setEventManager:function(a){d=a},setStateMachine:function(a){e=a},setPlaylist:function(a){h=a}})}}(),H=function(){return function(a,c){function d(){h=new F,g=!0,a&&k.setLabels(a),c&&k.setPixelURL(c)}function e(a,b){k.notify(i.CUSTOM,a,b)}function f(){g&&h.getSseSM().getStateMachine().getCurrentState()!=j.IDLE&&k.end()}var g,h,k=this,m=l.STANDARD_METADATA_LABELS;b.extend(this,{isProperlyInitialized:function(){return h.isProperlyInitialized()},reset:function(a){var b=h;b.getSseSM().getKeepAlive().pause(),b.getSseSM().getHeartbeat().pause(),h=new F,n.resetPlaylist(b.getSseSM().getPlaylist(),h.getSseSM().getPlaylist(),a)},setPauseOnBufferingInterval:function(a){h.setPauseOnBufferingInterval(a)},getPauseOnBufferingInterval:function(){return h.getPauseOnBufferingInterval()},setKeepAliveInterval:function(a){h.getSseSM().getKeepAlive().setInterval(a)},getKeepAliveInterval:function(){return h.getSseSM().getKeepAlive().getInterval()},setHeartbeatIntervals:function(a){h.getSseSM().getHeartbeat().setIntervals(a)},play:function(a,b){k.notify(i.PLAY,a,b)},pause:function(a,b){k.notify(i.PAUSE,a,b)},end:function(a,b){k.notify(i.END,a,b)},bufferStart:function(a,b){k.notify(i.BUFFER,a,b)},bufferStop:function(a,b){k.notify(i.BUFFER_STOP,a,b)},load:function(a,b){k.notify(i.LOAD,a,b)},start:function(a,b){k.notify(i.START,a,b)},seekStart:function(a,b){k.notify(i.SEEK_START,a,b)},skipAd:function(a,b){k.notify(i.AD_SKIP,a,b)},callToAction:function(a,b){k.notify(i.CTA,a,b)},error:function(a,b){k.notify(i.ERROR,a,b)},transferPlayback:function(a,b){k.notify(i.TRANSFER,a,b)},drmFail:function(a,b){k.notify(i.DRM_FAILED,a,b)},drmApprove:function(a,b){k.notify(i.DRM_APPROVED,a,b)},drmDeny:function(a,b){k.notify(i.DRM_DENIED,a,b)},changeBitrate:function(a,b,c){if(null!=a){var d=c||{};d.ns_st_br=String(a),k.notify(i.BIT_RATE,d,b)}},changePlaybackRate:function(a,b,c){if(null!=a){var d=c||{};d.ns_st_rt=String(a),k.notify(i.PLAYBACK_RATE,d,b)}},changeVolume:function(a,b,c){if(null!=a){var d=c||{};d.ns_st_vo=String(a),k.notify(i.VOLUME,d,b)}},changeWindowState:function(a,b,c){if(null!=a){var d=c||{};d.ns_st_ws=String(a),k.notify(i.WINDOW_STATE,d,b)}},changeAudio:function(a,b,c){if(null!=a){var d=c||{};d.ns_st_at=String(a),k.notify(i.AUDIO,d,b)}},changeVideo:function(a,b,c){if(null!=a){var d=c||{};d.ns_st_vt=String(a),k.notify(i.VIDEO,d,b)}},changeSubtitle:function(a,b,c){if(null!=a){var d=c||{};d.ns_st_tt=String(a),k.notify(i.SUBS,d,b)}},changeCDN:function(a,b,c){if(null!=a){var d=c||{};d.ns_st_cdn=String(a),k.notify(i.CDN,d,b)}},notify:function(a){var c,d;if(c="object"==typeof arguments[1]?arguments[1]:"object"==typeof arguments[2]?arguments[2]:{},d="number"==typeof arguments[1]?arguments[1]:"number"==typeof arguments[2]?arguments[2]:NaN,i.toString(a)){c=b.jsonObjectToStringDictionary(c);var e=b.fixEventTime(c);c.ns_st_po||isNaN(d)||(c.ns_st_po=b.getInteger(d,0).toString()),c.ns_st_po&&h.getSseSM().getPlaylist().getClip().setPlaybackTimeOffset(parseInt(c.ns_st_po)),a==i.PLAY||a==i.PAUSE||a==i.BUFFER||a==i.END||a==i.SEEK_START||a==i.AD_SKIP||a==i.BUFFER_STOP?h.newEvent(a,e,c):h.newPseudoEvent(a,e,c)}},getLabels:function(){return h.getLabels()},getState:function(){return h.getSseSM().getStateMachine().getCurrentState()},setLabels:function(a){h.setLabels(a)},getLabel:function(a){return h.getLabel(a)},setLabel:function(a,b){h.setLabel(a,b)},getLoadTimeOffset:function(){return h.getLoadTimeOffset()},setLoadTimeOffset:function(a){h.setLoadTimeOffset(a)},setPixelURL:function(a){return h.setPixelURL(a)},getPixelURL:function(){return h.getSseSM().getSSECore().getPixelURL()},setImplementationType:function(a){h.setImplementationType(a)},isPauseOnBufferingEnabled:function(){return h.isPauseOnBufferingEnabled()},setPauseOnBufferingEnabled:function(a){h.setPauseOnBufferingEnabled(a)},isThrottlingEnabled:function(){return h.isThrottlingEnabled()},setThrottlingEnabled:function(a){h.setThrottlingEnabled(a)},setThrottlingDelay:function(a){h.setThrottlingDelay(a)},getThrottlingDelay:function(){return h.getThrottlingDelay()},setPlaybackIntervalMergeTolerance:function(a){h.getSseSM().getPlaylist().getClip().setPlaybackIntervalMergeTolerance(a)},getPlaybackIntervalMergeTolerance:function(){return h.getSseSM().getPlaylist().getClip().getPlaybackIntervalMergeTolerance()},setClip:function(a,c,d){if(void 0===d&&(d=!0),a=b.jsonObjectToStringDictionary(a),d&&h.getSseSM().getStateMachine().getCurrentState()!==j.IDLE&&k.end(),h.getSseSM().getStateMachine().getCurrentState()==j.IDLE){var e="",f=0;if(null!=a.ns_st_cn)e=String(a.ns_st_cn);else for(var g=0;g<m.length;g++)a[m[g]]&&(e+=m[g]+":"+a[m[g]]+";");var i=h.getSseSM().getPlaylist(),l=i.getClip();l.isClipStarted()?(i.hashExists(l.getHash())||(i.storeHash(l.getHash()),i.storeClipNumber(l.getHash(),l.getClipNumber())),i.storeClipPlaybackCounters(),f=i.hashExists(e)?i.getClipNumber(e):b.exists(a.ns_st_cn)?parseInt(a.ns_st_cn):i.getMaxClipNumber()+1):f=i.hashExists(e)?i.getClipNumber(e):l.getClipNumber(),i.resetClip(),l=i.getClip(),l.setHash(e),l.setClipNumber(f),l.setLabels(a);var n=i.getStoredClipRegisters(e);return n&&(l.setClipStarted(!0),l.setSegmentPlaybackCounter(n.segmentPlaybackCounter),l.setClipLoadCounter(n.clipLoadCounter),l.setAssetPlaybackCounter(n.assetPlaybackCounter),l.setLowestPartNumberPlayed(n.lowestPartNumberPlayed),l.setSeeking(n.seeking),l.setSeekingTimeBeforeEnd(n.seekingTimeBeforeEnd),l.setSeekStartPosition(n.seekingStartPosition),l.setClipPlaybackIntervals(n.clipPlaybackIntervals),l.setUniquePlaybackInterval(n.uniquePlaybackInterval),l.setLongestPlaybackInterval(n.longestPlaybackInterval),l.setVideoTrack(n.videoTrack),l.setAudioTrack(n.audioTrack),l.setSubtitleTrack(n.subtitleTrack),l.setCDN(n.cdn),l.setPreviousUniquePlaybackInterval(n.uniquePlaybackInterval),l.setPreviousEventIndependentUniquePlaybackInterval(n.uniquePlaybackInterval),l.setPreviousLongestPlaybackInterval(n.longestPlaybackInterval)),l.incrementClipLoadCounter(),l.isClipStarted()&&c&&(i.incrementPlayCounter(),i.incrementPlaybackCounter()),!0}return!1},setPlaylist:function(a,c){return void 0===c&&(c=!0),a=b.jsonObjectToStringDictionary(a),c&&h.getSseSM().getStateMachine().getCurrentState()!==j.IDLE&&k.end(),h.getSseSM().getStateMachine().getCurrentState()==j.IDLE?(h.getSseSM().getPlaylist().isPlaylistStarted()&&h.resetPlaylist(),h.getSseSM().getPlaylist().setLabels(a),!0):!1},importState:function(){},exportState:function(){return{}},getVersion:function(){return l.STREAMSENSE_VERSION},addListener:function(a){h.addListener(a)},removeListener:function(a){h.removeListener(a)},getClip:function(){return console&&console.warn&&console.warn("getClip() is deprecated. Use getPlaylist().getClip() instead."),h.getSseSM().getPlaylist().getClip()},getPlaylist:function(){return h.getSseSM().getPlaylist()},setHttpGet:function(a){"function"==typeof a&&(h.getPlatformAPI().httpGet=a)},setHttpPost:function(a){"function"==typeof a&&(h.getPlatformAPI().httpPost=a)},setExitEndEventEnabled:function(a){g=a},isExitEndEventEnabled:function(){return g},getPlatformAPI:function(){return h.getPlatformAPI()}}),b.extend(this,{customNotify:e,viewNotify:function(a,b){a=a||k.getPixelURL(),a&&viewNotify(a,b)}}),b.isBrowser()&&(window.addEventListener?(window.addEventListener("beforeunload",f),window.addEventListener("unload",f)):window.attachEvent&&(window.attachEvent("onbeforeunload",f),window.attachEvent("onunload",f))),d()}}();return function(c){function d(a,b){return x[z]||f(a,b)}function e(){z=-1;for(var b=0;y>=b;b++)if(x.hasOwnProperty(String(b))){z=b;break}return a.StreamSense.activeIndex=z,z}function f(b,c){return b=b||null,c=c||null,b&&"object"==typeof b&&(c=b,b=null),x[++y]=new a.StreamSense(c,b),e(),x[y]}function g(){var b=!1,c=z;if("number"==typeof arguments[0]&&isFinite(arguments[0]))c=arguments[0];else if(arguments[0]instanceof a.StreamSense)for(var d in x)if(x.hasOwnProperty(d)&&x[d]===arguments[0]){c=d;break}return x.hasOwnProperty(String(c))&&(b=x[c],delete x[c],b.reset(),e()),b}function h(a){return a=a||{},d().setPlaylist(a),d().getPlaylist()}function i(a,b,c){return a=a||{},"number"==typeof b&&(a.ns_st_cn=String(b)),d().setClip(a,c),d().getClip()}function j(a,b,c){return"undefined"==typeof a?!1:(c=c||null,b=b||{},d().notify(a,b,c))}function k(a){"undefined"!=typeof a&&d().setLabels(a)}function l(){return d().getLabels()}function m(a){"undefined"!=typeof a&&d().getPlaylist().setLabels(a)}function n(){return d().getPlaylist().getLabels()}function o(a){"undefined"!=typeof a&&d().getClip().setLabels(a)}function p(){return d().getClip().getLabels()}function q(a){return d().reset(a||{})}function r(a){return d().getPlaylist().reset(a||{})}function s(a){return d().getClip().reset(a||{})}function t(a){return a=a||{},d().viewNotify(null,a)}function u(a,b){return arguments.length>2&&(a=arguments[1],b=arguments[2]),a=a||{},"number"==typeof b&&(a.ns_st_po=String(b)),d().customNotify(a,b)}function v(){return d().exportState()}function w(a){d().importState(a)}var x={},y=-1,z=-1;b.extend(c,{activeIndex:z,newInstance:f,"new":f,destroyInstance:g,destroy:g,newPlaylist:h,newClip:i,notify:j,setLabels:k,getLabels:l,setPlaylistLabels:m,getPlaylistLabels:n,setClipLabels:o,getClipLabels:p,resetInstance:q,resetPlaylist:r,resetClip:s,viewEvent:t,customEvent:u,exportState:v,importState:w})}(H),H.PlayerEvents=i,H.InternalStates=j,H.ImplementationType=k,H}(),a.StreamingTag=a.StreamingTag||function(){var c=a.StreamSense,d=(a.StreamSense.PlayerEvents,a.StreamSense.InternalStates||null),e=a.StreamSense.ImplementationType||null,f=null!=a.StreamSense.InternalStates&&null!=a.StreamSense.ImplementationType;return function(){var a={LongFormOnDemand:"12",ShortFormOnDemand:"11",Live:"13",UserGeneratedLongFormOnDemand:"22",UserGeneratedShortFormOnDemand:"21",UserGeneratedLive:"23",Bumper:"99",Other:"00"},g={LinearOnDemandPreRoll:"11",LinearOnDemandMidRoll:"12",LinearOnDemandPostRoll:"13",LinearLive:"21",Other:"00"},h=function(a){function g(){if(f)if(b.getNamespace().comScore)q=new c,q.setImplementationType(e.REDUCED);else if(b.exists(a))if(r=b.isTrue(a.debug),b.exists(a.customerC2)&&a.customerC2.length>0){var d=a.secure?"https://sb":"http"+("s"==document.location.href.charAt(4)?"s://sb":"://b");q=new c,q.setPixelURL(d+".scorecardresearch.com/p?c1=2"),q.setLabel("c2",a.customerC2),q.setImplementationType(e.REDUCED)}else r&&console&&console.log("Warning: customerC2 is not provided (or incorrect) in the StreamingTag configuration.")}function h(a){b.exists(a)||(a={});for(var c in t)t.hasOwnProperty(c)&&!b.exists(a[t[c]])&&("ns_st_ci"==t[c]?a.ns_st_ci="0":a[t[c]]="*null");return a}function i(a){for(var b in t)if(t.hasOwnProperty(b)&&!j(t[b],o,a))return!1;return!0}function j(a,c,d){if(b.exists(a)&&b.exists(c)&&b.exists(d)){var e=c[a],f=d[a];return b.exists(e)&&b.exists(f)&&e===f}return!1}function k(a){n++;var c={ns_st_cn:String(n),ns_st_pn:"1",ns_st_tp:"0"};b.extend(c,a),q.setClip(c),o=a,q.play()}function l(a){n++,a=h(a);var c={ns_st_cn:String(n),ns_st_pn:"1",ns_st_tp:"1",ns_st_ad:"1"};b.extend(c,a),q.setClip(c),q.play(),p=!1}function m(a,b){a=h(a),u==s.None&&(u=b),p&&u==b&&i(a)?(q.getClip().setLabels(a),q.getState()!=d.PLAYING&&q.play()):k(a),p=!0,u=b}var n=0,o=null,p=!1,q=null,r=!1,s={None:0,AudioContent:1,VideoContent:2},t=["ns_st_ci","c3","c4","c6","ns_st_st","ns_st_pu","ns_st_pr","ns_st_ep","ns_st_sn","ns_st_en","ns_st_ct"],u=s.None;b.extend(this,{playAdvertisement:function(){if(q){r&&console&&console.warn("Calling deprecated function \'playAdvertisement\'. Please call \'playVideoAdvertisement\' or \'playAudioAdvertisement\' functions instead.");var a={ns_st_ct:"va"};l(a)}},playVideoAdvertisement:function(a,c){if(q){var d={ns_st_ct:"va"};c?d.ns_st_ct="va"+c:r&&console&&console.warn("Calling \'playVideoAdvertisement\' without specifying the media type as a second parameter."),a&&b.extend(d,a),l(d)}},playAudioAdvertisement:function(a,c){if(q){var d={ns_st_ct:"aa"};c?d.ns_st_ct="aa"+c:r&&console&&console.warn("Calling \'playAudioAdvertisement\' without specifying the media type as a second parameter."),a&&b.extend(d,a),l(d)}},playContentPart:function(a){if(q){r&&console&&console.warn("Calling deprecated function \'playContentPart\'. Please call \'playVideoContentPart\' or \'playAudioContentPart\' functions instead.");var c={ns_st_ct:"vc"};a&&b.extend(c,a),m(c,s.VideoContent)}},playVideoContentPart:function(a,c){if(q){var d={ns_st_ct:"vc"};c?d.ns_st_ct="vc"+c:r&&console&&console.warn("Calling \'playVideoContentPart\' without specifying the media type as a second parameter."),a&&b.extend(d,a),m(d,s.VideoContent)}},playAudioContentPart:function(a,c){if(q){var d={ns_st_ct:"ac"};c?d.ns_st_ct="ac"+c:r&&console&&console.warn("Calling \'playAudioContentPart\' without specifying the media type as a second parameter."),a&&b.extend(d,a),m(d,s.AudioContent)}},stop:function(){q&&q.pause()}}),g()};return function(a){}(h),h.ContentType=a,h.AdType=g,h}()}(),a});\n',
language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLbc9ad60fb71d43e68e9f982d9fed4a4d",name:"50 - Newsletter Selection Page Events [cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"newsletters",valueIsRegex:!0}]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"(function () {\n  /* global $t, s, __CNBC_META_DATA, BI */\n  function trackAdobe(action, actionContextData) {\n    s.contextData = actionContextData;\n    s.tl(true, 'o', action);\n    s.manageVars('clearVars');\n  }\n\n  // Sending data to adobe when a user makes a selection\n  // about which newsletters to subscribe to on\n  // https://www.cnbc.com/sign-up-for-cnbc-newsletters/\n  function sendNewsletterSubscribesToAdobe() {\n    $t('on', 'bte_event', function (e, data) {\n      let analyticId = data?.data?.dataset?.analyticId;\n      let isClick = data?.eventName == 'click';\n      let isSubmitButton = analyticId === 'newsletter-subscribe';\n      if (!isClick || !isSubmitButton) return;\n\n      let pageId = __CNBC_META_DATA.id;\n\n      let selections = Array.from(document.querySelectorAll('.NewslettersCard-selectedToggle'))\n        .map(e => e.getAttribute('id'));\n\n      trackAdobe(analyticId, {\n        'cnbc.action': `${analyticId}: ${pageId}`,\n        'cnbc.selectednewsletter': selections.join('|'),\n        'cnbc.brand': __CNBC_META_DATA.brand != undefined ? __CNBC_META_DATA.brand : 'NA',\n        'cnbc.platform': 'web',\n      });\n    });\n  }\n\n  BI.wrapWithOneTrust({\n    fn: sendNewsletterSubscribesToAdobe,\n    featureName: 'Newsletter Subscribes -> Adobe',\n    categories: [7]\n  });\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLbd555e40430646baad74b4695d3c3fda",name:"60 - univideo - player adapter (cvsdk) [univideo, d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"(function () {\n  /* globals $t, BI */\n  $t('register', 'uni_cvsdk_error');\n\n  var topLevelDomain = (function () {\n    var validDomains = ['nbcnews.com', 'today.com', 'msnbc.com', 'telemundo.com', 'cnbc.com'];\n    var isAmp = location.hash.indexOf('amp=1') != -1;\n    var ampDomainOverride = (location.hash.split('domain=')[1] || '').split('&')[0];\n    var topLevelDomain =\n      (isAmp && ampDomainOverride) || document.location.hostname.match(/[^./]+\\.[^./]+$/)[0];\n    return validDomains.indexOf(topLevelDomain) != -1 ? topLevelDomain : 'nbcnews.com';\n  })();\n\n  var logEvent = (window.BI && BI.console && BI.console.build && BI.console.build('uni_cvsdk')) || Function.prototype;\n\n  //metadata loading (maybe this could be a separate file?)\n  let _metaData = {\n    custom: {},\n  };\n\n  const uniEvent = (window.uniVideo && window.uniVideo.event) || {};\n  const uniTrack = (window.uniVideo && window.uniVideo.buildUniTrack()) || function () {};\n  let _didLoad = false;\n  let _boundSessionID = null; // used to determine if the session events have been bound to UniVideo\n\n  $t('on', 'ltng_cvsdk_metadata_updated', (e, data) => {\n    const builtObject = data.video?.tracking?.adobe || {};\n\n    /*\n    //not sure where this data comes from on the back end?\n    videocliptype: \"Live\"\n    videocontentrating: \"live\"\n    videocontentsource: \"nbcnews\"\n    videocontenttype: \"Video\"\n    videoguid: \"2007524\"\n    videompxid: \"not available\"\n    videonetwork: \"NBC News\"\n    videopackageid: \"11849386\"\n    videoprogram: \"NBC News Now\"\n    videopublishdate: \"2020-03-24T09:03:39Z\"\n    videostatus: \"Unrestricted\"\n    videotitle: \"Live: NBC News NOW\"\n    videovideocontenttype: \"Live\"\n    */\n\n    _metaData['program'] = builtObject.videoprogram;\n    _metaData['title'] = builtObject.videotitle;\n    _metaData['source'] = builtObject.videocontentsource;\n    _metaData['guid'] = builtObject.videoguid;\n  });\n\n  $t('on', 'sigma_cvsdk_updatedMetadata', (_e, data) => {\n    const builtObject = $t('sigma_cvsdk_updatedMetadata.tve.showsSchedule.live', {});\n    // Compare guid from updatedMetadata to current assetID\n    let isNewSegment = uniTrack.videoData().assetID !== data.guid;\n    if (isNewSegment) {\n      if (uniTrack.videoState().inSegment) {\n        // Fire segment end before updating\n        eventQueue(uniTrack, uniEvent.SEGMENT_END);\n        eventQueue(uniTrack.videoState, {\n          inSegment: false,\n          segmentPosition: uniTrack.videoState().segmentPosition + 1,\n        });\n      }\n      // extract/rename unique metadata to custom\n      _metaData.custom['videosubcat2'] = builtObject.displayGenre;\n      _metaData.custom['program'] = data.program;\n      _metaData.custom['segmentTitle'] = builtObject.title;\n      // merge entire live object w/ _metaData.custom\n      _metaData.custom = {\n        ..._metaData.custom,\n        ...builtObject,\n      };\n\n      // update videoData\n      uniTrack.videoData({\n        assetID: data.guid || '',\n        dateBroadcast: data.airDate ? new Date(Date.parse(data.airDate)).toISOString() : '',\n        datePublished: builtObject.pubDate\n          ? new Date(Date.parse(builtObject.pubDate)).toISOString()\n          : '',\n      });\n\n      // Fire update and segment start\n      eventQueue(uniTrack, uniEvent.SEGMENT_START);\n      eventQueue(uniTrack.videoState, {\n        inSegment: true,\n      });\n    } else {\n      // updatedMetadata should not fire with the same assetID\n      $t('track', 'uni_cvsdk_error', { message: 'sigma_cvsdk_updatedMetadata fired with same assetID' });\n    }\n    let tempPass = $t('sigma_cvsdk_updatedMetadata.tempPass', { tempPassEnabled: undefined });\n    _metaData.custom['tempPassEnabled'] = tempPass.tempPassEnabled;\n    _metaData.custom['mvpd'] = $t(\n      'sigma_cvsdk_updatedMetadata.mvpd.selectedMvpdId',\n      _metaData.custom['mvpd']\n    );\n    uniTrack.videoData({ ..._metaData });\n  });\n\n  // Mapping hostname to video guid to safeguard against cases\n  // where the player doesn't provide a meaningful value\n  function preventBadGUIDs(_metaData) {\n    const hostname = window.location.hostname;\n    const isBadGUID = () => [undefined, 'not available', ''].includes(_metaData['guid']);\n\n    if (isBadGUID()) {\n      if (hostname.includes('msnbc.com')) {\n        _metaData['guid'] = '5608086763860174117';\n      } else if (hostname.includes('nbcnews.com')) {\n        _metaData['guid'] = '5676009166762707117';\n      } else if (hostname.includes('today.com')) {\n        _metaData['guid'] = '7989219137174638117';\n      } else if (hostname.includes('cnbc.com')) {\n        _metaData['guid'] = '5724738528402108117';\n      }\n    }\n  }\n\n  // Setup an internal queue to process events that happen before CVSDK is truly loaded\n  // This is necessary because CVSDK fires events before the session is created\n  const eventQueue = (function () {\n    let queue = [];\n    // wrapper function to call the command with the arguments passed to eventQueue\n    const wrapper = function (command, ...parameters) {\n      command(...parameters);\n    };\n    let processor = function (...args) {\n      if (!_didLoad) {\n        queue.push(args);\n      } else {\n        if (args.length > 0) {\n          queue.push(args);\n        }\n        if (queue.length > 0) {\n          while (queue.length > 0) {\n            let event = queue.pop();\n            wrapper(...event);\n          }\n        }\n      }\n    };\n    return processor;\n  })();\n\n  const cvsdkUniBind = (eventName, data) => {\n    // Logging events, but excluding \"progress\" events\n    // and adBreakDataReceived events (these are unnecessarily noisy)\n    if (!['onPositionChanged', 'onAdPositionChanged', 'onAdBreakDataReceived'].includes(eventName)) {\n      logEvent(eventName, {\n        eventData: data,\n        videoData: uniTrack.videoData(),\n        videoState: uniTrack.videoState(),\n      });\n    }\n\n    switch (eventName) {\n      case 'onPositionChanged':\n        uniTrack.videoData({ playheadPosition: data * 1000 });\n        uniTrack(uniEvent.PROGRESS);\n        break;\n      case 'onAdPositionChanged':\n        uniTrack(uniEvent.PROGRESS);\n        break;\n      case 'unmapped': //no init event setup\n        uniTrack(uniEvent.INIT);\n        break;\n      case 'onPlayoutDataReceived':\n        var assetMetadata = data.custom?.nativeReporting?.assetMetadata || {};\n        var isNewsLive = data['type'] === 'Live' && assetMetadata.channelName.includes('news');\n        _metaData.custom['videosubcat1'] = isNewsLive ? 'News' : 'News and Information';\n\n        var videoData = {\n          duration: assetMetadata.duration || 0,\n          guid: data.advertising?.contentId || '',\n          playInitiate: data.autoplay ? 'Auto' : 'Manual',\n          sentiment: 'live', //hardcoded for now\n          source: assetMetadata.channelId || '',\n          streamType: 'linear', //hardcoded for now\n          title: assetMetadata.channelName || '',\n          videoCount: (uniTrack.videoData().videoCount || 0) + 1,\n          videoType: data.type, // Prerecorded?\n        };\n\n        // Matching metadata from Playmaker -> UniVideo\n        if (videoData['source'] === 'Today') {\n          videoData['source'] = 'TODAY';\n          videoData['title'] = 'TODAY';\n          videoData['newsNetwork'] = 'TODAY';\n        }\n\n        // Matching metadata from Playmaker -> UniVideo\n        if (videoData['source'] === 'NBC News Now') {\n          videoData['title'] = 'NBC News';\n          videoData['newsNetwork'] = 'NBC News Now';\n        }\n\n        // Matching metadata from Playmaker -> UniVideo\n        if (videoData['source'] === 'CNBC') {\n          videoData['title'] = 'cnbc';\n          videoData['newsNetwork'] = 'CNBC';\n        }\n\n        preventBadGUIDs(videoData);\n\n        uniTrack.videoData({ ..._metaData, ...videoData });\n        // update source value for \"news now\" show\n        if (uniTrack.videoData().title === 'NBC News NOW') {\n          uniTrack.videoData({ source: uniTrack.videoData().title });\n        }\n\n        if (!_didLoad) {\n          _didLoad = true;\n          uniTrack(uniEvent.VIDEO_LOADED);\n        }\n\n        break;\n      case 'onStateChanged:Loading':\n        break;\n      case 'onStateChanged:Playing':\n        if (uniTrack.videoState().playState !== 'play') {\n          uniTrack(uniEvent.PLAY);\n          uniTrack.videoState({ playState: 'play' });\n          // Process any queued events before play occurred\n          eventQueue();\n        }\n        break;\n      case 'onSeekStarted':\n        uniTrack(uniEvent.SEEK_START);\n        break;\n      case 'onStateChanged:Stopped':\n        uniTrack(uniEvent.STOP);\n        uniTrack.videoState({ playState: 'stop' });\n        break;\n      case 'onStateChanged:Rebuffering':\n        // TODO: Support \"BUFFERING\" event + playState: 'buffer' in UniVideo?\n        // https://nbcnewsdigital.atlassian.net/browse/AFT-868\n        break;\n      case 'onSessionEnded':\n        uniTrack(uniEvent.COMPLETE);\n        uniTrack.videoState({ playState: 'stop' });\n        break;\n      case 'onStateChanged:Paused':\n        if (uniTrack.videoState().playState === 'play') {\n          uniTrack(uniEvent.PAUSE);\n          uniTrack.videoState({ playState: 'pause' });\n        }\n        break;\n      case 'FULLSCREEN': //this is not setup for cvsdk\n        uniTrack(uniEvent.FULLSCREEN);\n        uniTrack.videoState({ fullScreen: data.fullScreen });\n        break;\n      case 'onMuteChanged':\n        uniTrack.videoState({ isMuted: data });\n        break;\n      case 'onSeekEnded':\n        uniTrack(uniEvent.SEEK_COMPLETE);\n        break;\n      case 'onAdStarted':\n        uniTrack.videoData({\n          adLength: data.expectedDuration,\n          adName: data.name,\n          adId: data.id,\n        });\n        uniTrack.videoState({ inAd: true });\n        uniTrack(uniEvent.AD_PLAY);\n        /*\n          id: \"41613_1\"\n          name: \"NBC News linear site group Test - Desktop NBC News\"\n          expectedDuration: 15.115\n          */\n        break;\n      case 'onAdFinished':\n        uniTrack.videoState({\n          adPosition: uniTrack.videoState().adPosition + 1,\n          inAd: false,\n        });\n        uniTrack(uniEvent.AD_COMPLETE);\n        break;\n      case 'onAdBreakStarted':\n        uniTrack.videoData({ adBreakName: data.type?.toLowerCase() || ''});\n        uniTrack(uniEvent.AD_BREAK_START);\n        break;\n      case 'onAdBreakFinished':\n        uniTrack.videoState({\n          adPosition: 1,\n          adBreakPosition: uniTrack.videoState().adBreakPosition + 1,\n        });\n        uniTrack(uniEvent.AD_BREAK_COMPLETE);\n        break;\n      case 'scteBreakStart': //TODO not updates for cvsdk\n        //nbcsplayer.PlayerMessageTypes.SCTE_BREAK_START\n        uniTrack.videoData({\n          assetId: data.assetId,\n        });\n        if (uniTrack.videoState().inSegment) {\n          uniTrack.videoState({\n            inSegment: false,\n          });\n          uniTrack(uniEvent.SEGMENT_END);\n        }\n        break;\n      case 'scteBreakEnd': //TODO not updates for cvsdk\n        //nbcsplayer.PlayerMessageTypes.SCTE_BREAK_END\n        if (uniTrack.videoState().inSegment) {\n          //if start before end, end and skip next end\n          uniTrack(uniEvent.SEGMENT_END);\n        }\n        uniTrack.videoState({\n          inSegment: true,\n          segmentPosition: uniTrack.videoState().segmentPosition + 1,\n        });\n        uniTrack(uniEvent.SEGMENT_START);\n        break;\n      case 'scteProgramStart': //TODO not updates for cvsdk\n        //nbcsplayer.PlayerMessageTypes.SCTE_PROGRAM_START\n\n        if (uniTrack.videoState().inSegment) {\n          //if start before end, end and skip next end\n          uniTrack(uniEvent.SEGMENT_END);\n        }\n        //set new asset after end\n        uniTrack.videoData({\n          assetId: data.assetId,\n        });\n        uniTrack.videoState({\n          inSegment: true,\n          segmentPosition: 1,\n        });\n        uniTrack(uniEvent.SEGMENT_START);\n        break;\n      case 'scteProgramEnd': //TODO not updates for cvsdk\n        // nbcsplayer.PlayerMessageTypes.SCTE_PROGRAM_END\n        // skip program end now, since there is no assetId to know which start an end is to, and they are out of order\n        // eslint-disable-next-line no-constant-condition\n        if (uniTrack.videoState().inSegment && false) {\n          uniTrack.videoState({\n            inSegment: false,\n          });\n          uniTrack(uniEvent.SEGMENT_END);\n        }\n        break;\n      case 'onAdError':\n        // TODO: need to support skipping ad in Adobe if there's an error\n        break;\n      case 'onWarning':\n      case 'onError':\n        //TODO Temp for error logging to mparticle\n        $t('track', 'uni_cvsdk_error', data);\n        break;\n      default:\n        break;\n    }\n  };\n\n  const subscribeUniEventsToCvsdk = playerController => {\n    const cvsdkEventList = [\n      'onAdBreakDataReceived',\n      'onAdBreakFinished',\n      'onAdBreakStarted',\n      //'onAdError',\n      'onAdFinished',\n      'onAdPositionChanged',\n      'onAdStarted',\n      //'onAudioTrackChanged',\n      //'onAutoPlayPolicyPreventedPlayback',\n      //'onAvailableAudioTracksChanged',\n      //'onAvailableSubtitlesTracksChanged',\n      //'onAvailableThumbnailVariantsChanged',\n      //'onBitrateChanged',\n      //'onDurationChanged',\n      //'onEncodedFrameRateChanged',\n      'onEndOfEventMarkerReceived',\n      'onError',\n      'onEventBoundary',\n      'onMuteChanged',\n      'onPauseAd',\n      //'onPinRequired',\n      //'onPinSuccess',\n      //'onPlaybackTimelineUpdated', //this might be useful later\n      'onPlayoutDataReceived',\n      'onPositionChanged',\n      //'onRenderedFrameRateChanged',\n      'onSeekEnded',\n      'onSeekStarted',\n      'onSessionEnded',\n      //'onSessionRetryEnded',\n      //'onSessionRetryStarted',\n      'onStateChanged',\n      //'onSubtitleCuesChanged',\n      //'onSubtitlesTrackChanged',\n      'onVolumeChanged',\n      'onWarning',\n    ];\n\n    const getCurrentSession = function (playerController, callBack) {\n      if (playerController.currentSession) {\n        callBack(playerController.currentSession);\n      } else {\n        playerController.onSessionCreated(callBack);\n      }\n    };\n\n    getCurrentSession(playerController, function (currentSession) {\n      // only bind events if they have not been bound to the current session\n      if (currentSession.guid !== _boundSessionID) {\n        cvsdkEventList.forEach(event => {\n          let modifiedEventName = event;\n          let handler = currentSession[event];\n          if (typeof handler !== 'function') return;\n\n          handler((data) => {\n            if (event === 'onStateChanged') {\n              //onStateChanged has sub events\n              modifiedEventName = event + ':' + data;\n            }\n            cvsdkUniBind(modifiedEventName, data);\n          });\n        });\n        // add a guid property to the current session & assign it to the internal _boundSessionID\n        currentSession.guid = _metaData.custom['cvsdkSessionID'] = _boundSessionID = `rand_${((Math.random() * 36 * 100000) | 0).toString(36)}`;\n      }\n\n      // add beforeunload event to fire the stop event\n      const videoStopOnUnload = function () {\n        if (uniTrack.videoState().playState !== 'stop') {\n          uniTrack.videoState({ playState: 'stop' });\n          uniTrack(uniEvent.STOP);\n        }\n      };\n      if (currentVideoEl) {\n        window.addEventListener('beforeunload', videoStopOnUnload, { once: true, passive: true });\n      }\n    });\n  };\n\n  $t('on', 'sigma_cvsdk_playerInit', function (e, data) {\n    if ($t('sigma_cvsdk_playerInit.PlayerController.currentSession.guid', undefined) !== _boundSessionID) {\n      var builtObject =\n        $t('sigma_cvsdk_playerInit.PlayerController.config.addons.common', null) ?? // Support for Omega V1. Removeable when V2 is released\n        $t('sigma_cvsdk_playerInit.cvsdk.config.default.addons.common', {});\n      _metaData.custom = {\n        ..._metaData.custom,\n        appName: builtObject.appName ? builtObject.appName.toUpperCase() : 'CNBC',\n        appVersion: '1.0.0', //hardcoded for now. this should be Phoenix version...\n        playerVersion: builtObject.appVersion || 'not available',\n        videoDomain: topLevelDomain,\n        mvpd: data.mvpdId,\n      };\n      var videoData = {\n        playbackAdapter: 'cvsdk', //hardcoded for now\n      };\n      uniTrack.videoData({ ..._metaData, ...videoData });\n      uniTrack(uniEvent.INIT);\n    } else {\n      $t('track', 'uni_cvsdk_error', { message: 'sigma_cvsdk_playerInit fired >1 with the same session' });\n    }\n  });\n\n  $t('on', 'ltng_cvsdk_playerInit', function () {\n    _metaData.custom['appName'] = 'lightning';\n  });\n\n  const platformInitEventList = ['sigma_cvsdk_playerInit', 'ltng_cvsdk_playerInit'];\n\n  let currentVideoEl = null;\n  platformInitEventList.forEach(eventName => {\n    if ($t(eventName)) {\n      // if player inits before this code\n      if ($t(`${eventName}.videoEl`) !== currentVideoEl) {\n        const PlayerController = $t(`${eventName}.PlayerController`);\n        subscribeUniEventsToCvsdk(PlayerController);\n        currentVideoEl = $t(`${eventName}.videoEl`);\n      }\n    } else {\n      $t('on', eventName, function () {\n        // if it did not init, will catch init. If we need multiple players, this should be removed from \"else\"\n        if ($t(`${eventName}.videoEl`) !== currentVideoEl) {\n          const PlayerController = $t(`${eventName}.PlayerController`);\n          subscribeUniEventsToCvsdk(PlayerController);\n          currentVideoEl = $t(`${eventName}.videoEl`);\n        }\n      });\n    }\n  });\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLc286b7ccb7044a68b0232f7afe7a2f51",name:"50 - Zephr Tag [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"(function() {\n  window.zephr_nbc = window.zephr_nbc || {};\n\n  window.zephr_nbc.loadZephrDataLayerSDK = function({ logEvent = Function.prototype }) {\n    var xhr = new(XMLHttpRequest || window.ActiveXObject)('MSXML2.XMLHTTP.3.0');\n    xhr.open('GET', '/blaize/datalayer', true);\n    xhr.onreadystatechange = function() {\n      if (xhr.readyState === 4) {\n        var response;\n        try {\n          response = JSON.parse(xhr.response);\n        } catch (e) {\n          response = xhr.response;\n        }\n        if (xhr.status === 200) {\n          for (var dataLayerFieldName in response) {\n            if (!(dataLayerFieldName in window)) window[dataLayerFieldName] = [];\n\n            var pageView = response[dataLayerFieldName];\n            var events = [];\n\n            if (window.Zephr && window.Zephr.includeOutcomes && window.Zephr.outcomes) {\n              pageView.zephrOutcomes = window.Zephr.outcomes;\n\n              if (window.Zephr.outcomesAsEvents) {\n                Object.keys(window.Zephr.outcomes || []).forEach(function(outcomeKey) {\n                  var outcomeEvent = {\n                    event: 'zephr-outcome-' + outcomeKey,\n                    featureId: outcomeKey,\n                    featureLabel: window.Zephr.outcomes[outcomeKey].featureLabel,\n                    outcomeId: window.Zephr.outcomes[outcomeKey].outcomeId,\n                    outcomeLabel: window.Zephr.outcomes[outcomeKey].outcomeLabel,\n                  };\n                  events.push(outcomeEvent);\n                });\n              }\n            }\n            if (window.Zephr && window.Zephr.accessDetails) {\n              Object.keys((window.Zephr.accessDetails.trials || {})).forEach(function(trialId){\n                var trial = window.Zephr.accessDetails.trials[trialId];\n                if(trial.reportInDataLayer){\n                  var usedCredits = trial.totalCredits - trial.remainingCredits;\n                  if (window.Zephr.groupFields && !pageView.zephrTrials) pageView.zephrTrials = {};\n                  var target = window.Zephr.groupFields ? pageView.zephrTrials : pageView;\n                  if (trial.dataLayerCreditsUsedKey) {\n                    target[trial.dataLayerCreditsUsedKey] = usedCredits;\n                  }\n                  if (trial.dataLayerCreditsRemainingKey) {\n                    target[trial.dataLayerCreditsRemainingKey] = trial.remainingCredits;\n                  }\n                }\n              });\n              (window.Zephr.accessDetails.trialTrackingDetails || []).forEach(function(details) {\n                var type = details.entitlementType === 'credits' ? 'credits' : 'meters';\n                var trial = (window.Zephr.accessDetails[type] || {})[details.entitlementId];\n                if (!trial) return;\n                if (window.Zephr.groupFields && !pageView.zephrTrials) pageView.zephrTrials = {};\n                if (details.creditsRemainingKey) {\n                  if (window.Zephr.groupFields) {\n                    pageView.zephrTrials[details.creditsRemainingKey] = trial.remainingCredits;\n                  } else {\n                    pageView[details.creditsRemainingKey] = trial.remainingCredits;\n                  }\n                }\n                if (details.creditsUsedKey) {\n                  if (window.Zephr.groupFields) {\n                    pageView.zephrTrials[details.creditsUsedKey] = trial.totalCredits - trial.remainingCredits;\n                  } else {\n                    pageView[details.creditsUsedKey] = trial.totalCredits - trial.remainingCredits;\n                  }\n                }\n              });\n            }\n            if (Object.keys(pageView).length) {\n              pageView.event = 'zephr-pageview';\n              events.unshift(pageView);\n            }\n            if (!events.length) continue;\n\n            events.forEach(function(event) {\n              window[dataLayerFieldName].push(event);\n            });\n          }\n          var readyEvent = document.createEvent('Event');\n          readyEvent.initEvent('zephr.dataLayerReady', true, true);\n          document.dispatchEvent(readyEvent);\n          logEvent('datalayer_populated');\n        }\n      }\n    };\n    xhr.send({});\n  };\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"/*global zephr_nbc, zephrBrowser, __CNBC_META_DATA, BI, $t, */\n(function() {\n  window.zephr_nbc = window.zephr_nbc || {};\n\n  // Gets an object whose entries are cookie values\n  function getCookies(names = []) {\n    function matches(e) {\n      return names.filter(n => e.startsWith(`${n}=`)).length;\n    }\n\n    var entries = document.cookie\n      .split(';')\n      .map(entry => entry.trim())\n      .filter(matches)\n      .map(entry => entry.split('='));\n\n    return Object.fromEntries(entries);\n  }\n\n\n\n  // Polls the user-related cookies and objects on the page\n  // to try to find a JSON Web Token. Passes the JWT string\n  // or `null` into the given callback.\n  function getUserJWT({ logEvent } = {}) {\n    return new Promise((resolve) => {\n      var maybeLogEvent  = logEvent ? logEvent : Function.prototype;\n      var { userEmail, userSession } = getCookies(['userEmail', 'userSession']);\n\n      if (!userEmail && !userSession) {\n        maybeLogEvent('JWT Not Found - No User Cookies Available');\n        return resolve(null);\n      }\n\n      // Configuring polling settings and state\n      var pollTimeLimit = 5000;\n      var pollFrequency = 500;\n      var pollCount = 0;\n\n\n      var pollUserChanges =  setInterval(function() {\n        pollCount += 1;\n\n        // Assuming that a JWT will not become\n        // available if the time limit is exceeded.\n        if (pollCount * pollFrequency >= pollTimeLimit) {\n          maybeLogEvent('JWT Not Found - Time Limit Exceeded');\n          clearInterval(pollUserChanges);\n          return resolve(null);\n        }\n\n        var { userEmail, userSession } = getCookies(['userEmail', 'userSession']);\n\n        // If the cookies have been deleted, it means\n        // that the user is not signed in, and no JWT\n        // will become available.\n        if (!userEmail && !userSession) {\n          maybeLogEvent('JWT Not Found - User Cookies Deleted');\n          clearInterval(pollUserChanges);\n          return resolve(null);\n        }\n\n        var user = __CNBC_META_DATA.user;\n\n        // 'Returning' the JWT if it is available.\n        if (user && user.dsToken) {\n          maybeLogEvent(`JWT Found - ${user.dsToken}`);\n          clearInterval(pollUserChanges);\n          return resolve(user.dsToken);\n        }\n\n      }, pollFrequency);\n    });\n  }\n\n  function getCDP({ logEvent, timeLimit = 7000 }) {\n    return new Promise(function(resolve) {\n      let didTimeout = false;\n\n      let timeout = setTimeout(function() {\n        didTimeout = true;\n        logEvent('CDP Time Limit Exceeded');\n        resolve(undefined);\n      }, timeLimit);\n\n      BI.waitForObjAvailable(['__CNBC_META_DATA.cdp'], 50, function() {\n        if (didTimeout) return;\n\n        logEvent('CDP Available', __CNBC_META_DATA.cdp);\n        clearTimeout(timeout);\n        resolve(__CNBC_META_DATA.cdp);\n      });\n    });\n  }\n\n  function getOutcomeHistory({ logEvent = Function.prototype }) {\n    try {\n      let outcomeHistory = localStorage.getItem('zephrOutcomeHistory') || '[]';\n      return JSON.parse(outcomeHistory);\n    } catch (error) {\n      logEvent('Error with `outcomeHistory`:', error);\n      return [];\n    }\n  }\n\n  zephr_nbc.loadZephrBrowserSDK = function({ logEvent = Function.prototype }) {\n    var head = document.getElementsByTagName('head')[0];\n    var script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = 'https://assets.zephr.com/zephr-browser/1.6.2/zephr-browser.umd.js';\n    head.appendChild(script);\n\n    function privacyCategoryIsEnabled({ category = 4, timeLimit = 5000 }) {\n      return new Promise((resolve) => {\n        let timer = setTimeout(function() {\n          logEvent(`Privacy Category ${category} - Disabled`);\n          resolve(false);\n        }, timeLimit);\n\n        BI.wrapWithOneTrust({ categories: [category], fn: function() {\n          clearTimeout(timer);\n          logEvent(`Privacy Category ${category} - Enabled`);\n          resolve(true);\n        }});\n      });\n    }\n\n    BI.waitForObjAvailable(['zephrBrowser', '__CNBC_META_DATA'], 40, function () {\n      logEvent('zephrBrowser available');\n\n      // Cloning metadata\n      var customData = JSON.parse(JSON.stringify(__CNBC_META_DATA));\n\n      // TODO this data was added originally as\n      // part of a spike, but may not be necessary.\n      if (window.BI) {\n        customData.fullname = window.BI.userInfo.get('fullName');\n      }\n\n      let promises = [\n        privacyCategoryIsEnabled({ category: 4 }),\n        privacyCategoryIsEnabled({ category: 7 }),\n        getUserJWT({ logEvent }),\n        getCDP({ logEvent }),\n        getOutcomeHistory({ logEvent }),\n      ];\n\n\n      Promise.all(promises).then(([privacyCat4Enabled, privacyCat7Enabled, jwt, cdp, outcomeHistory]) => {\n        customData = { ...customData, privacyCat4Enabled, privacyCat7Enabled, cdp, outcomeHistory };\n        zephrBrowser.run({ jwt, customData });\n        logEvent('zephrBrowser initialized:', { jwt, customData });\n      });\n\n\n      // Re-initializing ZephrBrowser if the user signs in\n      $t('on', 'bte_event', function(e, data) {\n        if (data.eventName == 'authflow') {\n          let analyticId = data?.data?.dataset?.analyticId ?? '';\n          let isSignIn = analyticId.startsWith('SignIn:Success:');\n          let isLogOut = analyticId.startsWith('Logout:Success:');\n          let isAccountCreation = analyticId.startsWith('CreateAccount:Success:');\n          let isSubscription = analyticId.startsWith('Subscription:Success:');\n          let flags = { isSignIn, isLogOut, isAccountCreation, isSubscription };\n          logEvent('BTE authflow', { analyticId, ...flags });\n\n          if (isSignIn ||  isLogOut || isAccountCreation || isSubscription) {\n            let promises = [\n              privacyCategoryIsEnabled({ category: 4 }),\n              privacyCategoryIsEnabled({ category: 7 }),\n              getUserJWT({ logEvent }),\n              getCDP({ logEvent }),\n              getOutcomeHistory({ logEvent }),\n            ];\n\n            Promise.all(promises).then(([privacyCat4Enabled, privacyCat7Enabled, jwt, cdp, outcomeHistory]) => {\n              customData = { ...customData, privacyCat4Enabled, privacyCat7Enabled, cdp, outcomeHistory };\n              zephrBrowser.run({ jwt, customData });\n              logEvent('zephrBrowser re-initialized:', { jwt, customData, ...flags });\n            });\n          }\n        }\n      });\n\n    });\n  };\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,
source:"/*global zephr_nbc, BI */\n(function() {\n  var logEvent = window.BI && BI.console && BI.console.build && BI.console.build('zephr') || Function.prototype;\n\n  // Sets up a dedicated global array that emits events\n  // when Zephr scripts push items into it\n  function setupDataLayer() {\n    window.$t.register('zephr_datalayer_push');\n    window.zephrDataLayer = window.zephrDataLayer || [];\n    let zdl = window.zephrDataLayer;\n\n    // Detaching the push function so it can be overwritten\n    let innerPush = zdl.push.bind(zdl);\n\n    // Replacing the push function with\n    // one that includes observability\n    zdl.push = function (...args) {\n      logEvent('datalayer_push', args);\n      window.$t('track', 'zephr_datalayer_push', { args });\n      innerPush(...args);\n    };\n  }\n\n  function setupZephrIntegration() {\n    var loadZephrDataLayerSDK = window.zephr_nbc\n      && zephr_nbc.loadZephrDataLayerSDK\n      || Function.prototype;\n\n    var loadZephrBrowserSDK = window.zephr_nbc\n      && zephr_nbc.loadZephrBrowserSDK\n      || Function.prototype;\n\n    setupDataLayer();\n    loadZephrDataLayerSDK({ logEvent });\n    loadZephrBrowserSDK({ logEvent });\n  }\n\n  setupZephrIntegration();\n})();\n\n\n",language:"javascript"},timeout:2e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"/*global $t, s, BI */\n(function() {\n  // forwarding zephr datalayer activity to adobe analytics\n  $t('on', 'zephr.datalayer_push', function (e, data) {\n    let contextData = { 'zephr:args': JSON.stringify(data) };\n    trackAdobeEvent('zephr.datalayer_push', contextData);\n  });\n\n  function trackAdobeEvent(situationName, newContextData) {\n    BI.waitForObjAvailable(['s', 's.tl'], 50, function () {\n      s.contextData = { ...s.contextData, ...newContextData };\n      s.tl(true, 'o', situationName);\n\n      for (var item in newContextData) {\n        delete s.contextData[item];\n      }\n    });\n  }\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLc622c6e6509f4d95b572ec67cfa3dc33",name:"50 - Action - Authentication [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"/* globals BI, __CNBC_META_DATA */\n(function () {\n  const pixelConfig = {\n    urlCondition: new RegExp(/^\\/investingclub\\/subscribe|\\/application\\/pro/),\n    snowplow: {\n      baseURL: 'https://px.tvadsync.com/com.snowplowanalytics.iglu/v1',\n      staticParams: {\n        schema: 'iglu:com.tvadsync.poc/ad_impression/jsonschema/1-2-3', // snowplow custom event schema\n      },\n      trackingIds: {\n        PRO: 'CNBC Pro Landing Page',\n        INVESTINGCLUB: 'CNBC Investing Club Landing Page',\n      },\n    },\n    theTradeDesk: {\n      baseURL: 'https://insight.adsrvr.org/track/pxl/',\n      staticParams: {\n        adv: 'pifj9u7', // the trade desk advertiser id\n        fmt: '3', // the trade desk pixel format\n      },\n      trackingIds: {\n        PRO: 'X8bgil0',\n        INVESTINGCLUB: 'O1qpe2f',\n      },\n    },\n  };\n\n  BI.wrapWithOneTrust({\n    fn: trackPageView,\n    featureName: 'TVAdSync Pageview Pixel',\n    categories: [4,7],\n  });\n\n  function trackPageView() {\n    if (!pixelConfig.urlCondition.test(location.pathname)) return;\n\n    BI.waitForObjAvailable(['__CNBC_META_DATA'], 50, () => {\n      const { tagName } = __CNBC_META_DATA;\n      const product = tagName.replace(/marketing/gi, '').toUpperCase();\n      const contextData = {\n        flow: 'Landing Page',\n        product,\n        snowplowId: pixelConfig['snowplow'].trackingIds[product] ?? null,\n        theTradeDeskId: pixelConfig['theTradeDesk'].trackingIds[product] ?? null,\n      };\n\n      // Snowplow pixel\n      if (contextData.snowplowId) {\n        const addParams = new URLSearchParams({\n          ...pixelConfig['snowplow'].staticParams,\n          aid: contextData.snowplowId, // snowplow app id\n        });\n\n        const pixelUrl = new URL(`?${addParams.toString()}`, pixelConfig['snowplow'].baseURL);\n        addPixel(pixelUrl.toString(), 'snowplow', [{ name: 'alt', value: '' }]);\n      }\n\n      // The Trade Desk pixel\n      if (contextData.theTradeDeskId) {\n        const addParams = new URLSearchParams({\n          ...pixelConfig['theTradeDesk'].staticParams,\n          ct: `0:${contextData.theTradeDeskId}`, // trade desk pixel tracking tag id\n        });\n\n        const pixelUrl = new URL(`?${addParams.toString()}`, pixelConfig['theTradeDesk'].baseURL);\n        addPixel(pixelUrl.toString(), 'the-trade-desk');\n      }\n    });\n  }\n\n  const addPixel = (src, name, addtlAttrs = []) => {\n    var img = document.createElement('img');\n    img.setAttribute('style', 'border-style:none;');\n    img.setAttribute('height', '1');\n    img.setAttribute('width', '1');\n    img.setAttribute('src', src);\n    img.setAttribute('name', name+'-pixeltag');\n    addtlAttrs.forEach(({ name, value }) => img.setAttribute(name, value));\n    document.body.appendChild(img);\n  };\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"/* globals BI, $t */\n(function () {\n  const pixelConfig = {\n    snowplow: {\n      baseURL: 'https://px.tvadsync.com/com.snowplowanalytics.iglu/v1',\n      staticParams: {\n        schema: 'iglu:com.tvadsync.poc/ad_impression/jsonschema/1-2-3', // snowplow custom event schema\n      },\n      trackingIds: {\n        Success: {\n          PRO: 'CNBC Pro Continue Page',\n          INVESTINGCLUB: 'CNBC Investing Club Continue Page',\n        },\n        BillingComplete: {\n          PRO: 'CNBC Pro CreditCardForm Page',\n          INVESTINGCLUB: 'CNBC Investing Club CreditCardForm Page',\n        },\n        PaymentConfirmed: {\n          PRO: 'CNBC Pro Success Page',\n          INVESTINGCLUB: 'CNBC Investing Club Success Page',\n        },\n      },\n    },\n    theTradeDesk: {\n      baseURL: 'https://insight.adsrvr.org/track/pxl/',\n      staticParams: {\n        adv: 'pifj9u7', // the trade desk advertiser id\n        fmt: '3', // the trade desk pixel format\n      },\n      trackingIds: {\n        Success: {\n          PRO: 'bt04ror',\n          INVESTINGCLUB: '63msq2j',\n        },\n        BillingComplete: {\n          PRO: 'od2huzf',\n          INVESTINGCLUB: 'cziglk7',\n        },\n        PaymentConfirmed: {\n          PRO: 'qb529pa',\n          INVESTINGCLUB: 'osajmyn',\n        },\n      },\n    },\n  };\n\n  BI.wrapWithOneTrust({\n    fn: subscribe,\n    featureName: 'TVAdSync Auth Pixel',\n    categories: [4,7],\n  });\n\n  function subscribe() {\n    $t('on', 'bte_event', (e, { data, eventName }) => {\n      if (\n        eventName === 'authflow' &&\n        data.dataset?.analyticId?.startsWith('Subscription:')\n      ) {\n        const {\n          analyticId,\n          authModalType = null,\n          modalName = null,\n        } = data.dataset;\n\n        const eventData = convertEventData({\n          analyticId,\n          authModalType,\n          modalName,\n        });\n\n        // Snowplow pixel\n        if (eventData.snowplowId) {\n          const addParams = new URLSearchParams({\n            ...pixelConfig['snowplow'].staticParams,\n            aid: eventData.snowplowId, // snowplow app id\n          });\n\n          const pixelUrl = new URL(`?${addParams.toString()}`, pixelConfig['snowplow'].baseURL);\n          addPixel(pixelUrl.toString(), 'snowplow', [{ name: 'alt', value: '' }]);\n        }\n\n        // The Trade Desk pixel\n        if (eventData.theTradeDeskId) {\n          const addParams = new URLSearchParams({\n            ...pixelConfig['theTradeDesk'].staticParams,\n            ct: `0:${eventData.theTradeDeskId}`, // trade desk pixel tracking tag id\n          });\n\n          const pixelUrl = new URL(`?${addParams.toString()}`, pixelConfig['theTradeDesk'].baseURL);\n          addPixel(pixelUrl.toString(), 'the-trade-desk');\n        }\n      }\n    });\n  }\n\n  const addPixel = (src, name, addtlAttrs = []) => {\n    var img = document.createElement('img');\n    img.setAttribute('style', 'border-style:none;');\n    img.setAttribute('height', '1');\n    img.setAttribute('width', '1');\n    img.setAttribute('src', src);\n    img.setAttribute('name', name+'-pixeltag');\n    addtlAttrs.forEach(({ name, value }) => img.setAttribute(name, value));\n    document.body.appendChild(img);\n  };\n\n  function convertEventData(raw) {\n    // extract flow, action, and product from analyticId by regex named groups\n    const actionContextRegex = /(?<flow>\\w+):(?<action>\\w+):(?<product>\\w+)/;\n    const actionContextMatch = raw.analyticId.match(actionContextRegex);\n    const product = actionContextMatch.groups.product.toUpperCase();\n    // some actions are prefixed w/ product name, so we need to remove it\n    const action = actionContextMatch.groups.action.replace(new RegExp(product, 'ig'), '');\n    const eventObject = {\n      flow: actionContextMatch.groups.flow,\n      product,\n      snowplowId: pixelConfig['snowplow'].trackingIds[action]?.[product] ?? null,\n      theTradeDeskId: pixelConfig['theTradeDesk'].trackingIds[action]?.[product] ?? null,\n    };\n    return eventObject;\n  }\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLd5717be980074cc3be6c0e7710471947",name:"40 - Adobe MediaSDK [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:40}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!1,
source:'/* eslint-disable */\n/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n * Copyright 2019 Adobe\n * All Rights Reserved.\n *\n * NOTICE: All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n **************************************************************************/\n/*\n * MediaSDK - 2.2.1 - 2019-10-09\n * Copyright (c) 2019 Adobe. All Rights Reserved.\n *\n * Copyright for external libraries used in Media SDK\n * JavaScript MD5 1.0.1\n * https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * http://www.opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n *\n *\n * umdjs (commonjsStrict.js)\n * Copyright (c) the UMD contributors\n * Licensed under the MIT license:\n * https://github.com/umdjs/umd/blob/master/LICENSE.md\n */\n(function (root, factory) {\n  if (typeof define === \'function\' && define.amd) {\n    define([\'exports\'], factory);\n  } else if (typeof exports === \'object\' && typeof exports.nodeName !== \'string\') {\n    factory(exports);\n  } else {\n    factory(root.ADB = {});\n  }\n}(typeof self !== \'undefined\' ? self : this, function (exports) {\n  var lib = {};\n  (function () {\n    \n\n// Heartbeat core\n!function(a){if(void 0===b)var b={};if(void 0===c)var c={};if(void 0===d)var d={};if(d.radio||(d.radio={}),d.plugin||(d.plugin={}),void 0===e)var e={};e.clock||(e.clock={}),function(a){"use strict";function b(a,b){var c=(65535&a)+(65535&b);return(a>>16)+(b>>16)+(c>>16)<<16|65535&c}function c(a,b){return a<<b|a>>>32-b}function d(a,d,e,f,g,h){return b(c(b(b(d,a),b(f,h)),g),e)}function e(a,b,c,e,f,g,h){return d(b&c|~b&e,a,b,f,g,h)}function f(a,b,c,e,f,g,h){return d(b&e|c&~e,a,b,f,g,h)}function g(a,b,c,e,f,g,h){return d(b^c^e,a,b,f,g,h)}function h(a,b,c,e,f,g,h){return d(c^(b|~e),a,b,f,g,h)}function i(a,c){a[c>>5]|=128<<c%32,a[14+(c+64>>>9<<4)]=c;var d,i,j,k,l,m=1732584193,n=-271733879,o=-1732584194,p=271733878;for(d=0;d<a.length;d+=16)i=m,j=n,k=o,l=p,m=e(m,n,o,p,a[d],7,-680876936),p=e(p,m,n,o,a[d+1],12,-389564586),o=e(o,p,m,n,a[d+2],17,606105819),n=e(n,o,p,m,a[d+3],22,-1044525330),m=e(m,n,o,p,a[d+4],7,-176418897),p=e(p,m,n,o,a[d+5],12,1200080426),o=e(o,p,m,n,a[d+6],17,-1473231341),n=e(n,o,p,m,a[d+7],22,-45705983),m=e(m,n,o,p,a[d+8],7,1770035416),p=e(p,m,n,o,a[d+9],12,-1958414417),o=e(o,p,m,n,a[d+10],17,-42063),n=e(n,o,p,m,a[d+11],22,-1990404162),m=e(m,n,o,p,a[d+12],7,1804603682),p=e(p,m,n,o,a[d+13],12,-40341101),o=e(o,p,m,n,a[d+14],17,-1502002290),n=e(n,o,p,m,a[d+15],22,1236535329),m=f(m,n,o,p,a[d+1],5,-165796510),p=f(p,m,n,o,a[d+6],9,-1069501632),o=f(o,p,m,n,a[d+11],14,643717713),n=f(n,o,p,m,a[d],20,-373897302),m=f(m,n,o,p,a[d+5],5,-701558691),p=f(p,m,n,o,a[d+10],9,38016083),o=f(o,p,m,n,a[d+15],14,-660478335),n=f(n,o,p,m,a[d+4],20,-405537848),m=f(m,n,o,p,a[d+9],5,568446438),p=f(p,m,n,o,a[d+14],9,-1019803690),o=f(o,p,m,n,a[d+3],14,-187363961),n=f(n,o,p,m,a[d+8],20,1163531501),m=f(m,n,o,p,a[d+13],5,-1444681467),p=f(p,m,n,o,a[d+2],9,-51403784),o=f(o,p,m,n,a[d+7],14,1735328473),n=f(n,o,p,m,a[d+12],20,-1926607734),m=g(m,n,o,p,a[d+5],4,-378558),p=g(p,m,n,o,a[d+8],11,-2022574463),o=g(o,p,m,n,a[d+11],16,1839030562),n=g(n,o,p,m,a[d+14],23,-35309556),m=g(m,n,o,p,a[d+1],4,-1530992060),p=g(p,m,n,o,a[d+4],11,1272893353),o=g(o,p,m,n,a[d+7],16,-155497632),n=g(n,o,p,m,a[d+10],23,-1094730640),m=g(m,n,o,p,a[d+13],4,681279174),p=g(p,m,n,o,a[d],11,-358537222),o=g(o,p,m,n,a[d+3],16,-722521979),n=g(n,o,p,m,a[d+6],23,76029189),m=g(m,n,o,p,a[d+9],4,-640364487),p=g(p,m,n,o,a[d+12],11,-421815835),o=g(o,p,m,n,a[d+15],16,530742520),n=g(n,o,p,m,a[d+2],23,-995338651),m=h(m,n,o,p,a[d],6,-198630844),p=h(p,m,n,o,a[d+7],10,1126891415),o=h(o,p,m,n,a[d+14],15,-1416354905),n=h(n,o,p,m,a[d+5],21,-57434055),m=h(m,n,o,p,a[d+12],6,1700485571),p=h(p,m,n,o,a[d+3],10,-1894986606),o=h(o,p,m,n,a[d+10],15,-1051523),n=h(n,o,p,m,a[d+1],21,-2054922799),m=h(m,n,o,p,a[d+8],6,1873313359),p=h(p,m,n,o,a[d+15],10,-30611744),o=h(o,p,m,n,a[d+6],15,-1560198380),n=h(n,o,p,m,a[d+13],21,1309151649),m=h(m,n,o,p,a[d+4],6,-145523070),p=h(p,m,n,o,a[d+11],10,-1120210379),o=h(o,p,m,n,a[d+2],15,718787259),n=h(n,o,p,m,a[d+9],21,-343485551),m=b(m,i),n=b(n,j),o=b(o,k),p=b(p,l);return[m,n,o,p]}function j(a){var b,c="";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(a[b>>5]>>>b%32&255);return c}function k(a){var b,c=[];for(c[(a.length>>2)-1]=void 0,b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<8*a.length;b+=8)c[b>>5]|=(255&a.charCodeAt(b/8))<<b%32;return c}function l(a){return j(i(k(a),8*a.length))}function m(a,b){var c,d,e=k(a),f=[],g=[];for(f[15]=g[15]=void 0,e.length>16&&(e=i(e,8*a.length)),c=0;c<16;c+=1)f[c]=909522486^e[c],g[c]=1549556828^e[c];return d=i(f.concat(k(b)),512+8*b.length),j(i(g.concat(d),640))}function n(a){var b,c,d="0123456789abcdef",e="";for(c=0;c<a.length;c+=1)b=a.charCodeAt(c),e+=d.charAt(b>>>4&15)+d.charAt(15&b);return e}function o(a){return unescape(encodeURIComponent(a))}function p(a){return l(o(a))}function q(a){return n(p(a))}function r(a,b){return m(o(a),o(b))}function s(a,b){return n(r(a,b))}function t(a,b,c){return b?c?r(b,a):s(b,a):c?p(a):q(a)}a.md5=t}(b),function(a){"use strict";var b={};b.startsWith=function(a,b){return 0==a.indexOf(b)},a.StringUtils=b}(b),function(a){"use strict";var b={};b.clone=function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},b.merge=function(a,c){var d=b.clone(a);for(var e in c)c.hasOwnProperty(e)&&(d[e]=c[e]);return d},b.append=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},a.ObjectUtils=b}(b),function(a){"use strict";function b(a){if(null==a)return!0;for(var b=0;b<a.length;++b)if(isNaN(a[b]))return!1;return!0}function c(a,c){if("string"!=typeof a||"string"!=typeof c)return NaN;var d=a.split("."),e=c.split(".");if(!b(d)||!b(e))return NaN;for(var f=Math.max(d.length,e.length),g=0;g<f;++g){var h=void 0!=d[g]?d[g]:"0",i=void 0!=e[g]?e[g]:"0";if(h=Number(h),i=Number(i),h>i)return 1;if(h<i)return-1}return 0}var d={};d.isGreaterThan=function(a,b){return c(a,b)>0},d.isGreaterThanEqual=function(a,b){return c(a,b)>=0},d.isLessThan=function(a,b){return c(a,b)<0},d.isLessThanEqual=function(a,b){return c(a,b)<=0},d.isSame=function(a,b){return 0===c(a,b)},d.isDifferent=function(a,b){return 0!==c(a,b)},a.VersionUtils=d}(b),function(a){"use strict";function b(a,b,c){this.fn=a,this.ctx=b,this.params=c}b.prototype.run=function(){this.params?this.fn.apply(this.ctx,this.params):this.fn.apply(this.ctx)},a.radio.Command=b}(d),function(a){"use strict";function b(a,b){this._queue=[],this._lastTs=0,this._isSuspended=void 0!==a&&a,this._delay=void 0!==b?b:0}b.prototype.addCommand=function(a){this._queue.push(a),this._drain()},b.prototype.cancelAllCommands=function(){this._queue=[]},b.prototype.isEmpty=function(){return 0===this._queue.length},b.prototype.suspend=function(){this._isSuspended=!0},b.prototype.resume=function(){this._isSuspended=!1,this._drain()},b.prototype.flush=function(){this._isSuspended=!1;for(var a=0;a<this._queue.length;a++){this._queue[a].run()}this._queue=[]},b.prototype._drain=function(){if(!this._isSuspended&&!this._drainInProgress){this._drainInProgress=!0;var a=this;!function b(){var c=a._queue.shift();c?a._runCommand(c,function(){a._isSuspended||b()}):a._drainInProgress=!1}()}},b.prototype._runCommand=function(a,b){function c(){a.run(),null!=b&&b.call(d)}var d=this;if(0==this._lastTs)c();else{var e=(new Date).getTime(),f=e-this._lastTs;this._lastTs=e,f<this._delay?setTimeout(c,this._delay-f):c()}},a.radio.CommandQueue=b}(d),function(a){"use strict";function b(a,b){if(this._name=a,!b)throw new Error("Reference to the logger object cannot be NULL");this._logger=b,this._listeners={},this._requests={},this._commands={},this._isShutDown=!1}function c(a,c){if(a===c)return!0;for(var d=(a||"").split(b.SEPARATOR),e=(c||"").split(b.SEPARATOR),f=!0,g=0;g<d.length;g++)f=f&&(d[g]===b.WILDCARD||d[g]===e[g]);return f}b.WILDCARD="*",b.SEPARATOR=":",b.prototype.toString=function(){return"<channel: "+this._name+">"},b.prototype.shutdown=function(){this._isShutDown||(this._logger.debug(d,"#shutdown > Shutting down"),this.off(),this._requests={},this._commands={},this._isShutDown=!0)},b.prototype.on=function(a,b,c){this._isShutDown||(this._listeners[a]||(this._listeners[a]=[]),this._listeners[a].push({fn:b,ctx:c}))},b.prototype.off=function(a,b,c){if(!this._isShutDown){if(b="function"==typeof b?b:null,!a&&null==b&&!c)return void(this._listeners={});if(a)this._removeListener(a,b,c);else for(a in this._listeners)this._listeners.hasOwnProperty(a)&&this._removeListener(a,b,c)}},b.prototype.trigger=function(a){if(!this._isShutDown)for(var b in this._listeners)if(this._listeners.hasOwnProperty(b)&&c(b,a.name))for(var d=this._listeners[b].slice(0),e=0;e<d.length;e++){var f=d[e];f.fn.call(f.ctx,a)}},b.prototype.comply=function(a,b,c){this._isShutDown||(this._commands[a]={cmd:b,ctx:c})},b.prototype.command=function(a,b){if(!this._isShutDown){var c=this._commands[a];if(!c)return void this._logger.warn(d,"#command > No command handler for: "+a);c.cmd.call(c.ctx,b)}},b.prototype.reply=function(a,b,c){this._isShutDown||(this._requests[a]={fn:b,ctx:c})},b.prototype.request=function(a){if(!this._isShutDown){var b=this._requests[a];return b?b.fn.call(b.ctx):(this._logger.warn(d,"#request > No request handler for: "+a),null)}},b.prototype._removeListener=function(a,b,c){b="function"==typeof b?b:null;var d=this._listeners[a];if(d){if(!d.length||null==b&&!c)return void delete this._listeners[a];for(var e=0;e<d.length;e++){var f=d[e];null!==b&&b!==f.fn||c&&c!==f.ctx||this._listeners[a].splice(e,1)}}};var d="radio::Channel";a.radio.Channel=b}(d),function(a){"use strict";function b(a){if(!a)throw new Error("Reference to the logger object cannot be NULL");this._logger=a,this._channels={}}var c=a.radio.Channel;b.prototype.channel=function(a){return this._channels[a]||(this._channels[a]=new c(a,this._logger)),this._channels[a]},b.prototype.shutdown=function(){for(var a in this._channels)this._channels.hasOwnProperty(a)&&this._channels[a].shutdown()},a.radio.Radio=b}(d),function(a){"use strict";function b(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a}a.extend=b}(d),function(a){"use strict";function b(){}b.prototype.write=function(a){throw new Error("Implementation error: Method must be overridden.")},a.ILogWriter=b}(d),function(a){"use strict";function b(){}b.prototype.write=function(a){window.console&&window.console.log&&window.console.log(a)},a.LogWriter=b}(d),function(a){"use strict";function b(){}b.prototype.setLogWriter=function(a){throw new Error("Implementation error: Method must be overridden.")},b.prototype.getLogWriter=function(){throw new Error("Implementation error: Method must be overridden.")},b.prototype.getEnabled=function(){throw new Error("Implementation error: Method must be overridden.")},b.prototype.enable=function(){throw new Error("Implementation error: Method must be overridden.")},b.prototype.disable=function(){throw new Error("Implementation error: Method must be overridden.")},b.prototype.debug=function(a,b){throw new Error("Implementation error: Method must be overridden.")},b.prototype.info=function(a,b){throw new Error("Implementation error: Method must be overridden.")},b.prototype.warn=function(a,b){throw new Error("Implementation error: Method must be overridden.")},b.prototype.error=function(a,b){throw new Error("Implementation error: Method must be overridden.")},a.ILogger=b}(d),function(a){"use strict";function b(){this._logWriter=new d}function c(a){return a<10?"00"+a:a<100?"0"+a:""+a}var d=a.LogWriter;b.prototype.setLogWriter=function(a){if(!a)throw new Error("Reference to the ILogWriter object cannot be NULL");this._logWriter=a,this._enabled=!1},b.prototype.getLogWriter=function(){return this._logWriter},b.prototype.getEnabled=function(){return this._enabled},b.prototype.enable=function(){this._enabled=!0},b.prototype.disable=function(){this._enabled=!1},b.prototype.debug=function(a,b){this._log(a,f,b)},b.prototype.info=function(a,b){this._log(a,e,b)},b.prototype.warn=function(a,b){this._log(a,g,b)},b.prototype.error=function(a,b){this._log(a,h,b)},b.prototype._log=function(a,b,d){if(b==h||this._enabled){var e="",f=new Date;e+="["+f.toTimeString()+"."+c(f.getMilliseconds())+"] ["+b+"] ",e+="["+a+"] "+d,this._logWriter.write(e)}};var e="INFO",f="DEBUG",g="WARN",h="ERROR";a.Logger=b}(d),function(a){"use strict";function b(a,b){this._pluginName=a,this._eventName=b}var c=a.radio.Channel;b.prototype.getPluginName=function(){return this._pluginName},b.prototype.getEventName=function(){return this._eventName},b.prototype.getName=function(){return this._pluginName+c.SEPARATOR+this._eventName},a.Trigger=b}(d),function(a){"use strict";function b(a,b){this.name=a,this.data=b}b.SUCCESS="success",b.ERROR="error",b.createFromTrigger=function(a){return new b(a.getName())},a.Event=b}(d),function(a){"use strict";function b(){this._events={}}b.prototype.addEventListener=function(a,b,c){a&&b&&(c=c||window,this._events[a]=this._events[a]||[],this._events[a].push({cb:b,ctx:c}))},b.prototype.removeEventListener=function(a,b,c){if(a&&b){c=c||window;var d,e,f=!1;for(e in this._events)if(a===e){f=!0;break}if(f){for(d=this._events[e].length-1;d>=0;d--){var g=this._events[e][d];b===g.cb&&c===g.ctx&&this._events[e].splice(d,1)}this._events[e].length||delete this._events[e]}}},b.prototype.dispatchEvent=function(a){if(a.name){var b,c;for(b in this._events)if(this._events.hasOwnProperty(b)&&a.name===b){var d=this._events[b],e=d.slice(0),f=e.length;for(c=0;c<f;c++)e[c].cb.call(e[c].ctx,a);break}}},b.prototype.removeAllListeners=function(a){if(a){var b,c;for(c in this._events)if(this._events.hasOwnProperty(c)){for(b=this._events[c].length-1;b>=0;b--){var d=this._events[c][b];d.ctx===a&&this._events[c].splice(b,1)}this._events[c].length||delete this._events[c]}}else this._events={}},a.EventDispatcher=b}(d),function(a){"use strict";function b(){}function c(a,b){this.url=a||null,this.method=b,this._xmlhttp=null}function d(){d.__super__.constructor.call(this),this._connection=null}var e=a.Event,f=a.EventDispatcher;b.GET="GET",d.RESPONSE="response",d.INSTANCE="instance",a.extend(d,f),d.prototype.close=function(){this.removeAllListeners(null)},d.prototype.load=function(a){a&&a.method&&a.url&&(a._xmlhttp=this._createCORSRequest(a),a._xmlhttp?a._xmlhttp.send():this._loadImage(a))},d.prototype._createCORSRequest=function(a){var b=null;if(void 0!==window.XMLHttpRequest){var c=new window.XMLHttpRequest;"withCredentials"in c&&(b=c,b.open(a.method,a.url,!0))}if(null==b&&void 0!==window.XDomainRequest&&(b=new window.XDomainRequest,b.open(a.method,a.url)),b){var f={};f[d.INSTANCE]=this;var g=this;b.onload=function(){if(b.status&&parseInt(b.status,10)>=400)return this.onerror();f[d.RESPONSE]=b.responseText,g.dispatchEvent(new e(e.SUCCESS,f))},b.onerror=function(){g.dispatchEvent(new e(e.ERROR,f))}}return b},d.prototype._loadImage=function(a){this._connection||(this._connection=new Image,this._connection.alt=""),this._connection.src=a.url;var b={};b[d.RESPONSE]="",b[d.INSTANCE]=this,this.dispatchEvent(new e(e.SUCCESS,b))},a.URLRequestMethod=b,a.URLRequest=c,a.URLLoader=d}(d),function(a){"use strict";var b="2.2.1.229",c="1bf77a",d={};d.getVersion=function(){return"js-"+b+"-"+c},d.getMajor=function(){return d.getNumberAtPosition(0)},d.getMinor=function(){return d.getNumberAtPosition(1)},d.getMicro=function(){return d.getNumberAtPosition(2)},d.getPatch=function(){return d.getNumberAtPosition(3)},d.getBuild=function(){return c},d.getApiLevel=function(){return 4},d.getNumberAtPosition=function(a){return b.split(".")[a]},a.Version=d}(c),function(a){"use strict";function b(a,b){this._message=a,this._details=b}b.prototype.getMessage=function(){return this._message},b.prototype.getDetails=function(){return this._details},a.ErrorInfo=b}(c),function(a){"use strict";function b(){this.debugLogging=!1}a.HeartbeatConfig=b}(c),function(a){"use strict";function b(){}b.prototype.onError=function(a){},a.HeartbeatDelegate=b}(c),function(a){"use strict";function b(){}b.prototype.configure=function(a){throw new Error("Implementation error: Method must be overridden.")},b.prototype.bootstrap=function(a){throw new Error("Implementation error: Method must be overridden.")},b.prototype.setup=function(){throw new Error("Implementation error: Method must be overridden.")},b.prototype.destroy=function(){throw new Error("Implementation error: Method must be overridden.")},b.prototype.enable=function(){throw new Error("Implementation error: Method must be overridden.")},b.prototype.disable=function(){throw new Error("Implementation error: Method must be overridden.")},b.prototype.getName=function(){throw new Error("Implementation error: Method must be overridden.")},b.prototype.isInitialized=function(){throw new Error("Implementation error: Method must be overridden.")},b.prototype.resolveData=function(a){throw new Error("Implementation error: Method must be overridden.")},a.plugin.IPlugin=b}(d),function(a){"use strict";function b(a,b,c,d){this.trigger=a,this.action=c,this.plugin=b,this._paramMappings={},this.mergeParams(d)}var c=a.plugin.ParamMapping;b.prototype.mergeParams=function(a){if(a)for(var b=0;b<a.length;b++){var c=a[b];this._paramMappings[c.getKeyName()]=c}},b.prototype.getParams=function(){var a=[];for(var b in this._paramMappings)this._paramMappings.hasOwnProperty(b)&&a.push(this._paramMappings[b]);return a},b.prototype.addParam=function(a){this._paramMappings[a.getKeyName()]=a},b.prototype.removeParam=function(a,b){var d=new c(a,b);this._paramMappings.hasOwnProperty(d.getKeyName())&&delete this._paramMappings[d.getKeyName()]},a.plugin.Behaviour=b}(d),function(a){"use strict";function b(a,b,d){this._pluginName=a,this._key=b,this._paramName=d||a+c.SEPARATOR+b}var c=a.radio.Channel;b.prototype.getPluginName=function(){return this._pluginName},b.prototype.getKey=function(){return this._key},b.prototype.getKeyName=function(){return this._pluginName+c.SEPARATOR+this._key},b.prototype.getParamName=function(){return this._paramName},a.plugin.ParamMapping=b}(d),function(a){"use strict";function b(a){if(!a)throw new Error("Reference to the logger object cannot be NULL");this._logger=a,this._plugins={},this._behaviours={},this._radio=new d(this._logger),this._dataChannel=this._radio.channel(g),this._ctrlChannel=this._radio.channel(h)}var c=a.Event,d=a.radio.Radio,e=a.radio.Channel,f=a.plugin.Behaviour;b.ERROR="error",b.prototype.addPlugin=function(a){var b=a.getName();this._plugins[b]&&this._logger.warn(i,"#addPlugin > Replacing plugin: "+b),this._plugins[b]=a,a.bootstrap(this)},b.prototype.setupPlugins=function(){for(var a in this._plugins)this._plugins.hasOwnProperty(a)&&this._plugins[a].setup()},b.prototype.pluginExists=function(a){return!!this._plugins[a]},b.prototype.isPluginInitialized=function(a){return this._plugins[a]&&this._plugins[a].isInitialized()},b.prototype.on=function(a,b,c,d){this._dataChannel.on(a+e.SEPARATOR+b,c,d)},b.prototype.off=function(a,b,c,d){var f=a&&b?a+e.SEPARATOR+b:null;this._dataChannel.off(f,c,d)},b.prototype.trigger=function(a){var b=a.name,c=this._behaviours[b];if(c){var d,e,f,g,h,i={},j={};for(d=0;d<c.length;d++)if(f=c[d],g=f.getParams())for(e=0;e<g.length;e++)h=g[e],i[h.getPluginName()]=i[h.getPluginName()]||[],h.key in i[h.getPluginName()]||i[h.getPluginName()].push(h.getKey());for(var k in i)i.hasOwnProperty(k)&&(j[k]=this.request(k,i[k]));for(d=0;d<c.length;d++){f=c[d];var l={_behaviour:f,_eventData:a.data||{}};if(g=f.getParams()){for(e=0;e<g.length;e++)h=g[e],l[h.getParamName()]=j[h.getPluginName()]?j[h.getPluginName()][h.getKey()]:null;this.command(f.plugin.getName(),f.action,l)}}}this._dataChannel.trigger(a)},b.prototype.request=function(a,b){var c=this._plugins[a];return c&&b&&0!=b.length?c.resolveData(b):null},b.prototype.raise=function(a){this._errorInfo=a;var d=new c(b.ERROR,a);this._ctrlChannel.trigger(d)},b.prototype.getErrorInfo=function(){return this._errorInfo},b.prototype.destroy=function(){this._radio.shutdown();for(var a in this._plugins)this._plugins.hasOwnProperty(a)&&this._plugins[a].destroy()},b.prototype.comply=function(a,b,c){this._dataChannel.comply(a.getName()+e.SEPARATOR+b,c,a)},b.prototype.command=function(a,b,c){this._dataChannel.command(a+e.SEPARATOR+b,c)},b.prototype.registerBehaviour=function(a,b,c,d){var e=a.getName(),g=new f(a,b,c,d);this._behaviours[e]=this._behaviours[e]||[],this._behaviours[e].push(g)};var g="data_channel",h="ctrl_channel",i="plugin::PluginManager";a.plugin.PluginManager=b}(d),function(a,b){"use strict";function c(a){this._name=a,this._isInitialized=!1,this._isDestroyed=!1,this._isEnabled=!0,this._dataResolver={},this._logTag="plugin::"+this.getName(),this._logger=new d}var d=a.Logger,e=a.Trigger,f=a.Event,g=b.ErrorInfo;c.INITIALIZED="initialized",c.prototype.configure=function(a){},c.prototype.bootstrap=function(a){this._pluginManager=a,this._isDestroyed&&this._pluginManager.raise(new g("Invalid state.","Plugin already destroyed."))},c.prototype.setup=function(){this._trigger(c.INITIALIZED),this._isInitialized=!0},c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this._teardown())},c.prototype.enable=function(){this._isEnabled=!0,this._enabled()},c.prototype.disable=function(){this._isEnabled=!1,this._disabled()},c.prototype.getName=function(){return this._name},c.prototype.getLogger=function(){return this._logger},c.prototype.isInitialized=function(){return this._isInitialized},c.prototype.resolveData=function(a){if(!this._isEnabled||!this._isInitialized)return this._logger.warn(this._logTag,"Unable to retrieve plugin data. Plugin: "+this._name+". Enabled: "+this._isEnabled+". Initialized: "+this._isInitialized+"."),null;if("function"==typeof this._dataResolver)return this._dataResolver.call(this,a);var b=null;if(a)for(var c=0;c<a.length;c++){var d=a[c];this._dataResolver.hasOwnProperty(d)&&(b=b||{},"function"==typeof this._dataResolver[d]?b[d]=this._dataResolver[d].call(this):b[d]=this._dataResolver[d])}return b},c.prototype.toString=function(){return"<plugin: "+this._name+">"},c.prototype._enabled=function(){},c.prototype._disabled=function(){},c.prototype._teardown=function(){},c.prototype._canProcess=function(){return this._isEnabled?!this._isDestroyed||(this._logger.error(this._logTag,"Plugin destroyed."),!1):(this._logger.error(this._logTag,"Plugin disabled."),!1)},c.prototype._trigger=function(a,b){var c=f.createFromTrigger(new e(this.getName(),a));c.data=b,this._pluginManager.trigger(c)},a.plugin.BasePlugin=c}(d,c),function(a){"use strict";function b(a,b,c){this.name=a,this.interval=b,this.isActive=!1,this.repeatCount=void 0!==c?c:e,this._nextTickTimestamp=0,this.reset()}function c(a,b){if(!a)throw new Error("Reference to the ClockService object cannot be NULL");if(this._service=a,!b)throw new Error("Reference to the logger object cannot be NULL");this._logger=b,this._isDestroyed=!1,this._timers={};var c=this;this._clock=window.setInterval(function(){c._onTick()},1e3*f)}b.prototype.reset=function(){this.tick=0,this._createdTimestamp=(new Date).getTime(),this._updateNextTickTimestamp()},b.prototype.shouldTick=function(){return(new Date).getTime()>this._nextTickTimestamp-g/2&&(this.tick++,this._updateNextTickTimestamp(),!0)},b.prototype._updateNextTickTimestamp=function(){var a=(new Date).getTime();this._nextTickTimestamp=a+1e3*this.interval-1},c.prototype.createTimer=function(a,c,d){this._timers[a]=new b(a,c,d)},c.prototype.destroyTimer=function(a){delete this._timers[a]},c.prototype.resumeTimer=function(a,b){b=void 0!==b&&b,this._logger.debug(d,"#resumeTimer(name="+a+", reset="+b+")");var c=this._timers[a];c&&(c.isActive=!0,b&&c.reset())},c.prototype.pauseTimer=function(a,b){b=void 0!==b&&b,this._logger.debug(d,"#pauseTimer(name="+a+", reset="+b+")");var c=this._timers[a];c&&(c.isActive=!1,b&&c.reset())},c.prototype.isTimerPaused=function(a){var b=this._timers[a];return!!b&&!b.isActive},c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this._timers={},window.clearInterval(this._clock))},c.prototype._onTick=function(){for(var a in this._timers)if(this._timers.hasOwnProperty(a)){var b=this._timers[a];b.isActive&&b.shouldTick()&&(b.interval>1&&this._logger.debug(d,"#_onTick() > "+b.name+"("+b.tick+" | "+b.repeatCount+")"),0!=b.repeatCount?(this._service.onTick(b.name,b.interval,b.tick),b.repeatCount!=e&&b.repeatCount--):this.destroyTimer(b.name))}};var d="service.clock::TimerManager",e=-1,f=.25,g=1e3*f;a.clock.TimerDescriptor=b,a.clock.TimerManager=c}(e),function(a,b,c){"use strict";function d(a){if(d.__super__.constructor.call(this,h),!a)throw new Error("Reference to the logger object cannot be NULL");this._logger=a,this._timerManager=new e(this,this._logger),this._setupDataResolver()}var e=c.clock.TimerManager,f=b.StringUtils,g=a.plugin.BasePlugin;a.extend(d,g),d.prototype.bootstrap=function(a){d.__super__.bootstrap.call(this,a),this._pluginManager.comply(this,i,this._cmdCreate),this._pluginManager.comply(this,k,this._cmdResume),this._pluginManager.comply(this,j,this._cmdPause),this._pluginManager.comply(this,l,this._cmdDestroy)},d.prototype._teardown=function(){this._timerManager.destroy()},d.prototype._cmdCreate=function(a){var b=a[o]||s;this._timerManager.createTimer(a[m],a[n],b)},d.prototype._cmdPause=function(a){this._timerManager.pauseTimer(a[m],!!a[q])},d.prototype._cmdResume=function(a){this._timerManager.resumeTimer(a[m],!!a[q])},d.prototype._cmdDestroy=function(a){this._timerManager.destroyTimer(a[m])},d.prototype.onTick=function(a,b,c){a+=".tick";var d={};d[m]=a,d[n]=b,d[p]=c,this._trigger(a,d)},d.prototype._setupDataResolver=function(){var a={},b=this._timerManager;a[r]=function(a){return b.isTimerPaused(a)},this._dataResolver=function(b){if(!b||0==b.length)return null;for(var c=null,d=0;d<b.length;d++){var e=b[d];if(c=c||{},f.startsWith(e,r)){var g=e.split(r+".");g.length>0&&(c[e]=a[r].call(this,g[1]))}}return c}};var h="service.clock",i="create",j="pause",k="resume",l="destroy",m="name",n="interval",o="repeat_count",p="tick",q="reset",r="is_paused",s=-1;c.clock.ClockService=d}(d,b,e),function(a,b,c){"use strict";function d(a,b){if(this._logger=new e,this._pluginManager=new f(this._logger),this._pluginManager.addPlugin(new g(this._logger)),b)for(var c=0;c<b.length;c++)this._pluginManager.addPlugin(b[c]);this._pluginManager.setupPlugins(),this._isDestroyed=!1}var e=a.Logger,f=a.plugin.PluginManager,g=b.clock.ClockService;d.prototype.configure=function(a){if(!a)throw new Error("Configuration object cannot be NULL.");a.debugLogging?this._logger.enable():this._logger.disable(),this._isDestroyed&&this._logger.error(h,"Instance is destroyed.")},d.prototype.destroy=function(){this._isDestroyed||(this._pluginManager.destroy(),this._isDestroyed=!0)};var h="Heartbeat";c.Heartbeat=d}(d,e,c),a.ADB||(a.ADB={}),a.ADB.core||(a.ADB.core=d),a.ADB.va||(a.ADB.va=c),a.ADB.va.utils||(a.ADB.va.utils=b),a.ADB.va.plugins||(a.ADB.va.plugins={})}(this);\n\n// VideoPlayerPlugin\n!function(a){if(void 0===b)var b={};!function(a){"use strict";var b={};b.ASSET_TYPE_VOD="vod",b.ASSET_TYPE_LIVE="live",b.ASSET_TYPE_LINEAR="linear",a.AssetType=b}(b),function(a){"use strict";function b(){this.playerName=null,this.name=null,this.position=null,this.startTime=null}b.prototype.toString=function(){return"playerName="+this.playerName+", name="+this.name+", position="+this.position+", startTime="+this.startTime},a.AdBreakInfo=b}(b),function(a){"use strict";function b(){this.id=null,this.name=null,this.length=null,this.position=null,this.granularTracking=!0}b.prototype.toString=function(){return"id="+this.id+", name="+this.name+", length="+this.length+", position="+this.position+", granularTracking="+this.granularTracking},a.AdInfo=b}(b),function(a){"use strict";function b(){this.name=null,this.length=null,this.position=null,this.startTime=null}b.prototype.toString=function(){return"name="+this.name+", length="+this.length+", position="+this.position+", startTime="+this.startTime},a.ChapterInfo=b}(b),function(a){"use strict";function b(){this.bitrate=null,this.fps=null,this.droppedFrames=null,this.startupTime=null}b.prototype.toString=function(){return"bitrate="+this.bitrate+", fps="+this.fps+", droppedFrames="+this.droppedFrames+", startupTime="+this.startupTime},a.QoSInfo=b}(b),function(a){"use strict";function b(){this.playerName=null,this.id=null,this.name=null,this.length=null,this.playhead=null,this.mediaType=null,this.streamType=null,this.resumed=!1}b.prototype.toString=function(){return"playerName="+this.playerName+", id="+this.id+", name="+this.name+", length="+this.length+", playhead="+this.playhead+", mediaType="+this.mediaType+", streamType="+this.streamType+", resumed="+this.resumed},a.VideoInfo=b}(b),function(a){"use strict";function b(){this.debugLogging=!1}a.VideoPlayerPluginConfig=b}(b),function(a){"use strict";function b(){}b.prototype.getVideoInfo=function(){throw new Error("Implementation error: Method must be overridden.")},b.prototype.getAdBreakInfo=function(){return null},b.prototype.getAdInfo=function(){return null},b.prototype.getChapterInfo=function(){return null},b.prototype.getQoSInfo=function(){return null},a.VideoPlayerPluginDelegate=b}(b),function(a,b){"use strict";function c(a){if(c.__super__.constructor.call(this,h),!a)throw new Error("PlayerPlugin delegate cannot be NULL.");this._delegate=a,this._isTrackingSessionActive=!1,this._isTrackingSessionStarted=!1,this._setupDataResolver()}var d=a.plugin.ParamMapping,e=a.Trigger,f=a.plugin.BasePlugin,g=b.VideoPlayerPluginConfig;a.extend(c,f),c.prototype.configure=function(a){if(!a)throw new Error("Reference to the configuration data cannot be NULL.");if(!(a instanceof g))throw new Error("Expected config data to be instance of VideoPlayerPluginConfig.");a.debugLogging?this._logger.enable():this._logger.disable(),this._logger.debug(this._logTag,"#configure(debugLogging="+a.debugLogging+")")},c.prototype.bootstrap=function(a){c.__super__.bootstrap.call(this,a),this._registerCommands(),this._registerBehaviours()},c.prototype._cmdVideoIdleStart=function(a){this._logger.info(this._logTag,"#_cmdVideoIdleStart()"),this._videoIdle=!0},c.prototype._cmdVideoIdleResume=function(a){this._logger.info(this._logTag,"#_cmdVideoIdleResume()"),this._videoIdle&&(this._trigger(p),this._trigger(q),a.isInAd&&(this._trigger(x),this._isTrackingAdBreak=!0),a.isInAd&&(this._trigger(z),this._isTrackingAd=!0),a.isInChapter&&this._trigger(G),this._trigger(u)),this._videoIdle=!1},c.prototype.trackSessionStart=function(){if(this._logger.info(this._logTag,"#trackSessionStart()"),this._canProcess()){if(!this._isTrackingSessionActive)return void this._logger.warn(this._logTag,"#trackSessionStart() > No active tracking session.");if(this._isTrackingSessionStarted)return void this._logger.info(this._logTag,"#trackSessionStart() > Tracking session already started.");this._trigger(p),this._isTrackingSessionStarted=!0;var a=this._dataResolver(["video.resumed"]);a.hasOwnProperty("video.resumed")&&a["video.resumed"]&&this._trigger(q)}},c.prototype.trackVideoLoad=function(){this._logger.info(this._logTag,"#trackVideoLoad()"),this._canProcess()&&(this._isTrackingAdBreak=!1,this._isTrackingAd=!1,this._contentStarted=!1,this._isPaused=!0,this._isBuffering=!1,this._isSeeking=!1,this._playheadTimer=null,this._previousPlayhead=-1,this._stalledPlayheadCount=0,this._playheadStalled=!1,this._videoIdle=!1,this._trigger(m),this._isTrackingSessionActive=!0,this._isTrackingSessionStarted=!1)},c.prototype.trackVideoUnload=function(){if(this._logger.info(this._logTag,"#trackVideoUnload()"),this._canProcess()){if(!this._isTrackingSessionActive)return void this._logger.warn(this._logTag,"#trackVideoUnload() > No active tracking session.");this._stopPlayheadTimer(),this._trigger(n),this._isTrackingSessionActive=!1,this._isTrackingSessionStarted=!1,this._contentStarted=!1}},c.prototype.beginReporting=function(){this._logger.info(this._logTag,"#beginReporting()"),this._canProcess()&&this._startSessionIfNeeded("beginReporting")&&this._trigger(N)},c.prototype.trackPlay=function(){this._logger.info(this._logTag,"#trackPlay()"),this._canProcess()&&this._startSessionIfNeeded("trackPlay")&&this._allowPlayerStateChange()&&(this._isPaused=!1,this._trigger(u),this._startPlayheadTimer())},c.prototype.trackPause=function(){if(this._logger.info(this._logTag,"#trackPause()"),this._canProcess()&&this._startSessionIfNeeded("trackPause")&&this._allowPlayerStateChange()){this._stopPlayheadTimer();var a={};a[P]=!1,this._isPaused=!0,this._trigger(v,a)}},c.prototype.trackBufferStart=function(){this._logger.info(this._logTag,"#trackBufferStart()"),this._canProcess()&&this._startSessionIfNeeded("trackBufferStart")&&this._allowPlayerStateChange()&&(this._stopPlayheadTimer(),this._isBuffering=!0,this._trigger(C))},c.prototype.trackBufferComplete=function(){this._logger.info(this._logTag,"#trackBufferComplete()"),this._canProcess()&&this._startSessionIfNeeded("trackBufferComplete")&&this._allowPlayerStateChange()&&(this._isBuffering=!1,this._trigger(D),this._startPlayheadTimer())},c.prototype.trackSeekStart=function(){this._logger.info(this._logTag,"#trackSeekStart()"),this._canProcess()&&this._startSessionIfNeeded("trackSeekStart")&&this._allowPlayerStateChange()&&(this._stopPlayheadTimer(),this._isSeeking=!0,this._trigger(E))},c.prototype.trackSeekComplete=function(){this._logger.info(this._logTag,"#trackSeekComplete()"),this._canProcess()&&this._startSessionIfNeeded("trackSeekComplete")&&this._allowPlayerStateChange()&&(this._isSeeking=!1,this._trigger(F),this._startPlayheadTimer())},c.prototype.trackComplete=function(a,b){if(this._logger.info(this._logTag,"#trackComplete()"),this._canProcess()&&this._startSessionIfNeeded("trackComplete")){if(this._stopPlayheadTimer(),this._videoIdle)return this._logger.info(this._logTag,"#trackComplete() > Video session is already in Idle State."),void(a&&a());var c={};c[O]=a,b=void 0===b||!!b,b?this._trigger(r,c):(this._trigger(s),this._trigger(o,c))}},c.prototype.trackTimedMetadata=function(a){this._logger.info(this._logTag,"#trackComplete()"),this._canProcess()&&this._startSessionIfNeeded("trackTimedMetadata")&&this._trigger(t,a)},c.prototype.trackChapterStart=function(){this._logger.info(this._logTag,"#trackChapterStart()"),this._canProcess()&&this._startSessionIfNeeded("#trackChapterStart")&&this._trigger(G)},c.prototype.trackChapterComplete=function(){this._logger.info(this._logTag,"#trackChapterComplete()"),this._canProcess()&&this._startSessionIfNeeded("trackChapterComplete")&&this._trigger(H)},c.prototype.trackChapterSkip=function(){this._logger.info(this._logTag,"#trackChapterSkip()"),this._canProcess()&&this._startSessionIfNeeded("trackChapterSkip")&&this._trigger(I)},c.prototype.trackAdBreakStart=function(){this._logger.info(this._logTag,"#trackAdBreakStart()"),this._canProcess()&&this._startSessionIfNeeded("trackAdBreakStart")&&(this._trigger(x),this._isTrackingAdBreak=!0)},c.prototype.trackAdBreakComplete=function(){this._logger.info(this._logTag,"#trackAdBreakComplete()"),this._canProcess()&&this._startSessionIfNeeded("trackAdBreakComplete")&&(this._trigger(y),this._isTrackingAdBreak=!1)},c.prototype.trackAdStart=function(){this._logger.info(this._logTag,"#trackAdStart()"),this._canProcess()&&this._startSessionIfNeeded("trackAdStart")&&(this._trigger(z),this._isTrackingAd=!0)},c.prototype.trackAdComplete=function(){this._logger.info(this._logTag,"#trackAdComplete()"),this._canProcess()&&this._startSessionIfNeeded("trackAdComplete")&&(this._trigger(A),this._isTrackingAd=!1)},c.prototype.trackAdSkip=function(){this._logger.info(this._logTag,"#trackAdSkip()"),this._canProcess()&&this._startSessionIfNeeded("trackAdSkip")&&(this._trigger(B),this._isTrackingAd=!1)},c.prototype.trackBitrateChange=function(){this._logger.info(this._logTag,"#trackBitrateChange()"),this._canProcess()&&this._startSessionIfNeeded("trackBitrateChange")&&this._trigger(J)},c.prototype.trackVideoPlayerError=function(a){if(this._logger.info(this._logTag,"#trackVideoPlayerError(errorId="+a+")"),this._startSessionIfNeeded("trackVideoPlayerError")){var b={};b[Q]=l,b[R]=a,this._trigger(K,b)}},c.prototype.trackApplicationError=function(a){if(this._logger.info(this._logTag,"#trackApplicationError(errorId="+a+")"),this._startSessionIfNeeded("trackApplicationError")){var b={};b[Q]=k,b[R]=a,this._trigger(K,b)}},c.prototype._registerCommands=function(){this._pluginManager.comply(this,"handleVideoIdleStart",this._cmdVideoIdleStart),this._pluginManager.comply(this,"handleVideoIdleResume",this._cmdVideoIdleResume)},c.prototype._registerBehaviours=function(){this._pluginManager.registerBehaviour(new e(j,L),this,"handleVideoIdleStart"),this._pluginManager.registerBehaviour(new e(j,M),this,"handleVideoIdleResume",[new d(i,"ad.isInAdBreak","isInAdBreak"),new d(i,"ad.isInAd","isInAd"),new d(i,"chapter.isInChapter","isInChapter")])},c.prototype._setupDataResolver=function(){function a(){return g.video?g.video:(g.video=h._delegate.getVideoInfo(),h._logger.info(h._logTag,"Data from delegate > VideoInfo: "+g.video),g.video)}function b(){return g.ad?g.ad:(g.ad=h._delegate.getAdInfo(),h._logger.info(h._logTag,"Data from delegate > AdInfo: "+g.ad),g.ad)}function c(){return g.pod?g.pod:(g.pod=h._delegate.getAdBreakInfo(),h._logger.info(h._logTag,"Data from delegate > AdBreakInfo: "+g.pod),g.pod)}function d(){return g.chapter?g.chapter:(g.chapter=h._delegate.getChapterInfo(),h._logger.info(h._logTag,"Data from delegate > ChapterInfo: "+g.chapter),g.chapter)}function e(){return g.qos?g.qos:(g.qos=h._delegate.getQoSInfo(),h._logger.info(h._logTag,"Data from delegate > QoSInfo: "+g.qos),g.qos)}var f={},g={},h=this;f["video.id"]=function(){var b=a(),c=b?b.id:null;return h._logger.debug(h._logTag,"Resolving video.id: "+c),c},f["video.name"]=function(){var b=a(),c=b?b.name:null;return h._logger.debug(h._logTag,"Resolving video.name: "+c),c},f["video.length"]=function(){var b=a(),c=b?b.length:NaN;return h._logger.debug(h._logTag,"Resolving video.length: "+c),c},f["video.playerName"]=function(){var b=a(),c=b?b.playerName:null;return h._logger.debug(h._logTag,"Resolving video.playerName: "+c),c},f["video.mediaType"]=function(){var b=a(),c=b?b.mediaType:null;return h._logger.debug(h._logTag,"Resolving video.mediaType: "+c),c},f["video.streamType"]=function(){var b=a(),c=b?b.streamType:null;return h._logger.debug(h._logTag,"Resolving video.streamType: "+c),c},f["video.playhead"]=function(){var b=a(),c=b?b.playhead:NaN;return h._logger.debug(h._logTag,"Resolving video.playhead: "+c),c},f["video.resumed"]=function(){var b=a(),c=!!b&&b.resumed;return h._logger.debug(h._logTag,"Resolving video.resumed: "+c),c},f["video.playheadStalled"]=function(){return this._playheadStalled},f["pod.name"]=function(){var a=c(),b=a?a.name:null;return h._logger.debug(h._logTag,"Resolving pod.name: "+b),b},f["pod.playerName"]=function(){var a=c(),b=a?a.playerName:null;return h._logger.debug(h._logTag,"Resolving pod.playerName: "+b),b},f["pod.position"]=function(){var a=c(),b=a?a.position:NaN;return h._logger.debug(h._logTag,"Resolving pod.position: "+b),b},f["pod.startTime"]=function(){var a=c(),b=a?a.startTime:NaN;return h._logger.debug(h._logTag,"Resolving pod.startTime: "+b),b},f["ad.isInAd"]=function(){var a=b(),c=null!=a;return h._logger.debug(h._logTag,"Resolving ad.isInAd: "+c),c},f["ad.isInAdBreak"]=function(){var a=c(),b=null!=a;return h._logger.debug(h._logTag,"Resolving ad.isInAdBreak: "+b),b},f["ad.id"]=function(){var a=b(),c=a?a.id:null;return h._logger.debug(h._logTag,"Resolving ad.id: "+c),c},f["ad.name"]=function(){var a=b(),c=a?a.name:null;return h._logger.debug(h._logTag,"Resolving ad.name: "+c),c},f["ad.length"]=function(){var a=b(),c=a?a.length:NaN;return h._logger.debug(h._logTag,"Resolving ad.length: "+c),c},f["ad.position"]=function(){var a=b(),c=a?a.position:NaN;return h._logger.debug(h._logTag,"Resolving ad.position: "+c),c},f["ad.granularTracking"]=function(){var a=b(),c=!!a&&a.granularTracking;return h._logger.debug(h._logTag,"Resolving ad.granularTracking: "+c),c},f["ad.trackingInterval"]=function(){var a=T;return h._logger.debug(h._logTag,"Resolving ad.trackingInterval: "+a),a},f["chapter.isInChapter"]=function(){var a=d(),b=null!=a;return h._logger.debug(h._logTag,"Resolving chapter.isInChapter: "+b),b},f["chapter.name"]=function(){var a=d(),b=a?a.name:null;return h._logger.debug(h._logTag,"Resolving chapter.name: "+b),b},f["chapter.length"]=function(){var a=d(),b=a?a.length:NaN;return h._logger.debug(h._logTag,"Resolving chapter.length: "+b),b},f["chapter.position"]=function(){var a=d(),b=a?a.position:NaN;return h._logger.debug(h._logTag,"Resolving chapter.position: "+b),b},f["chapter.startTime"]=function(){var a=d(),b=a?a.startTime:NaN;return h._logger.debug(h._logTag,"Resolving chapter.startTime: "+b),b},f["qos.bitrate"]=function(){var a=e(),b=a?a.bitrate:NaN;return h._logger.debug(h._logTag,"Resolving qos.bitrate: "+b),b},f["qos.fps"]=function(){var a=e(),b=a?a.fps:NaN;return h._logger.debug(h._logTag,"Resolving qos.fps: "+b),b},f["qos.droppedFrames"]=function(){var a=e(),b=a?a.droppedFrames:NaN;return h._logger.debug(h._logTag,"Resolving qos.droppedFrames: "+b),b},f["qos.startupTime"]=function(){var a=e(),b=a?1e3*a.startupTime:NaN;return h._logger.debug(h._logTag,"Resolving qos.startupTime: "+b),b},this._dataResolver=function(a){if(!a||0==a.length)return null;g={};for(var b=null,c=0;c<a.length;c++){var d=a[c];b=b||{},b[d]=f.hasOwnProperty(d)?f[d].call(this):null}return b}},c.prototype._trackPlayheadStall=function(){this._canProcess()&&(this._playheadStalled||(this._logger.info(this._logTag,"#_trackPlayheadStall()"),this._stalledPlayheadCount=0,this._playheadStalled=!0,this._trigger(v)))},c.prototype._trackExitStall=function(){this._canProcess()&&(this._stalledPlayheadCount=0,!this._playheadStalled||this._isPaused||this._isSeeking||this._isBuffering||(this._logger.info(this._logTag,"#_trackExitStall()"),this._playheadStalled=!1,this._trigger(u)))},c.prototype._startPlayheadTimer=function(){var a=this;this._playheadTimer||this._isPaused||this._isSeeking||this._isBuffering||(this._playheadTimer=setInterval(function(){if(a._canProcess()){var b=a._dataResolver(["ad.isInAd","video.playhead"]);if(a._isTrackingAdBreak)a._playheadStalled&&a._trackExitStall();else{var c=b["video.playhead"];c!=a._previousPlayhead?a._trackExitStall():a._previousPlayhead>=0&&c==a._previousPlayhead&&++a._stalledPlayheadCount==U&&a._trackPlayheadStall(),c!=a._previousPlayhead&&c>0&&!a._contentStarted&&(a._isPaused||a._isBuffering||a._isSeeking||(a._logger.info(a._logTag,"#_playheadTimer playhead progress to: "+c),a._trigger(w),a._contentStarted=!0)),a._previousPlayhead=c}}},S))},c.prototype._stopPlayheadTimer=function(){this._playheadTimer&&(clearInterval(this._playheadTimer),this._playheadTimer=null),this._trackExitStall()},c.prototype._startSessionIfNeeded=function(a){return this._isTrackingSessionActive?(this._isTrackingSessionStarted||(this._logger.info(this._logTag,"#"+a+"() > Tracking session auto-start."),this.trackSessionStart()),!0):(this._logger.warn(this._logTag,"#"+a+"() > No active tracking session."),!1)},c.prototype._allowPlayerStateChange=function(){return!(this._isTrackingAdBreak&&!this._isTrackingAd)||(this._logger.info(this._logTag,"_allowPlayerStateChange Player plugin does not allow player state changes when in Adbreak and not in Ad."),!1)};var h="player",i=h,j="adobe-heartbeat",k="sourceErrorExternal",l="sourceErrorSDK",m="video_load",n="video_unload",o="video_session_end",p="video_start",q="video_resume",r="video_complete",s="video_skip",t="timed_metadata",u="play",v="pause",w="content_start",x="adbreak_start",y="adbreak_complete",z="ad_start",A="ad_complete",B="ad_skip",C="buffer_start",D="buffer_complete",E="seek_start",F="seek_complete",G="chapter_start",H="chapter_complete",I="chapter_skip",J="bitrate_change",K="track_error",L="video_idle_start",M="video_idle_resume",N="video_begin_reporting",O="callback",P="filter_report",Q="source",R="error_id",S=1001,T=1,U=2;b.VideoPlayerPlugin=c}(a.ADB.core,b),a.ADB.va.plugins.videoplayer||(a.ADB.va.plugins.videoplayer=b)}(this);\n\n// AdobeHeartbeatPlugin\n!function(a){if(void 0===b)var b={};b.clock||(b.clock={}),b.context||(b.context={}),b.filter||(b.filter={}),b.model||(b.model={}),b.network||(b.network={}),function(a,b){"use strict";function c(a,b,c,d,e){if(!b)throw new Error("Reference to the channel object cannot be NULL");if(this._channel=b,!a)throw new Error("Reference to the pluginManager object cannot be NULL");if(this._pluginManager=a,!e)throw new Error("Reference to the logger object cannot be NULL");this._logTag="ah::Timer."+c,this._logger=e,this._isDestroyed=!1,this._createTimer(c,d),this._installHandlers()}var d=a.Event;c.KEY_NAME="name",c.KEY_INTERVAL="interval",c.KEY_RESET="reset",c.prototype.resume=function(a){this._logger.debug(this._logTag,"Starting timer: "+this._name);var b={};b[c.KEY_NAME]=e+"."+this._name,b[c.KEY_RESET]=a,this._pluginManager.command(f,i,b)},c.prototype.pause=function(a){this._logger.debug(this._logTag,"Stopping timer: "+this._name);var b={};b[c.KEY_NAME]=e+"."+this._name,b[c.KEY_RESET]=a,this._pluginManager.command(f,h,b)},c.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyed=!0,this._uninstallHandlers();var a={};a[c.KEY_NAME]=e+"."+this._name,this._pluginManager.command(f,j,a)}},c.prototype.setInterval=function(a){var b=k+"."+e+"."+this._name,c=this._pluginManager.request(f,[b])[b];this.pause(!0),this._createTimer(this._name,a),c||this.resume(!0)},c.prototype._cmdResume=function(a){var b=!1;null!=a&&a.hasOwnProperty(c.KEY_RESET)&&(b=a[c.KEY_RESET]),this.resume(b)},c.prototype._cmdPause=function(a){var b=!1;null!=a&&a.hasOwnProperty(c.KEY_RESET)&&(b=a[c.KEY_RESET]),this.pause(b)},c.prototype._onTick=function(a,b){this._channel.trigger(new d("clock:"+this._name+".tick",b))},c.prototype._installHandlers=function(){this._channel.comply("clock:"+this._name+".resume",this._cmdResume,this),this._channel.comply("clock:"+this._name+".pause",this._cmdPause,this),this._pluginManager.on(f,e+"."+this._name+".tick",this._onTick,this)},c.prototype._uninstallHandlers=function(){this._channel.off(null,null,this),this._pluginManager.off(null,null,null,this)},c.prototype._createTimer=function(a,b){this._name=a,this._interval=b;var d={};d[c.KEY_NAME]=e+"."+this._name,d[c.KEY_INTERVAL]=this._interval,this._pluginManager.command(f,g,d)};var e="heartbeat",f="service.clock",g="create",h="pause",i="resume",j="destroy",k="is_paused";b.clock.Timer=c}(a.ADB.core,b),function(a,b){"use strict";function c(a,b,d){c.__super__.constructor.call(this,a,b,f,h,d)}var d=a.Event,e=b.clock.Timer;a.extend(c,e),c.prototype._onCheckStatusComplete=function(a){var b=a.data[l];if(this._logger.debug(this._logTag,"#_onCheckStatusComplete(interval="+b+")"),b){if(b==this._interval)return void this._logger.debug(this._logTag,"#_onCheckStatusComplete() > Interval value not changed.");b>g?(this._logger.warn(this._logTag,"#_onCheckStatusComplete() > Interval value too large: "+b),this.setInterval(g)):(this._logger.debug(this._logTag,"#_onCheckStatusComplete() > Interval changed to: "+b),this.setInterval(b))}else this._logger.warn(this._logTag,"#_onCheckStatusComplete() > Invalid interval value."),this.setInterval(h)},c.prototype._getSettings=function(a){this._logger.debug(this._logTag,"#_getSettings()"),this._channel.trigger(new d(i))},c.prototype._installHandlers=function(){c.__super__._installHandlers.call(this),this._channel.on(j,this._getSettings,this),this._channel.on(k,this._onCheckStatusComplete,this),this._channel.reply(l,function(){return this._interval},this)};var f="check_status",g=600,h=180,i="clock:check_status.tick",j="clock:check_status.get_settings",k="net:check_status_complete",l="check_status_interval";b.clock.CheckStatusTimer=c}(a.ADB.core,b),function(a,b){"use strict";function c(a,b,d){c.__super__.constructor.call(this,a,b,e,f,d),this._doNotOverrideInterval=!1}var d=b.clock.Timer;a.extend(c,d),c.prototype._onCheckStatusComplete=function(a){var b=a.data[g];if(this._logger.debug(this._logTag,"#_onCheckStatusComplete(interval="+b+")"),this._doNotOverrideInterval)this._logger.debug(this._logTag,"#_onCheckStatusComplete() > Interval value not changed. (doNotOverrideInterval = true)");else if(b){if(b==this._interval)return void this._logger.debug(this._logTag,"#_onCheckStatusComplete() > Interval value not changed.");this._logger.debug(this._logTag,"#_onCheckStatusComplete() > Interval changed to: "+b),this.setInterval(b)}else this._logger.warn(this._logTag,"#_onCheckStatusComplete() > Invalid interval value."),this.setInterval(f)},c.prototype._onUpdateReportingInterval=function(a){var b=a.data[g];if(this._doNotOverrideInterval=!!a.data[h],this._logger.debug(this._logTag,"#_onUpdateReportingInterval(interval="+b+", doNotOverrideInterval="+this._doNotOverrideInterval+")"),b){if(b==this._interval)return void this._logger.debug(this._logTag,"#_onUpdateReportingInterval() > Interval value not changed.");this._logger.debug(this._logTag,"#_onUpdateReportingInterval() > Interval changed to: "+b),this.setInterval(b)}else this._logger.warn(this._logTag,"#_onUpdateReportingInterval() > Invalid interval value."),this.setInterval(f)},c.prototype._installHandlers=function(){c.__super__._installHandlers.call(this),this._channel.on(j,this._onCheckStatusComplete,this),this._channel.on(i,this._onUpdateReportingInterval,this),this._channel.reply(g,function(){return this._interval},this)};var e="reporting",f=10,g="reporting_interval",h="do_not_override_interval",i="reporting:update_interval",j="net:check_status_complete";b.clock.ReportingTimer=c}(a.ADB.core,b),function(a,b){"use strict";function c(a,b,d){c.__super__.constructor.call(this,a,b,e,f,d)}var d=b.clock.Timer;a.extend(c,d);var e="idle",f=1800;b.clock.IdleTimer=c}(a.ADB.core,b),function(a,b){"use strict";function c(a,b,d){c.__super__.constructor.call(this,a,b,e,f,d)}var d=b.clock.Timer;a.extend(c,d);var e="flush_filter",f=.25;b.clock.FlushFilterTimer=c}(a.ADB.core,b),function(a,b){"use strict";function c(a,b,c){if(!a)throw new Error("Reference to the pluginManager object cannot be NULL");if(!b)throw new Error("Reference to the channel object cannot be NULL");if(!c)throw new Error("Reference to the logger object cannot be NULL");this._isDestroyed=!1,this._reportingTimer=new f(a,b,c),this._checkStatusTimer=new d(a,b,c),this._flushFilterTimer=new e(a,b,c),this._idleTimer=new g(a,b,c)}var d=b.clock.CheckStatusTimer,e=b.clock.FlushFilterTimer,f=b.clock.ReportingTimer,g=b.clock.IdleTimer;c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this._reportingTimer.destroy(),this._checkStatusTimer.destroy(),this._flushFilterTimer.destroy(),this._idleTimer.destroy())},b.clock.Clock=c}(a.ADB.core,b),function(a,b){"use strict";function c(a,b){this.value=a,this.hint=b}function d(a){this.realm=a,this.data={}}c.HINT_SHORT="short",d.prototype.setField=function(a,b,d){this.data[a]=new c(b,d)},d.prototype._createAccessor=function(a,b,c){var d=this;return function(){return arguments.length&&(d[a]=arguments[0],d.setField(b,arguments[0],c)),d[a]}},b.model.Dao=d,b.model.DaoField=c}(a.ADB.core,b),function(a,b){"use strict";function c(){if(c.__super__.constructor.call(this,"asset"),this.adId=this._createAccessor("_adId","ad_id",null),this.sid=this._createAccessor("_sid","ad_sid",null),this.resolver=this._createAccessor("_resolver","resolver",null),this.podId=this._createAccessor("_podId","pod_id",null),this.podPosition=this._createAccessor("_podPosition","pod_position",null),this.podOffset=this._createAccessor("_podOffset","pod_offset",null),this.podName=this._createAccessor("_podName","pod_name",null),this.adLength=this._createAccessor("_adLength","ad_length",null),this.adName=this._createAccessor("_adName","ad_name",null),arguments.length&&arguments[0]instanceof c){var a=arguments[0];this.adId(a.adId()),this.sid(a.sid()),this.resolver(a.resolver()),this.podId(a.podId()),this.podPosition(a.podPosition()),this.podOffset(a.podOffset()),this.podName(a.podName()),this.adLength(a.adLength()),this.adName(a.adName())}else this.adId(""),this.sid(""),this.resolver(""),this.podId(""),this.podPosition(""),this.podOffset(0),this.podName(""),this.adLength(0),this.adName("")}var d=b.model.Dao;a.extend(c,d),b.model.AdDao=c}(a.ADB.core,b),function(a,b){"use strict";function c(){if(c.__super__.constructor.call(this,"sc"),this.reportSuiteId=this._createAccessor("_reportSuiteId","rsid",null),this.trackingServer=this._createAccessor("_trackingServer","tracking_server",null),this.ssl=this._createAccessor("_ssl","ssl",e.HINT_SHORT),arguments.length&&arguments[0]instanceof c){var a=arguments[0];this.reportSuiteId(a.reportSuiteId()),this.trackingServer(a.trackingServer()),this.ssl(a.ssl())}else this.reportSuiteId(""),this.trackingServer(""),this.ssl(0)}var d=b.model.Dao,e=b.model.DaoField;a.extend(c,d),b.model.AdobeAnalyticsDao=c}(a.ADB.core,b),function(a,b){"use strict";function c(){if(c.__super__.constructor.call(this,"stream"),this.id=this._createAccessor("_id","chapter_id",null),this.sid=this._createAccessor("_sid","chapter_sid",null),this.name=this._createAccessor("_name","chapter_name",null),this.position=this._createAccessor("_position","chapter_pos",null),this.length=this._createAccessor("_length","chapter_length",null),this.offset=this._createAccessor("_offset","chapter_offset",null),arguments.length&&arguments[0]instanceof c){var a=arguments[0];this.id(a.id()),this.sid(a.sid()),this.name(a.name()),this.position(a.position()),this.length(a.length()),this.offset(a.offset())}else this.id(""),this.sid(""),this.name(""),this.position(0),this.length(0),this.offset(0)}var d=b.model.Dao;a.extend(c,d),b.model.ChapterDao=c}(a.ADB.core,b),function(a,b){"use strict";function c(){if(c.__super__.constructor.call(this,"asset"),this.type=this._createAccessor("_type","type",null),this.videoId=this._createAccessor("_videoId","video_id",null),this.publisher=this._createAccessor("_publisher","publisher",null),this.adData=this._createAccessor("_adData","ad_data",null),this.chapterData=this._createAccessor("_chapterData","chapter_data",null),this.length=this._createAccessor("_length","length",null),this.name=this._createAccessor("_name","name",null),arguments.length&&arguments[0]instanceof c){var a=arguments[0];this.type(a.type()),this.name(a.name()),this.videoId(a.videoId()),this.publisher(a.publisher()),this.length(a.length());var b=a.adData()?new e(a.adData()):null;this.adData(b);var d=a.chapterData()?new f(a.chapterData()):null;this.chapterData(d)}else this.type(""),this.name(""),this.videoId(""),this.publisher(""),this.length(0),this.adData(null),this.chapterData(null)}var d=b.model.Dao,e=b.model.AdDao,f=b.model.ChapterDao;a.extend(c,d),c.TYPE_AD="ad",c.TYPE_MAIN_CONTENT="main",b.model.AssetDao=c}(a.ADB.core,b),function(a,b){"use strict";function c(){if(c.__super__.constructor.call(this,"event"),this.type=this._createAccessor("_type","type",null),this.duration=this._createAccessor("_duration","duration",null),this.playhead=this._createAccessor("_playhead","playhead",null),this.id=this._createAccessor("_id","id",null),this.source=this._createAccessor("_source","source",null),this.ts=this._createAccessor("_ts","ts",null),this.prevTs=this._createAccessor("_prevTs","prev_ts",null),arguments.length&&arguments[0]instanceof c){var a=arguments[0];this.type(a.type()),this.duration(a.duration()),this.playhead(a.playhead()),this.id(a.id()),this.source(a.source()),this.ts(a.ts()),this.prevTs(a.prevTs())}else this.type(""),this.duration(0),this.playhead(0),this.id(""),this.source(""),this.ts(0),this.prevTs(-1)}var d=b.model.Dao;a.extend(c,d),c.EVENT_TYPE_AA_START="aa_start",c.EVENT_TYPE_AA_AD_START="aa_ad_start",c.EVENT_TYPE_START="start",c.EVENT_TYPE_RESUME="resume",c.EVENT_TYPE_CHAPTER_START="chapter_start",c.EVENT_TYPE_CHAPTER_COMPLETE="chapter_complete",c.EVENT_TYPE_CHAPTER_SKIP="chapter_skip",c.EVENT_TYPE_PLAY="play",c.EVENT_TYPE_PAUSE="pause",c.EVENT_TYPE_STALL="stall",c.EVENT_TYPE_BUFFER="buffer",c.EVENT_TYPE_BITRATE_CHANGE="bitrate_change",c.EVENT_TYPE_ERROR="error",c.EVENT_TYPE_COMPLETE="complete",c.EVENT_TYPE_SKIP="skip",c.EVENT_TYPE_END="end",b.model.EventDao=c}(a.ADB.core,b),function(a,b){"use strict";function c(){if(c.__super__.constructor.call(this,"stream"),this.bitrate=this._createAccessor("_bitrate","bitrate",null),this.fps=this._createAccessor("_fps","fps",null),this.droppedFrames=this._createAccessor("_droppedFrames","dropped_frames",null),this.startupTime=this._createAccessor("_startup_time","startup_time",null),arguments.length&&arguments[0]instanceof c){var a=arguments[0];this.bitrate(a.bitrate()),this.fps(a.fps()),this.droppedFrames(a.droppedFrames()),this.startupTime(a.startupTime()),this.isStartupTimeOverridden=a.isStartupTimeOverridden}else this.bitrate(0),this.fps(0),this.droppedFrames(0),this.startupTime(0),this.isStartupTimeOverridden=!1}var d=b.model.Dao;a.extend(c,d),b.model.QoSDao=c}(a.ADB.core,b),function(a,b){"use strict";function c(){if(c.__super__.constructor.call(this,"sp"),this.ovp=this._createAccessor("_ovp","ovp",null),this.sdk=this._createAccessor("_sdk","sdk",null),this.channel=this._createAccessor("_channel","channel",null),this.playerName=this._createAccessor("_playerName","player_name",null),this.libVersion=this._createAccessor("_libVersion","hb_version",null),this.apiLevel=this._createAccessor("_apiLevel","hb_api_lvl",null),arguments.length&&arguments[0]instanceof c){var a=arguments[0];this.ovp(a.ovp()),this.sdk(a.sdk()),this.channel(a.channel()),this.playerName(a.playerName()),this.libVersion(a.libVersion()),this.apiLevel(a.apiLevel())}else this.ovp(e),this.sdk(e),this.channel(e),this.playerName(""),this.libVersion(""),this.apiLevel(0)}var d=b.model.Dao;a.extend(c,d);var e="unknown";b.model.ServiceProviderDao=c}(a.ADB.core,b),function(a,b){"use strict";function c(){if(c.__super__.constructor.call(this,"event"),this.sessionId=this._createAccessor("_sessionId","sid",null),arguments.length&&arguments[0]instanceof c){var a=arguments[0];this.sessionId(a.sessionId())}else this.sessionId(null)}var d=b.model.Dao;a.extend(c,d),b.model.SessionDao=c}(a.ADB.core,b),function(a,b){"use strict";function c(){if(c.__super__.constructor.call(this,"stream"),this.type=this._createAccessor("_type","type",null),arguments.length&&arguments[0]instanceof c){var a=arguments[0];this.type(a.type())}else this.type(null)}var d=b.model.Dao;a.extend(c,d),b.model.StreamDao=c}(a.ADB.core,b),function(a,b){"use strict";function c(){if(c.__super__.constructor.call(this,"user"),this.analyticsVisitorId=this._createAccessor("_analyticsVisitorId","aid",null),this.marketingCloudVisitorId=this._createAccessor("_marketingCloudVisitorId","mid",null),this.visitorId=this._createAccessor("_visitorId","id",null),arguments.length&&arguments[0]instanceof c){var a=arguments[0];this.analyticsVisitorId(a.analyticsVisitorId()),this.marketingCloudVisitorId(a.marketingCloudVisitorId()),this.visitorId(a.visitorId())}else this.analyticsVisitorId(null),this.marketingCloudVisitorId(null),this.visitorId(null)}var d=b.model.Dao;a.extend(c,d),b.model.UserDao=c}(a.ADB.core,b),function(a,b){"use strict";function c(){if(c.__super__.constructor.call(this,"aam"),this.audienceManagerBlob=this._createAccessor("_audienceManagerBlob","blob",null),this.audienceManagerLocationHint=this._createAccessor("_audienceManagerLocationHint","loc_hint",null),arguments.length&&arguments[0]instanceof c){var a=arguments[0];this.audienceManagerBlob(a.audienceManagerBlob()),this.audienceManagerLocationHint(a.audienceManagerLocationHint())}else this.audienceManagerBlob(null),this.audienceManagerLocationHint(null)}var d=b.model.Dao;a.extend(c,d),b.model.AudienceManagerDao=c}(a.ADB.core,b),function(a,b){"use strict";function c(a,b,c,i,j){this.eventData=new e,this.eventData.type(b),this.eventData.duration(0),this.eventData.ts((new Date).getTime()),this.eventData.playhead(c),this.assetData=new f(a._assetData),this.streamData=new g(a._streamData),this.qosData=new h(a._qosData),this.cuserData=d.clone(a._cuserData),this.meta=i,this.callback=j,this.filterReport=!0}var d=a.ObjectUtils,e=b.model.EventDao,f=b.model.AssetDao,g=b.model.StreamDao,h=b.model.QoSDao;b.model.TrackItem=c}(a.ADB.va.utils,b),function(a,b){"use strict";function c(a,b,c,i,j,k){this.adobeAnalyticsData=a,this.userData=b,this.aamData=c,this.serviceProviderData=i,this.sessionData=j,this.eventData=new e(k.eventData),this.assetData=new f(k.assetData),this.streamData=new g(k.streamData),this.qosData=new h(k.qosData),this.cuserData=d.clone(k.cuserData),this.meta=d.clone(k.meta),this.callback=k.callback,this.filterReport=k.filterReport}var d=a.ObjectUtils,e=b.model.EventDao,f=b.model.AssetDao,g=b.model.StreamDao,h=b.model.QoSDao;b.model.CUserDao;b.model.Report=c}(a.ADB.va.utils,b),function(a){"use strict";function b(){}b.prototype.serializeReport=function(a){},b.prototype.serializeDao=function(a){},b.prototype.serializeMap=function(a){},b.prototype.serializeNumber=function(a,b,c,d){},b.prototype.serializeString=function(a,b,c,d){},a.model.ISerializer=b}(b),function(a,b){"use strict";function c(a){if(!a)throw new Error("Reference to the logger object cannot be NULL");this._logger=a}var d=b.model.Dao,e=b.model.DaoField,f=b.model.ISerializer;a.extend(c,f),c.prototype.serializeReport=function(a){var b=[];return b.push(this.serializeDao(a.adobeAnalyticsData)),b.push(this.serializeDao(a.userData)),b.push(this.serializeDao(a.aamData)),b.push(this.serializeMap(a.cuserData,"cuser")),b.push(this.serializeDao(a.serviceProviderData)),b.push(this.serializeDao(a.sessionData)),b.push(this.serializeDao(a.eventData)),b.push(this.serializeDao(a.assetData)),b.push(this.serializeDao(a.streamData)),b.push(this.serializeDao(a.qosData)),b.push(this.serializeMap(a.meta,"meta")),{serializedOutput:b.filter(function(a){return!!a}).join("&"),callback:a.callback}},c.prototype.serializeDao=function(a){return this._processDao(a).filter(function(a){return!!a}).join("&")},c.prototype.serializeMap=function(a,b){var c=[],d=b||"meta";for(var e in a)a.hasOwnProperty(e)&&a[e]&&c.push("s:"+d+":"+e+"="+window.encodeURIComponent(a[e]));return c.join("&")},c.prototype.serializeNumber=function(a,b,c,d){var f=h;return null==b||isNaN(b)?null:(d===e.HINT_SHORT&&(f=i),f+":"+c+":"+a+"="+Math.floor(b))},c.prototype.serializeString=function(a,b,c,d){return b?j+":"+c+":"+a+"="+window.encodeURIComponent(b):null},c.prototype._processDao=function(a){var b=[];for(var c in a.data)if(a.data.hasOwnProperty(c)){var e=a.data[c],f=e.value,h=e.hint,i=null,j=a.realm;if(null==f)continue;"number"==typeof f?i=this.serializeNumber(c,f,j,h):"string"==typeof f?i=this.serializeString(c,f,j,h):f instanceof d?i=this.serializeDao(f):this._logger.warn(g,"#_processDao() > Unable to serialize DAO. Field: "+c+". Value: "+f+"."),i&&b.push(i)}return b};var g="ah::QuerystringSerializer",h="l",i="h",j="s";b.model.QuerystringSerializer=c}(a.ADB.core,b),function(a,b){"use strict";function c(a,b){if(!a)throw new Error("Reference to the data object cannot be NULL");if(this._data=a,!b)throw new Error("Reference to the logger object cannot be NULL");this._logger=b}c.prototype.parse=function(){var a,b,c,j,k,l;if(window.DOMParser){l=(new window.DOMParser).parseFromString(this._data,"text/xml")}else l=new window.ActiveXObject("Microsoft.XMLDOM"),l.async=!1,l.loadXML(this._data);var m;m=parseInt(l.getElementsByTagName("trackingInterval")[0].childNodes[0].nodeValue,10),m&&(a=m),m=parseInt(l.getElementsByTagName("setupCheckInterval")[0].childNodes[0].nodeValue,10),m&&(b=m),m=parseInt(l.getElementsByTagName("trackExternalErrors")[0].childNodes[0].nodeValue,10),m&&(c=1==m),l.getElementsByTagName("trackingDisabled")[0]&&(m=parseInt(l.getElementsByTagName("trackingDisabled")[0].childNodes[0].nodeValue,10),j=1==m),l.getElementsByTagName("nielsenEnabled")[0]?(m=parseInt(l.getElementsByTagName("nielsenEnabled")[0].childNodes[0].nodeValue,10),k=1==m):k=!0;var n={};return n[e]=a,n[f]=b,n[g]=c,n[i]=j,n[h]=k,this._logger.debug(d,"#parse() > Obtained configuration settings."),n};var d="ah::SettingsParser",e="reporting_interval",f="check_status_interval",g="track_external_errors",h="nielsen_enabled",i="tracking_disabled";b.network.SettingsParser=c}(a.ADB.core,b),function(a,b){"use strict";function c(a,b){if(this._trackingServer=null,this._checkStatusServer=null,this._publisher=null,this._isConfigured=!1,this._isDestroyed=!1,this._beginReporting=!1,this._sendingRequest=!1,this._requestsQueue=[],this._quietMode=!1,this._prevReportSent=null,!a)throw new Error("Reference to the channel object cannot be NULL");if(this._channel=a,!b)throw new Error("Reference to the logger object cannot be NULL");this._logger=b,this._serializer=new i(b),this._installEventListeners()}var d=a.Event,e=a.URLRequestMethod,f=a.URLRequest,g=a.URLLoader,h=b.network.SettingsParser,i=b.model.QuerystringSerializer;c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this._logger.debug(j,"#destroy()"),this._uninstallEventListeners())},c.prototype._onApiConfig=function(a){var b=a.data;this._logger.debug(j,"#_onApiConfig(sb_server="+b[k]+", check_status_server="+b[l]+", publisher="+b[m]+", quiet_mode="+b[n]+", ssl="+b[o]+")"),this._trackingServer=this._updateRequestProtocol(b[k],b[o]),this._checkStatusServer=this._updateRequestProtocol(b[l],b[o]),this._publisher=b[m],this._quietMode=b[n],this._isConfigured=!0},c.prototype._onBeginReporting=function(a){this._logger.debug(j,"#_onBeginReporting()"),this._beginReporting=!0,this._sendNextRequest(),this._onClockCheckStatusTick()},c.prototype._onFilterReportAvailable=function(a){var b=a.data;if(!this._isConfigured)return void this._logger.warn(j,"#_onFilterReportAvailable() > Unable to send request: not configured.");var c=b[p];if(this._prevReportSent&&this._prevReportSent.eventData&&c.eventData&&this._prevReportSent.eventData.playhead==c.eventData.playhead&&this._prevReportSent.eventData.ts==c.eventData.ts&&this._prevReportSent.eventData.prevTs==c.eventData.prevTs&&this._prevReportSent.eventData.type==c.eventData.type)return void this._logger.debug(j,"#_onFilterReportAvailable() > Duplicate heartbeat report not sent for URL:\\n"+e);this._prevReportSent=c;var d=this._serializer.serializeReport(c),e=this._trackingServer+"/?"+d.serializedOutput;this._processRequest(e,d.callback)},c.prototype._processRequest=function(a,b){this._requestsQueue.push({url:a,callback:b}),this._sendNextRequest()},c.prototype._sendNextRequest=function(){if(!this._beginReporting)return void this._logger.debug(j,"#_sendNextRequest() > Exiting as we have not started reporting.");if(this._sendingRequest)return void this._logger.debug(j,"#_sendNextRequest() > Exiting as we are currently sending a request.");var a=this._requestsQueue.shift();if(!a)return void this._logger.debug(j,"#_sendNextRequest() > Exiting as we have no requests to send.");this._sendingRequest=!0,this._logger.debug(j,"#_sendNextRequest() > "+a.url);var b=this,c=new g,h=function(){c.close(),a.callback&&a.callback.call(null),b._sendingRequest=!1,b._sendNextRequest()},i=function(a){h()},k=function(a){b._logger.warn(j,"#_onFilterReportAvailable() > Failed to send heartbeat report."),h()};if(!this._quietMode){c.addEventListener(d.SUCCESS,i,this),c.addEventListener(d.ERROR,k,this);var l=new f(a.url,e.GET);c.load(l)}},c.prototype._onClockCheckStatusTick=function(a){function b(a){if(a.data){var b=new h(a.data.response,i._logger),c=b.parse();c?i._channel.trigger(new d(u,c)):i._logger.warn(j,"#_onClockCheckStatusTick() > Failed to parse the config. settings.")}n.close()}function c(a){i._logger.warn(j,"#_onClockCheckStatusTick() > Failed to obtain the config. settings."),n.close()}if(!this._isConfigured)return void this._logger.warn(j,"#_onClockCheckStatusTick() > Unable to send request: not configured.");if(!this._publisher)return void this._logger.warn(j,"#_onClockCheckStatusTick() > Publisher is NULL.");if(!this._beginReporting)return void this._logger.debug(j,"#_onClockCheckStatusTick() > Exiting as we have not started reporting.");var i=this,k=this._publisher.replace(/[^a-zA-Z0-9]+/,"-").toLocaleLowerCase(),l=this._checkStatusServer+k+".xml?r="+(new Date).getTime(),m=new f(l,e.GET),n=new g;n.addEventListener(d.SUCCESS,b,this),n.addEventListener(d.ERROR,c,this),this._logger.debug(j,"#_onClockCheckStatusTick() > Get new settings from: "+l),n.load(m)},c.prototype._updateRequestProtocol=function(a,b){var c=a;return 0===c.indexOf("http://")?c=c.slice(7):0===c.indexOf("https://")&&(c=c.slice(8)),b?"https://"+c:"http://"+c},c.prototype._installEventListeners=function(){this._channel.on(q,this._onApiConfig,this),this._channel.on(r,this._onBeginReporting,this),this._channel.on(s,this._onFilterReportAvailable,this),this._channel.on(t,this._onClockCheckStatusTick,this)},c.prototype._uninstallEventListeners=function(){this._channel.off(null,null,this)};var j="ah::Network",k="tracking_server",l="check_status_server",m="publisher",n="quiet_mode",o="ssl",p="report",q="api:config",r="api:video_begin_reporting",s="filter:data_available",t="clock:check_status.tick",u="net:check_status_complete";b.network.Network=c}(a.ADB.core,b),function(a,b){"use strict";function c(a,b){if(!a)throw new Error("Reference to the channel object cannot be NULL");if(this._channel=a,!b)throw new Error("Reference to the logger object cannot be NULL");this._logger=b,this._isDestroyed=!1,this._isBufferingInProgress=!1,this._reportBuffer={},this._tsHistory={},this._workQueue=new i,this._installEventListeners()}function d(a){var b=[];return a&&a.forEach(function(a){a.eventData.type()==k.EVENT_TYPE_PAUSE||a.eventData.type()==k.EVENT_TYPE_STALL||a.eventData.type()==k.EVENT_TYPE_BUFFER?(!a.filterReport||a.eventData.duration()>u)&&b.push(a):b.push(a)}),b}function e(a){var b=-1,c=-1,d=[];return a.forEach(function(a){a.eventData.type()==k.EVENT_TYPE_START?a.assetData.type()==l.TYPE_MAIN_CONTENT?-1==b?b=d.push(a)-1:(a.eventData.prevTs(-1),d[b]=a):-1==c?c=d.push(a)-1:(a.eventData.prevTs(-1),d[c]=a):d.push(a)}),d}function f(a){var b=[];return a.forEach(function(c){if(c.eventData.type()==k.EVENT_TYPE_PLAY){if(c.eventData.duration()>t)b.push(c);else if(0==c.eventData.duration()&&c.assetData.type()==l.TYPE_MAIN_CONTENT){var d=g(a);d.indexOf(c)==d.length-1&&b.push(c)}}else b.push(c)}),b}function g(a){var b=[];return a.forEach(function(a){a.eventData.type()!=k.EVENT_TYPE_PLAY&&a.eventData.type()!=k.EVENT_TYPE_BUFFER&&a.eventData.type()!=k.EVENT_TYPE_START||b.push(a)}),b}var h=a.radio.Command,i=a.radio.CommandQueue,j=a.Event,k=b.model.EventDao,l=b.model.AssetDao;c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this._logger.debug(w,"#destroy()"),this._uninstallEventListeners(),this.clear())},c.prototype.clear=function(){this._logger.debug(w,"#clear()"),this._workQueue.cancelAllCommands(),this._reportBuffer={},this._tsHistory={},this._isBufferingInProgress=!1},c.prototype.flush=function(){this._workQueue.addCommand(new h(this._flushBufferReport,this))},c.prototype._bufferReport=function(a){if(!this._isDestroyed){var b=a[q];if(b){var c=b.sessionData.sessionId();this._reportBuffer[c]=this._reportBuffer[c]||[],this._reportBuffer[c].push(b)}if(!this._isBufferingInProgress){this._isBufferingInProgress=!0;var d={};d[p]=!0,d[r]=1,this._channel.command(s,d)}}},c.prototype._flushBufferReport=function(){function a(a){if(a)for(var c=0;c<a.length;c++){var d=a[c],e=d.sessionData.sessionId();b._tsHistory[e]=b._tsHistory[e]||{};var f=d.eventData.type()+"."+(d.assetData.type()==l.TYPE_AD?d.assetData.adData().adId():d.assetData.videoId());b._tsHistory[e].hasOwnProperty(f)&&d.eventData.prevTs(b._tsHistory[e][f]),b._tsHistory[e][f]=d.eventData.ts()}}if(!this._isDestroyed){var b=this;for(var c in this._reportBuffer)if(this._reportBuffer.hasOwnProperty(c)){var g=f(e(d(this._reportBuffer[c])));a(g);for(var h=0;h<g.length;h++){var i=g[h],k={};k[q]=i,this._channel.trigger(new j(n,k))}}this._reportBuffer={};var m=this._channel.request(v),o=this._tsHistory[m]||{};this._tsHistory={},this._tsHistory[m]=o,this._isBufferingInProgress=!1}},c.prototype._onContextReportAvailable=function(a){var b=a.data;this._workQueue.addCommand(new h(this._bufferReport,this,[b]))},c.prototype._onClockFlushFilterTick=function(a){this.flush()},c.prototype._installEventListeners=function(){this._channel.on(m,this._onContextReportAvailable,this),this._channel.on(o,this._onClockFlushFilterTick,this)},c.prototype._uninstallEventListeners=function(){this._channel.off(null,null,this)};var m="context:report_available",n="filter:data_available",o="clock:flush_filter.tick",p="reset",q="report",r="repeat_count",s="clock:flush_filter.resume",t=250,u=250,v="session_id",w="ah::ReportFilter";b.filter.ReportFilter=c}(a.ADB.core,b),function(a,b){"use strict";function c(a,b){this._onFail={fn:a,ctx:b}}var d=a.ErrorInfo;c.prototype.validateFields=function(a,b){if(!a)return this._fail("Data cannot be null");if(b)for(var c=0;c<b.length;c++){var d=b[c];switch(d){case"videoId":if(!a.hasOwnProperty("videoId"))return this._fail("The ID for the main video must be specified.");if("string"!=typeof a.videoId)return this._fail("The ID for the main video must be a String.");if(""===a.videoId)return this._fail("The ID for the main video cannot be an empty string.");break;case"streamType":if(!a.hasOwnProperty("streamType"))return this._fail("The stream type for the main video must be specified.");if("string"!=typeof a.streamType)return this._fail("The stream type for the main video must be a String.");if(""===a.streamType)return this._fail("The stream type for the main video cannot be an empty string.");break;case"videoLength":if(!a.hasOwnProperty("videoLength"))return this._fail("The length of the main video must be specified.");if("number"!=typeof a.videoLength)return this._fail("The length of the main video must be a Number.");if(isNaN(a.videoLength))return this._fail("The length of the main video cannot be NaN.");break;case"playhead":if(!a.hasOwnProperty("playhead"))return this._fail("The playhead for the main video must be specified.");if("number"!=typeof a.playhead)return this._fail("The playhead for the main video must be a Number.");if(isNaN(a.playhead))return this._fail("The playhead for the main video cannot be NaN.");break;case"playerName":if(!a.hasOwnProperty("playerName"))return this._fail("The player name for the main video must be specified.");if("string"!=typeof a.playerName)return this._fail("The player name for the main video must be a String.");if(""===a.playerName)return this._fail("The player name for the main video cannot be an empty string.");break;case"rsid":if(!a.hasOwnProperty("rsid"))return this._fail("account (rsid) is required and has to be set in the AppMeasurement instance.");if("string"!=typeof a.rsid)return this._fail("account (rsid) of the AppMeasurement instance must be a String.");if(""===a.rsid)return this._fail("account (rsid) of the AppMeasurement instance  cannot be an empty string.");break;case"trackingServer":if(!a.hasOwnProperty("trackingServer"))return this._fail("trackingServer is required and has to be set in the AppMeasurement instance.");if("string"!=typeof a.trackingServer)return this._fail("trackingServer of the AppMeasurement instance must be a String.");if(""===a.trackingServer)return this._fail("trackingServer of the AppMeasurement instance cannot be an empty string.");break;case"podPlayerName":if(!a.hasOwnProperty("podPlayerName"))return this._fail("The player name for the ad-break must be specified.");if("string"!=typeof a.podPlayerName)return this._fail("The player name for the ad-break must be a String.");if(""===a.podPlayerName)return this._fail("The player name for the ad-break cannot be an empty string.");break;case"podPosition":if(!a.hasOwnProperty("podPosition"))return this._fail("Position (index) of the ad-break must be specified.");if("number"!=typeof a.podPosition)return this._fail("Position (index) of the ad-break must be a Number.");if(isNaN(a.podPosition))return this._fail("Position (index) of the ad-break cannot be NaN.");break;case"adId":if(!a.hasOwnProperty("adId"))return this._fail("The ad ID must be specified.");if("string"!=typeof a.adId)return this._fail("The ad ID must be a String.");if(""===a.adId)return this._fail("The ad ID cannot be an empty string.");break;case"adPosition":if(!a.hasOwnProperty("adPosition"))return this._fail("Position (index) of the ad must be specified.");if("number"!=typeof a.adPosition)return this._fail("Position (index) of the ad must be a Number.");if(isNaN(a.adPosition))return this._fail("Position (index) of the ad cannot be NaN.");break;case"chapterPosition":if(!a.hasOwnProperty("chapterPosition"))return this._fail("Position (index) of the chapter must be specified.");if("number"!=typeof a.chapterPosition)return this._fail("Position (index) of the chapter must be a Number.");if(isNaN(a.chapterPosition))return this._fail("Position (index) of the chapter cannot be NaN.");break;case"chapterOffset":if(!a.hasOwnProperty("chapterOffset"))return this._fail("Chapter start-time (offset) must be specified.");if("number"!=typeof a.chapterOffset)return this._fail("Chapter start-time (offset) must be a Number.");if(isNaN(a.chapterOffset))return this._fail("Chapter start-time (offset) cannot be NaN.");break;case"chapterLength":if(!a.hasOwnProperty("chapterLength"))return this._fail("The length of the chapter must be specified.");if("number"!=typeof a.chapterLength)return this._fail("The length of the chapter must be a Number.");if(isNaN(a.chapterLength))return this._fail("The length of the chapter cannot be NaN.");break;default:return this._fail("Unable to validate unknown parameter: "+d)}}return!0},c.prototype._fail=function(a){var b=new d("Invalid input data",a);return this._onFail.fn&&this._onFail.fn.call(this._onFail.ctx,b),!1},b.context.InputDataValidator=c}(a.ADB.va,b),function(a,b){"use strict";function c(a,b){if(!b)throw new Error("Reference to the logger object cannot be NULL");if(this._logger=b,!a)throw new Error("Reference to the context object cannot be NULL");this._context=a}var d=b.model.Report;c.prototype.createReportForItem=function(a){return this._logger.debug(e,"Creating report for item: "+a.eventData.type()),new d(this._context._adobeAnalyticsData,this._context._userData,this._context._aamData,this._context._serviceProviderData,this._context._sessionData,a)};var e="ah::ReportFactory";b.context.ReportFactory=c}(a.ADB.core,b),function(a,b,c,d){"use strict";function e(a,b){if(!a)throw new Error("Reference to the channel object cannot be NULL");if(this._channel=a,!b)throw new Error("Reference to the logger object cannot be NULL");this._logger=b,this._lastInBandItem=null,this._stashedLastInBandItem=null,this._stashedMainMetadata=null,this._autoComputedStartupTime=0,this._reportingInterval=ma,this._assetData=null,this._streamData=null,this._qosData=null,this._sessionData=null,this._cuserData=null,this._adobeAnalyticsData=new j,this._serviceProviderData=new k,this._userData=new l,this._aamData=new m,this._isTrackingSessionActive=!1,this._isVideoComplete=!1,this._isDestroyed=!1,this._doNotOverrideEventDuration=!1,this._reportFactory=new u(this,this._logger),this._inputDataValidator=new v(function(a){this._logger.error(w,a.getMessage()+" | "+a.getDetails()),this._channel.trigger(new h(y,a))},this),this._trackExternalErrors=!0,this._installEventListeners()}var f=c.md5,g=c.ObjectUtils,h=a.Event,i=d.model.SessionDao,j=d.model.AdobeAnalyticsDao,k=d.model.ServiceProviderDao,l=d.model.UserDao,m=d.model.AudienceManagerDao,n=d.model.EventDao,o=d.model.AssetDao,p=d.model.StreamDao,q=d.model.QoSDao,r=d.model.AdDao,s=d.model.ChapterDao,t=d.model.TrackItem,u=d.context.ReportFactory,v=d.context.InputDataValidator;e.prototype.destroy=function(){this._isDestroyed||(this._isDestroyed=!0,this._logger.debug(w,"#destroy()"),this._uninstallEventListeners())},e.prototype._onApiAnalyticsStart=function(a){this._logger.debug(w,"#_onApiAnalyticsStart()");var b=a.data;if(this._checkCall("_onApiAnalyticsStart")&&this._inputDataValidator.validateFields(b,["playhead"])){this._userData.visitorId(b.vid),this._userData.analyticsVisitorId(b.aid),this._userData.marketingCloudVisitorId(b.mid),this._aamData.audienceManagerBlob(b.blob),this._aamData.audienceManagerLocationHint(b.loc_hint),b.customerIDs&&(this._cuserData=b.customerIDs),this._updateQoSInfo(b);var c=new t(this,n.EVENT_TYPE_AA_START,b.playhead,null,b._eventData[E]);c.assetData.adData(null),c.assetData.type(o.TYPE_MAIN_CONTENT),this._cuserData=null,this._sendHit(c)}},e.prototype._onApiAnalyticsAdStart=function(a){this._logger.debug(w,"#_onApiAnalyticsAdStart()");var b=a.data;if(this._checkCall("_onApiAnalyticsAdStart")&&this._inputDataValidator.validateFields(b,["playhead"])){this._updateQoSInfo(b);var c=new t(this,n.EVENT_TYPE_AA_AD_START,b.playhead,null,b._eventData[E]);this._sendHit(c)}},e.prototype._onApiVideoLoad=function(a){var b=a.data;this._logger.debug(w,"#_onApiVideoLoad(rsid="+b.rsid+", aa_trackingServer="+b.trackingServer+")"),this._resetInternalState(),this._inputDataValidator.validateFields(b,["rsid","trackingServer"])&&(this._sessionData.sessionId(this._generateSessionId()),this._isTrackingSessionActive=!0)},e.prototype._onApiVideoUnload=function(a){if(this._logger.debug(w,"#_onApiVideoUnload()"),!this._isTrackingSessionActive)return void this._logger.debug(w,"#_onApiVideoUnload() > No active tracking session.");this._isTrackingSessionActive=!1},e.prototype._onApiVideoStart=function(a){var b=a.data;if(this._logger.debug(w,"#_onApiVideoStart(id="+b.videoId+", name="+b.videoName+", length="+b.videoLength+", type="+b.streamType+", playerName="+b.playerName+")"),this._checkCall("_onApiVideoStart")&&this._inputDataValidator.validateFields(b,["videoId","streamType","videoLength","playhead","playerName"])){this._lastInBandItem=null,this._stashedLastInBandItem=null,this._adobeAnalyticsData.reportSuiteId(b.rsid),this._adobeAnalyticsData.trackingServer(b.trackingServer),this._adobeAnalyticsData.ssl(Number(b.useSsl)),this._serviceProviderData.ovp(b.ovp),this._serviceProviderData.sdk(b.sdk),this._serviceProviderData.channel(b.channel),this._serviceProviderData.libVersion(b.version),this._serviceProviderData.apiLevel(b.apiLvl),this._serviceProviderData.playerName(b.playerName),this._assetData.adData(null),this._assetData.chapterData(null),this._assetData.videoId(b.videoId),this._assetData.length(b.videoLength),this._assetData.type(o.TYPE_MAIN_CONTENT),this._assetData.publisher(b.publisher),this._assetData.name(b.videoName),this._streamData.type(b.streamType),this._updateQoSInfo(b);var c=b.metaNielsen?g.merge(b.metaVideo,b.metaNielsen):b.metaVideo,d=new t(this,n.EVENT_TYPE_START,b.playhead,c,b._eventData[E]);this._sendHit(d)}},e.prototype._onApiVideoResume=function(a){var b=a.data;if(this._logger.debug(w,"#_onApiVideoResume(id="+b.videoId+", name="+b.videoName+", length="+b.videoLength+", type="+b.streamType+", playerName="+b.playerName+")"),this._checkCall("_onApiVideoResume")&&this._inputDataValidator.validateFields(b,["videoId","streamType","videoLength","playhead","playerName"])){this._assetData.videoId(b.videoId),this._assetData.length(b.videoLength),this._assetData.type(o.TYPE_MAIN_CONTENT),this._assetData.name(b.videoName),this._streamData.type(b.streamType);var c=new t(this,n.EVENT_TYPE_RESUME,b.playhead,null,b._eventData[E]);this._sendHit(c)}},e.prototype._onApiVideoSessionEnd=function(a){this._logger.debug(w,"#_onApiVideoSessionEnd()");var b=a.data;if(this._checkCall("_onApiVideoSessionEnd")&&this._inputDataValidator.validateFields(b,["playhead"])){var c=new t(this,n.EVENT_TYPE_END,b.playhead,null,b._eventData[E]);c.assetData.adData(null),c.assetData.type(o.TYPE_MAIN_CONTENT),this._sendHit(c)}},e.prototype._onApiVideoComplete=function(a){this._logger.debug(w,"#_onApiVideoComplete()");var b=a.data;if(this._checkCall("_onApiVideoComplete")){var c=new t(this,n.EVENT_TYPE_COMPLETE,this._assetData.length(),null,b._eventData[E]);this._sendHit(c),this._isVideoComplete=!0}},e.prototype._onApiVideoSkip=function(a){this._logger.debug(w,"#_onApiVideoSkip()");var b=a.data;if(this._checkCall("_onApiVideoSkip")){var c=new t(this,n.EVENT_TYPE_SKIP,b.playhead,null,b._eventData[E]);this._sendHit(c),this._isVideoComplete=!0}},e.prototype._onApiPlay=function(a){this._logger.debug(w,"#_onApiPlay()");var b=a.data;if(this._checkCall("_onApiPlay")&&this._inputDataValidator.validateFields(b,["playhead"])){this._updateQoSInfo(b);var c=new t(this,n.EVENT_TYPE_PLAY,b.playhead,null,b._eventData[E]);this._sendHit(c)}},e.prototype._onApiPause=function(a){this._logger.debug(w,"#_onApiPause()");var b=a.data;if(this._checkCall("_onApiPause")&&this._inputDataValidator.validateFields(b,["playhead"])){this._updateQoSInfo(b);var c=b.playheadStalled?n.EVENT_TYPE_STALL:n.EVENT_TYPE_PAUSE,d=new t(this,c,b.playhead,null,b._eventData[E]);b._eventData.hasOwnProperty(F)&&(d.filterReport=b._eventData[F]),this._sendHit(d)}},e.prototype._onApiBufferStart=function(a){this._logger.debug(w,"#_onApiBufferStart()");var b=a.data;if(this._checkCall("_onApiBufferStart")&&this._inputDataValidator.validateFields(b,["playhead"])){this._updateQoSInfo(b);var c=new t(this,n.EVENT_TYPE_BUFFER,b.playhead,null,b._eventData[E]);this._sendHit(c)}},e.prototype._onApiAdBreakStart=function(a){this._logger.debug(w,"#_onApiAdBreakStart()");var b=a.data;this._checkCall("_onApiAdBreakStart")&&this._inputDataValidator.validateFields(b,["playhead"])&&(this._flushLastInbandItem(b),this._updateLastInbandItemToBuffering())},e.prototype._onApiAdBreakComplete=function(a){this._logger.debug(w,"#_onApiAdBreakComplete()");var b=a.data;this._checkCall("_onApiAdBreakComplete")&&this._inputDataValidator.validateFields(b,["playhead"])&&(this._flushLastInbandItem(b),this._restoreLastInbandItem())},e.prototype._onApiAdStart=function(a){var b=a.data;if(this._logger.debug(w,"#_onApiAdStart(id="+b.adId+", player_name="+b.podPlayerName+", parent_name="+this._assetData.videoId()+", pod_pos="+b.adPosition+")"),this._checkCall("_onApiAdStart")&&this._inputDataValidator.validateFields(b,["playhead","podPosition","podPlayerName","adId","adPosition"])){var c=new r;c.adId(b.adId),c.adName(b.adName),c.adLength(b.adLength),c.resolver(b.podPlayerName),c.podId(f(this._assetData.videoId())+"_"+b.podPosition),c.podPosition(b.adPosition+""),c.podName(b.podName),c.podOffset(b.podSecond),c.sid(this._generateSessionId()),this._assetData.adData(c),this._assetData.type(o.TYPE_AD),this._updateQoSInfo(b);var d=g.merge(b.metaVideo,b.metaAd);d=b.metaNielsen?g.merge(d,b.metaNielsen):d,d=b.metaAdNielsen?g.merge(d,b.metaAdNielsen):d;var e=new t(this,n.EVENT_TYPE_START,b.playhead,d,b._eventData[E]);this._sendHit(e),this._restoreLastInbandItem();if(!!b.adGranularTracking){var h=b.adTrackingInterval?b.adTrackingInterval:this._reportingInterval;this._updateReportingInterval(h,!0)}}},e.prototype._onApiAdComplete=function(a){this._logger.debug(w,"#_onApiAdComplete()");var b=a.data;if(this._checkCall("_onApiAdComplete")&&this._inputDataValidator.validateFields(b,["playhead"])){if(this._assetData.type()!=o.TYPE_AD)return void this._logger.warn(w,"#_onApiAdComplete() > Ignoring the ad complete event, because we are no longer in an ad.");this._updateQoSInfo(b);var c=new t(this,n.EVENT_TYPE_COMPLETE,b.playhead,null,b._eventData[E]);this._sendHit(c),this._updateLastInbandItemToBuffering(),this._assetData.adData(null),this._assetData.type(o.TYPE_MAIN_CONTENT),this._updateReportingInterval(this._reportingInterval,!1)}},e.prototype._onApiAdSkip=function(a){this._logger.debug(w,"#_onApiAdSkip()");var b=a.data;if(this._checkCall("_onApiAdSkip")&&this._inputDataValidator.validateFields(b,["playhead"])){if(this._assetData.type()!=o.TYPE_AD)return void this._logger.warn(w,"#_onApiAdSkip() > Ignoring the ad skip event, because we are no longer in an ad.");this._updateQoSInfo(b);var c=new t(this,n.EVENT_TYPE_SKIP,b.playhead,null,b._eventData[E]);this._sendHit(c),this._updateLastInbandItemToBuffering(),this._assetData.adData(null),this._assetData.type(o.TYPE_MAIN_CONTENT),this._updateReportingInterval(this._reportingInterval,!1)}},e.prototype._onApiChapterStart=function(a){var b=a.data;if(this._logger.debug(w,"#_onApiChapterStart(name="+b.chapterName+", length="+b.chapterLength+", position="+b.chapterPosition+", chapter_offset="+b.chapterOffset+")"),this._checkCall("_onApiChapterStart")&&this._inputDataValidator.validateFields(b,["playhead","chapterPosition","chapterOffset","chapterLength"])){var c=new s;c.id(f(this._assetData.videoId())+"_"+b.chapterPosition),c.name(b.chapterName),c.length(b.chapterLength),c.position(b.chapterPosition),c.offset(b.chapterOffset),c.sid(this._generateSessionId()),this._assetData.chapterData(c),this._updateQoSInfo(b);var d=g.merge(b.metaVideo,b.metaChapter),e=new t(this,n.EVENT_TYPE_CHAPTER_START,b.playhead,d,b._eventData[E]);e.assetData.adData(null),e.assetData.type(o.TYPE_MAIN_CONTENT),this._sendHit(e)}},e.prototype._onApiChapterComplete=function(a){this._logger.debug(w,"#_onApiChapterComplete()");var b=a.data;if(this._checkCall("_onApiChapterComplete")&&this._inputDataValidator.validateFields(b,["playhead"])){if(!this._assetData.chapterData())return void this._logger.warn(w,"#_onApiChapterComplete() > Ignoring the chapter complete event, because we are no longer in a chapter.");this._updateQoSInfo(b);var c=new t(this,n.EVENT_TYPE_CHAPTER_COMPLETE,b.playhead,null,b._eventData[E]);c.assetData.adData(null),c.assetData.type(o.TYPE_MAIN_CONTENT),this._sendHit(c),this._assetData.chapterData(null)}},e.prototype._onApiChapterSkip=function(a){this._logger.debug(w,"#_onApiChapterSkip()");var b=a.data;if(this._checkCall("_onApiChapterSkip")&&this._inputDataValidator.validateFields(b,["playhead"])){if(!this._assetData.chapterData())return void this._logger.warn(w,"#_onApiChapterSkip() > Ignoring the chapter skip event, because we are no longer in a chapter.");this._updateQoSInfo(b);var c=new t(this,n.EVENT_TYPE_CHAPTER_SKIP,b.playhead,null,b._eventData[E]);c.assetData.adData(null),c.assetData.type(o.TYPE_MAIN_CONTENT),this._sendHit(c),this._assetData.chapterData(null)}},e.prototype._onApiBitrateChange=function(a){this._logger.debug(w,"#_onApiBitrateChange()");var b=a.data;if(this._checkCall("_onApiBitrateChange")&&this._inputDataValidator.validateFields(b,["playhead"])){this._updateQoSInfo(b);var c=new t(this,n.EVENT_TYPE_BITRATE_CHANGE,b.playhead,null,b._eventData[E]);this._sendHit(c)}},e.prototype._onApiTrackError=function(a){var b=a.data;if(this._logger.debug(w,"#_onApiTrackError(source="+b._eventData.source+", err_id="+b._eventData.error_id+")"),!this._isTrackingSessionActive)return void this._logger.warn(w,"#_onApiTrackError() > No active tracking session.");if(this._trackExternalErrors||b._eventData.source===x){this._updateQoSInfo(b);var c=new t(this,n.EVENT_TYPE_ERROR,0,null,b._eventData[E]);c.eventData.id(b._eventData.error_id),c.eventData.source(b._eventData.source),this._sendHit(c)}},e.prototype._onApiTrackInternalError=function(a){var b=a.data;this._logger.debug(w,"#_onApiTrackInternalError(source="+b.source+", err_id="+b.error_id+")"),this._updateQoSInfo(b);var c=new t(this,n.EVENT_TYPE_ERROR,0);c.eventData.id(b.error_id),c.eventData.source(b.source),this._sendHit(c)},e.prototype._onApiQuantumEnd=function(a){this._logger.debug(w,"#_onApiQuantumEnd(interval="+this._channel.request(B)+")");var b=a.data;if(this._checkCall("_onApiQuantumEnd")&&this._inputDataValidator.validateFields(b,["playhead"])){var c=this._lastInBandItem;if(c){this._updateQoSInfo(b);var d=new t(this,c.eventData.type(),b.playhead,c.meta,c.callback);d.filterReport=c.filterReport,this._sendHit(d,!0)}}},e.prototype._onNetworkCheckStatusComplete=function(a){var b=a.data;this._trackExternalErrors=b[I],this._reportingInterval=b[J],this._reportingInterval||(this._reportingInterval=ma),this._logger.debug(w,"#_onNetworkCheckStatusComplete(track_ext_err="+this._trackExternalErrors+")")},e.prototype._onResetSessionId=function(a){var b=this._generateSessionId();this._sessionData=new i,this._sessionData.sessionId(b),this._logger.debug(w,"#_resetSessionId(new sessionId="+b+")")},e.prototype._installEventListeners=function(){this._channel.on(L,this._onApiAnalyticsStart,this),this._channel.on(M,this._onApiAnalyticsAdStart,this),this._channel.on(N,this._onApiVideoLoad,this),this._channel.on(O,this._onApiVideoUnload,this),this._channel.on(P,this._onApiVideoStart,this),this._channel.on(Q,this._onApiVideoComplete,this),this._channel.on(R,this._onApiVideoSkip,this),this._channel.on(S,this._onApiVideoResume,this),this._channel.on(T,this._onApiVideoSessionEnd,this),this._channel.on(U,this._onApiAdBreakStart,this),this._channel.on(V,this._onApiAdBreakComplete,this),this._channel.on(W,this._onApiAdStart,this),this._channel.on(X,this._onApiAdComplete,this),this._channel.on(Y,this._onApiAdSkip,this),this._channel.on(Z,this._onApiPlay,this),this._channel.on($,this._onApiPause,this),this._channel.on(_,this._onApiBufferStart,this),this._channel.on(aa,this._onApiChapterStart,this),this._channel.on(ba,this._onApiChapterComplete,this),this._channel.on(ca,this._onApiChapterSkip,this),this._channel.on(fa,this._onApiBitrateChange,this),this._channel.on(da,this._onApiTrackError,this),this._channel.on(ea,this._onApiTrackInternalError,this),this._channel.on(ga,this._onApiQuantumEnd,this),this._channel.on(ia,this._onNetworkCheckStatusComplete,this),this._channel.on(D,this._onResetSessionId,this),this._channel.reply(C,function(){return this._sessionData&&this._sessionData.sessionId()?this._sessionData.sessionId():null},this)},e.prototype._uninstallEventListeners=function(){this._channel.off(null,null,this)},e.prototype._resetInternalState=function(){this._logger.debug(w,"#_resetInternalState()"),this._isTrackingSessionActive=!1,this._isVideoComplete=!1,this._autoComputedStartupTime=0,this._lastInBandItem=null,this._stashedLastInBandItem=null,this._streamData=new p,this._qosData=new q,this._sessionData=new i,this._assetData=new o,this._cuserData=null},e.prototype._generateSessionId=function(){return""+(new Date).getTime()+Math.floor(1e9*Math.random())},e.prototype._updateQoSInfo=function(a){this._qosData.bitrate(a.bitrate||0),this._qosData.fps(a.fps||0),this._qosData.droppedFrames(a.droppedFrames||0),null==a.startupTime||isNaN(a.startupTime)?(this._qosData.startupTime(this._autoComputedStartupTime),this._qosData.isStartupTimeOverridden=!1):(this._qosData.startupTime(a.startupTime),this._qosData.isStartupTimeOverridden=!0)},e.prototype._checkCall=function(a){return this._isTrackingSessionActive?!this._isVideoComplete||"_onApiVideoSessionEnd"===a||(this._logger.warn(w,"#"+a+"() > The video content already completed."),!1):(this._logger.warn(w,"#"+a+"() > No active tracking session."),!1)},e.prototype._updateReportingInterval=function(a,b){var c={};c[K]=!!b,c[J]=a,this._channel.trigger(new h(ja,c))},e.prototype._updateLastInBandItem=function(a){var b=this._lastInBandItem,c=(new Date).getTime(),d=b.assetData.type()===o.TYPE_AD||a.assetData.type()===o.TYPE_AD,e=1e3*Math.abs(a.eventData.playhead()-b.eventData.playhead()),f=Math.abs(c-b.eventData.ts()),g=Math.abs(e-f),h=f;h>ka?(this._logger.warn(w," Resetting duration in lastInBandItem["+b.assetData.type()+":"+b.eventData.type()+"] call to 0 as calculated duration ("+h+")exceeds 10mins"),h=0):b.eventData.type()==n.EVENT_TYPE_PLAY&&!d&&!this._doNotOverrideEventDuration&&g>la&&(h=Math.min(e,f),this._logger.warn(w," Resetting duration in lastInBandItem["+b.assetData.type()+":"+b.eventData.type()+"] call to "+h+" as calculated error delta ("+g+")exceeds 2sec")),this._doNotOverrideEventDuration=!1,b.eventData.duration(h),b.eventData.ts(c),b.eventData.playhead(a.eventData.playhead()),b.qosData.startupTime(a.qosData.startupTime()),b.qosData.isStartupTimeOverridden=a.qosData.isStartupTimeOverridden},e.prototype._updateLastInbandItemToBuffering=function(){this._stashedLastInBandItem=this._lastInBandItem;var a=0;null!=this._lastInBandItem&&(this._lastInBandItem.assetData.type()==o.TYPE_MAIN_CONTENT&&this._lastInBandItem.eventData.type()==n.EVENT_TYPE_START&&(this._stashedMainMetadata=this._lastInBandItem.meta),a=this._lastInBandItem.eventData.playhead());var b=new t(this,n.EVENT_TYPE_BUFFER,a,null,null);b.assetData.adData(null),b.assetData.type(o.TYPE_MAIN_CONTENT),this._lastInBandItem=b},e.prototype._restoreLastInbandItem=function(){if(null!=this._stashedLastInBandItem){var a=null;this._stashedLastInBandItem.eventData.type()==n.EVENT_TYPE_START&&(this._lastInBandItem.assetData.type()==o.TYPE_AD?a=this._lastInBandItem.meta:(a=this._stashedMainMetadata,this._stashedMainMetadata=null));var b=new t(this,this._stashedLastInBandItem.eventData.type(),this._stashedLastInBandItem.eventData.playhead(),a,this._stashedLastInBandItem.callback);b.filterReport=this._stashedLastInBandItem.filterReport,this._lastInBandItem=b,this._stashedLastInBandItem=null}},e.prototype._flushLastInbandItem=function(a){if(this._lastInBandItem){this._updateQoSInfo(a);var b=new t(this,this._lastInBandItem.eventData.type(),a.playhead,this._lastInBandItem.meta,this._lastInBandItem.callback);this._sendHit(b,!0)}},e.prototype._createAndSendReport=function(a){var b=this._reportFactory.createReportForItem(a);b.qosData.isStartupTimeOverridden||b.qosData.startupTime(this._autoComputedStartupTime);var c={};if(c[G]=b,this._channel.trigger(new h(ha,c)),b.eventData.type()==n.EVENT_TYPE_START||b.eventData.type()==n.EVENT_TYPE_PLAY||b.eventData.type()==n.EVENT_TYPE_PAUSE||b.eventData.type()==n.EVENT_TYPE_STALL||b.eventData.type()==n.EVENT_TYPE_BUFFER){var d={};d[H]=!0,this._channel.command(z,d)}},e.prototype._sendHit=function(a,b){switch(a.eventData.type()){case n.EVENT_TYPE_START:case n.EVENT_TYPE_PLAY:case n.EVENT_TYPE_PAUSE:case n.EVENT_TYPE_STALL:case n.EVENT_TYPE_BUFFER:this._lastInBandItem?(this._updateLastInBandItem(a),this._lastInBandItem.eventData.type()==n.EVENT_TYPE_START&&this._lastInBandItem.assetData.type()==o.TYPE_MAIN_CONTENT&&(this._autoComputedStartupTime+=this._lastInBandItem.eventData.duration()),this._createAndSendReport(this._lastInBandItem),b&&this._lastInBandItem.eventData.type()==a.eventData.type()||this._createAndSendReport(a)):this._createAndSendReport(a),this._lastInBandItem=a;break;case n.EVENT_TYPE_COMPLETE:case n.EVENT_TYPE_SKIP:if(this._lastInBandItem&&(this._updateLastInBandItem(a),this._createAndSendReport(this._lastInBandItem)),a.eventData.type()!==n.EVENT_TYPE_SKIP&&this._createAndSendReport(a),a.assetData.type()==o.TYPE_MAIN_CONTENT){this._lastInBandItem=null,this._stashedLastInBandItem=null;var c={};c[H]=!0,this._channel.command(A,c)}else a.assetData.type()==o.TYPE_AD&&(this._lastInBandItem.assetData.adData(null),this._lastInBandItem.assetData.type(o.TYPE_MAIN_CONTENT),this._doNotOverrideEventDuration=!0);break;case n.EVENT_TYPE_CHAPTER_START:case n.EVENT_TYPE_CHAPTER_COMPLETE:case n.EVENT_TYPE_CHAPTER_SKIP:this._lastInBandItem&&(this._updateLastInBandItem(a),this._createAndSendReport(this._lastInBandItem)),a.eventData.type()!==n.EVENT_TYPE_CHAPTER_SKIP&&this._createAndSendReport(a),this._lastInBandItem&&(this._lastInBandItem.assetData.chapterData(a.eventData.type()==n.EVENT_TYPE_CHAPTER_START?new s(a.assetData.chapterData()):null),this._lastInBandItem.eventData.duration(0),this._createAndSendReport(this._lastInBandItem));break;default:this._createAndSendReport(a)}};var w="ah::Context",x="sourceErrorSDK",y="error",z="clock:reporting.resume",A="clock:reporting.pause",B="reporting_interval",C="session_id",D="reset_session_id",E="callback",F="filter_report",G="report",H="reset",I="track_external_errors",J="reporting_interval",K="do_not_override_interval",L="api:aa_start",M="api:aa_ad_start",N="api:video_load",O="api:video_unload",P="api:video_start",Q="api:video_complete",R="api:video_skip",S="api:video_resume",T="api:video_session_end",U="api:adbreak_start",V="api:adbreak_complete",W="api:ad_start",X="api:ad_complete",Y="api:ad_skip",Z="api:play",$="api:pause",_="api:buffer_start",aa="api:chapter_start",ba="api:chapter_complete",ca="api:chapter_skip",da="api:track_error",ea="api:track_internal_error",fa="api:bitrate_change",ga="api:quantum_end",ha="context:report_available",ia="net:check_status_complete",ja="reporting:update_interval",ka=6e5,la=2e3,ma=10;d.context.Context=e}(a.ADB.core,a.ADB.va,a.ADB.va.utils,b),function(a){"use strict";function b(a,b){this.trackingServer=a,this.publisher=b,this.ssl=!1,this.ovp=c,this.sdk=c,this.quietMode=!1,this.debugLogging=!1,this.__isPrimetime=!1,this.__psdkVersion=null}var c="unknown";a.AdobeHeartbeatPluginConfig=b}(b),function(a){"use strict";function b(){}b.prototype.onError=function(a){},b.prototype.onTrackingDisabled=function(){},a.AdobeHeartbeatPluginDelegate=b}(b),function(a,b,c){"use strict";function d(a){d.__super__.constructor.call(this,q),this._radio=new i(this._logger),this._channel=this._radio.channel(y),this._delegate=a,this._context=new l(this._channel,this._logger),this._filter=new m(this._channel,this._logger),this._network=new n(this._channel,this._logger),this._setupDataResolver()}var e=a.Event,f=a.Trigger,g=a.plugin.BasePlugin,h=a.plugin.ParamMapping,i=a.radio.Radio,j=b.ErrorInfo,k=b.Version,l=c.context.Context,m=c.filter.ReportFilter,n=c.network.Network,o=c.clock.Clock,p=c.AdobeHeartbeatPluginConfig;a.extend(d,g),d.prototype.configure=function(a){if(!a)throw new Error("Reference to the configuration data cannot be NULL.");if(!(a instanceof p))throw new Error("Expected config data to be instance of AdobeHeartbeatPluginConfig.");this._config=a,this._config.debugLogging?this._logger.enable():this._logger.disable(),this._logger.debug(this._logTag,"#configure({trackingServer="+this._config.trackingServer+", publisher="+this._config.publisher+", quietMode="+this._config.quietMode+", ssl="+this._config.ssl+"})");var b=this._config.trackingServer+"/settings/",c={};c[ja]=this._config.trackingServer,c[ka]=b,c[la]=this._config.publisher,c[ma]=this._config.quietMode,c[na]=this._config.ssl,this._channel.trigger(new e(sa,c)),this._isConfigured=!0},d.prototype.bootstrap=function(a){d.__super__.bootstrap.call(this,a),this._channel.on(z,this._onError,this),this._clock=new o(this._pluginManager,this._channel,this._logger),this._channel.command(Ra),this._channel.trigger(new e(Ya)),this._channel.on(pa,this._onCheckStatusComplete,this),this._registerCommands(),this._registerBehaviours()},d.prototype._teardown=function(){this._logger.debug(this._logTag,"#_teardown()"),this._radio.shutdown(),this._context.destroy(),this._clock.destroy(),this._filter.destroy(),this._network.destroy()},d.prototype._canProcess=function(){return this._isConfigured?this._errorInfo?(this._logger.error(this._logTag,"_canProcess() > Plugin in ERROR state."),!1):d.__super__._canProcess.call(this):(this._logger.error(this._logTag,"_canProcess() > Plugin not configured."),!1)},d.prototype._cmdAnalyticsError=function(a){this._errorInfo||(this._errorInfo=new j("Internal error","AdobeAnalyticsPlugin is in ERROR state."),this._trigger(z,this._errorInfo),this._delegate&&this._delegate.onError(this._errorInfo))},d.prototype._cmdAnalyticsStart=function(a){this._canProcess()&&this._channel.trigger(new e(qa,a))},d.prototype._cmdAnalyticsAdStart=function(a){this._canProcess()&&this._channel.trigger(new e(ra,a))},d.prototype._cmdVideoLoad=function(a){this._errorInfo=null,this._canProcess()&&(this._isTrackingSessionActive&&this._channel.trigger(new e(ua,a)),this._isTrackingSessionActive=!1,this._isPaused=!0,this._isSeeking=!1,this._isBuffering=!1,this._isVideoIdle=!1,this._filter.clear(),this._channel.trigger(new e(ta,a)),this._isTrackingSessionActive=!0)},d.prototype._cmdVideoUnload=function(a){this._errorInfo=null,this._canProcess()&&(this._channel.trigger(new e(ua,a)),this._filter.flush(),this._runReportingTimer(!1),this._runFlushFilterTimer(!1),this._runIdleTimer(!1),this._isTrackingSessionActive=!1)},d.prototype._cmdBeginReporting=function(a){this._canProcess()&&this._channel.trigger(new e(Pa,{}))},d.prototype._cmdVideoSessionEnd=function(a){this._canProcess()&&this._channel.trigger(new e(za,a))},d.prototype._cmdVideoStart=function(a){this._canProcess()&&(this._channel.trigger(new e(va,a)),this._filter.flush())},d.prototype._cmdVideoComplete=function(a){this._canProcess()&&this._channel.trigger(new e(wa,a))},d.prototype._cmdVideoSkip=function(a){this._canProcess()&&this._channel.trigger(new e(xa,a))},d.prototype._cmdVideoResume=function(a){this._canProcess()&&this._channel.trigger(new e(ya,a))},d.prototype._cmdPlay=function(a){this._canProcess()&&(this._isPaused=!1,this._resumePlaybackIfPossible(a))},d.prototype._cmdPause=function(a){this._canProcess()&&(this._channel.trigger(new e(Ga,a)),this._isPaused=!0,this._runIdleTimer(!0))},d.prototype._cmdAdBreakStart=function(a){this._canProcess()&&this._channel.trigger(new e(Aa,a))},d.prototype._cmdAdBreakComplete=function(a){this._canProcess()&&(this._channel.trigger(new e(Ba,a)),this._resumePlaybackIfPossible(a))},d.prototype._cmdAdStart=function(a){this._canProcess()&&(this._channel.trigger(new e(Ca,a)),this._resumePlaybackIfPossible(a))},d.prototype._cmdAdComplete=function(a){this._canProcess()&&this._channel.trigger(new e(Da,a))},d.prototype._cmdAdSkip=function(a){this._canProcess()&&this._channel.trigger(new e(Ea,a))},d.prototype._cmdBufferStart=function(a){this._canProcess()&&(this._channel.trigger(new e(Ha,a)),this._isBuffering=!0,this._runIdleTimer(!0))},d.prototype._cmdBufferComplete=function(a){this._canProcess()&&(this._isBuffering=!1,this._isPaused?this._channel.trigger(new e(Ga,a)):this._resumePlaybackIfPossible(a))},d.prototype._cmdSeekStart=function(a){this._canProcess()&&(this._channel.trigger(new e(Ga,a)),this._isSeeking=!0,this._runIdleTimer(!0))},d.prototype._cmdSeekComplete=function(a){this._canProcess()&&(this._isSeeking=!1,this._resumePlaybackIfPossible(a))},d.prototype._cmdChapterStart=function(a){this._canProcess()&&this._channel.trigger(new e(Ia,a))},d.prototype._cmdChapterComplete=function(a){this._canProcess()&&this._channel.trigger(new e(Ja,a))},d.prototype._cmdChapterSkip=function(a){this._canProcess()&&this._channel.trigger(new e(Ka,a))},d.prototype._cmdBitrateChange=function(a){this._canProcess()&&this._channel.trigger(new e(Na,a))},d.prototype._cmdTrackError=function(a){this._canProcess()&&this._channel.trigger(new e(La,a))},d.prototype._cmdClockReportingTick=function(a){this._canProcess()&&this._channel.trigger(new e(Oa,a))},d.prototype._onCheckStatusComplete=function(a){if(this._canProcess()){var b=!1;a&&a.data&&a.data[oa]&&(b=a.data[oa]),this._logger.debug(this._logTag,"#_onCheckStatusComplete(trackingDisabled="+b+")"),b&&this._delegate&&this._delegate.onTrackingDisabled()}},d.prototype._cmdIdleTick=function(a){this._canProcess()&&(this._isVideoIdle=!0,this._trigger(aa),this._channel.trigger(new e(za,a)),this._filter.flush(),this._runReportingTimer(!1),this._runFlushFilterTimer(!1),this._runIdleTimer(!1),this._trigger($))},d.prototype._onError=function(a){this._errorInfo=a.data;var b={};b[ha]=Qa,b[ia]=this._errorInfo.getMessage()+"|"+this._errorInfo.getDetails(),this._channel.trigger(new e(Ma,b)),this._runReportingTimer(!1),this._trigger(z,this._errorInfo),this._delegate&&this._delegate.onError(this._errorInfo)},d.prototype._runIdleTimer=function(a){var b={};b[ga]=!0,a?this._channel.command(Wa,b):this._channel.command(Xa,b)},d.prototype._runFlushFilterTimer=function(a){var b={};b[ga]=!0,a?this._channel.command(Ua,b):this._channel.command(Va,b)},d.prototype._runReportingTimer=function(a){var b={};b[ga]=!0,a?this._channel.command(Sa,b):this._channel.command(Ta,b)},d.prototype._registerCommands=function(){this._pluginManager.comply(this,"handleAnalyticsError",this._cmdAnalyticsError),this._pluginManager.comply(this,"handleAnalyticsStart",this._cmdAnalyticsStart),this._pluginManager.comply(this,"handleAnalyticsAdStart",this._cmdAnalyticsAdStart),this._pluginManager.comply(this,"handleVideoLoad",this._cmdVideoLoad),this._pluginManager.comply(this,"handleVideoUnload",this._cmdVideoUnload),this._pluginManager.comply(this,"handleBeginReporting",this._cmdBeginReporting),this._pluginManager.comply(this,"handleVideoSessionEnd",this._cmdVideoSessionEnd),this._pluginManager.comply(this,"handleVideoStart",this._cmdVideoStart),this._pluginManager.comply(this,"handleVideoComplete",this._cmdVideoComplete),this._pluginManager.comply(this,"handleVideoSkip",this._cmdVideoSkip),this._pluginManager.comply(this,"handleVideoResume",this._cmdVideoResume),this._pluginManager.comply(this,"handlePlay",this._cmdPlay),this._pluginManager.comply(this,"handlePause",this._cmdPause),this._pluginManager.comply(this,"handleAdBreakStart",this._cmdAdBreakStart),this._pluginManager.comply(this,"handleAdBreakComplete",this._cmdAdBreakComplete),this._pluginManager.comply(this,"handleAdStart",this._cmdAdStart),this._pluginManager.comply(this,"handleAdComplete",this._cmdAdComplete),this._pluginManager.comply(this,"handleAdSkip",this._cmdAdSkip),this._pluginManager.comply(this,"handleBufferStart",this._cmdBufferStart),this._pluginManager.comply(this,"handleBufferComplete",this._cmdBufferComplete),this._pluginManager.comply(this,"handleSeekStart",this._cmdSeekStart),this._pluginManager.comply(this,"handleSeekComplete",this._cmdSeekComplete),this._pluginManager.comply(this,"handleChapterStart",this._cmdChapterStart),this._pluginManager.comply(this,"handleChapterComplete",this._cmdChapterComplete),this._pluginManager.comply(this,"handleChapterSkip",this._cmdChapterSkip),this._pluginManager.comply(this,"handleBitrateChange",this._cmdBitrateChange),this._pluginManager.comply(this,"handleTrackError",this._cmdTrackError),this._pluginManager.comply(this,"handleClockReportingTick",this._cmdClockReportingTick),this._pluginManager.comply(this,"handleIdleTick",this._cmdIdleTick)},d.prototype._registerBehaviours=function(){this._pluginManager.registerBehaviour(new f(t,C),this,"handleVideoLoad",[new h(s,"rsid","rsid"),new h(s,"tracking_server","trackingServer")]),this._pluginManager.registerBehaviour(new f(t,D),this,"handleVideoUnload"),this._pluginManager.registerBehaviour(new f(t,ba),this,"handleBeginReporting"),this._pluginManager.registerBehaviour(new f(t,E),this,"handleVideoSessionEnd",[new h(t,"video.playhead","playhead")]),this._pluginManager.registerBehaviour(new f(t,F),this,"handleVideoStart",[new h(t,"video.id","videoId"),new h(t,"video.name","videoName"),new h(t,"video.length","videoLength"),new h(t,"video.playhead","playhead"),new h(t,"video.playerName","playerName"),new h(t,"video.streamType","streamType"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime"),new h(s,"rsid","rsid"),new h(s,"tracking_server","trackingServer"),new h(s,"channel","channel"),new h(s,"meta.video.*","metaVideo"),new h(s,"ssl","useSsl"),new h(u,"meta","metaNielsen"),new h(r,"publisher","publisher"),new h(r,"sdk","sdk"),new h(r,"ovp","ovp"),new h(r,"version","version"),new h(r,"api_level","apiLvl")]),this._pluginManager.registerBehaviour(new f(t,H),this,"handleVideoComplete",[new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(t,I),this,"handleVideoSkip",[new h(t,"video.playhead","playhead"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(t,G),this,"handleVideoResume",[new h(t,"video.id","videoId"),new h(t,"video.name","videoName"),new h(t,"video.length","videoLength"),new h(t,"video.playhead","playhead"),new h(t,"video.playerName","playerName"),new h(t,"video.streamType","streamType")]),this._pluginManager.registerBehaviour(new f(t,J),this,"handlePlay",[new h(t,"video.playhead","playhead"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(t,K),this,"handlePause",[new h(t,"video.playhead","playhead"),new h(t,"video.playheadStalled","playheadStalled"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(t,M),this,"handleAdBreakStart",[new h(t,"ad.isInAdBreak","isInAdBreak"),new h(t,"video.playhead","playhead"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(t,N),this,"handleAdBreakComplete",[new h(t,"ad.isInAdBreak","isInAdBreak"),new h(t,"video.playhead","playhead"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(t,O),this,"handleAdStart",[new h(t,"video.playhead","playhead"),new h(t,"ad.id","adId"),new h(t,"ad.name","adName"),new h(t,"ad.length","adLength"),new h(t,"ad.position","adPosition"),new h(t,"ad.granularTracking","adGranularTracking"),new h(t,"ad.trackingInterval","adTrackingInterval"),new h(t,"pod.name","podName"),new h(t,"pod.playerName","podPlayerName"),new h(t,"pod.position","podPosition"),new h(t,"pod.startTime","podSecond"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime"),new h(s,"meta.video.*","metaVideo"),new h(s,"meta.ad.*","metaAd"),new h(u,"meta","metaNielsen"),new h(u,"metaAd","metaAdNielsen")]),this._pluginManager.registerBehaviour(new f(t,P),this,"handleAdComplete",[new h(t,"video.playhead","playhead"),new h(t,"ad.isInAdBreak","isInAdBreak"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(t,Q),this,"handleAdSkip",[new h(t,"video.playhead","playhead"),new h(t,"ad.isInAdBreak","isInAdBreak"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(t,R),this,"handleBufferStart",[new h(t,"video.playhead","playhead"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(t,S),this,"handleBufferComplete",[new h(t,"video.playhead","playhead"),new h(t,"video.playheadStalled","playheadStalled"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(t,T),this,"handleSeekStart",[new h(t,"video.playhead","playhead")]),this._pluginManager.registerBehaviour(new f(t,U),this,"handleSeekComplete",[new h(t,"video.playhead","playhead"),new h(t,"ad.isInAd","isInAd"),new h(t,"ad.id","adId"),new h(t,"ad.position","adPosition"),new h(t,"pod.playerName","podPlayerName"),new h(t,"pod.position","podPosition"),new h(t,"chapter.isInChapter","isInChapter"),new h(t,"chapter.position","chapterPosition"),new h(t,"chapter.name","chapterName"),new h(t,"chapter.length","chapterLength"),new h(t,"chapter.startTime","chapterOffset"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(t,V),this,"handleChapterStart",[new h(t,"video.playhead","playhead"),new h(t,"chapter.position","chapterPosition"),new h(t,"chapter.name","chapterName"),new h(t,"chapter.length","chapterLength"),new h(t,"chapter.startTime","chapterOffset"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime"),new h(s,"meta.video.*","metaVideo"),new h(s,"meta.chapter.*","metaChapter"),new h(u,"meta","metaNielsen")]),this._pluginManager.registerBehaviour(new f(t,W),this,"handleChapterComplete",[new h(t,"video.playhead","playhead"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(t,X),this,"handleChapterSkip",[new h(t,"video.playhead","playhead"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(t,Y),this,"handleBitrateChange",[new h(t,"video.playhead","playhead"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(t,Z),this,"handleTrackError"),this._pluginManager.registerBehaviour(new f(v,da),this,"handleClockReportingTick",[new h(t,"video.playhead","playhead"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(t,L),this,"handleClockReportingTick",[new h(t,"video.playhead","playhead"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(v,fa),this,"handleIdleTick",[new h(t,"video.playhead","playhead")]),this._pluginManager.registerBehaviour(new f(r,aa),this,"handleClockReportingTick",[new h(t,"video.playhead","playhead"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(s,z),this,"handleAnalyticsError"),this._pluginManager.registerBehaviour(new f(s,A),this,"handleAnalyticsStart",[new h(s,"vid","vid"),new h(s,"aid","aid"),new h(s,"mid","mid"),new h(s,"customerIDs","customerIDs"),new h(s,"blob","blob"),new h(s,"loc_hint","loc_hint"),new h(t,"video.playhead","playhead"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")]),this._pluginManager.registerBehaviour(new f(s,B),this,"handleAnalyticsAdStart",[new h(t,"video.playhead","playhead"),new h(t,"qos.fps","fps"),new h(t,"qos.droppedFrames","droppedFrames"),new h(t,"qos.bitrate","bitrate"),new h(t,"qos.startupTime","startupTime")])},d.prototype._setupDataResolver=function(){var a={},b=this;a.version=function(){return k.getVersion()},a.api_level=function(){return k.getApiLevel()},a.tracking_server=function(){return b._config?b._config.trackingServer:null},a.publisher=function(){return b._config?b._config.publisher:null},a.quiet_mode=function(){return!!b._config&&b._config.quietMode},a.ovp=function(){return b._config?b._config.ovp:null},a.sdk=function(){return b._config?b._config.sdk:null},a.is_primetime=function(){return!!b._config&&b._config.__isPrimetime},a.psdk_version=function(){return b._config?b._config.__psdkVersion:null},a.session_id=function(){return b._channel.request(w)},this._dataResolver=function(b){if(!b||0==b.length)return null;for(var c=null,d=0;d<b.length;d++){var e=b[d];c=c||{},c[e]=a.hasOwnProperty(e)?a[e].call(this):null}return c}},d.prototype._resumePlaybackIfPossible=function(a){this._errorInfo||this._isPaused||this._isSeeking||this._isBuffering||(this._isVideoIdle?(this._isVideoIdle=!1,this._resumePlaybackFromIdle()):this._channel.trigger(new e(Fa,a)),this._runIdleTimer(!1))},d.prototype._resumePlaybackFromIdle=function(){this._trigger(aa),this._filter.clear(),this._channel.trigger(new e(x)),this._trigger(_),this._runReportingTimer(!0),this._runFlushFilterTimer(!0)};var q="adobe-heartbeat",r=q,s="adobe-analytics",t="player",u="nielsen",v="service.clock",w="session_id",x="reset_session_id",y="heartbeat-channel",z="error",A="aa_start",B="sc_ad_start",C="video_load",D="video_unload",E="video_session_end",F="video_start",G="video_resume",H="video_complete",I="video_skip",J="play",K="pause",L="content_start",M="adbreak_start",N="adbreak_complete",O="ad_start",P="ad_complete",Q="ad_skip",R="buffer_start",S="buffer_complete",T="seek_start",U="seek_complete",V="chapter_start",W="chapter_complete",X="chapter_skip",Y="bitrate_change",Z="track_error",$="video_idle_start",_="video_idle_resume",aa="quantum_close",ba="video_begin_reporting",ca="heartbeat.reporting",da=ca+".tick",ea="heartbeat.idle",fa=ea+".tick",ga="reset",ha="source",ia="error_id",ja="tracking_server",ka="check_status_server",la="publisher",ma="quiet_mode",na="ssl",oa="tracking_disabled",pa="net:check_status_complete",qa="api:aa_start",ra="api:aa_ad_start",sa="api:config",ta="api:video_load",ua="api:video_unload",va="api:video_start",wa="api:video_complete",xa="api:video_skip",ya="api:video_resume",za="api:video_session_end",Aa="api:adbreak_start",Ba="api:adbreak_complete",Ca="api:ad_start",Da="api:ad_complete",Ea="api:ad_skip",Fa="api:play",Ga="api:pause",Ha="api:buffer_start",Ia="api:chapter_start",Ja="api:chapter_complete",Ka="api:chapter_skip",La="api:track_error",Ma="api:track_internal_error",Na="api:bitrate_change",Oa="api:quantum_end",Pa="api:video_begin_reporting",Qa="sourceErrorHeartbeat",Ra="clock:check_status.resume",Sa="clock:reporting.resume",Ta="clock:reporting.pause",Ua="clock:flush_filter.resume",Va="clock:flush_filter.pause",Wa="clock:idle.resume",Xa="clock:idle.pause",Ya="clock:check_status.get_settings";c.AdobeHeartbeatPlugin=d}(a.ADB.core,a.ADB.va,b),a.ADB.va.plugins.ah||(a.ADB.va.plugins.ah=b)}(this);\n\n// AdobeAnalyticsPlugin\n!function(a){if(void 0===b)var b={};!function(a,b){"use strict";function c(a,b){this._onFail={fn:a,ctx:b}}var d=a.ErrorInfo;c.prototype.validateFields=function(a,b){if(!a)return this._fail("Data cannot be null");if(b)for(var c=0;c<b.length;c++){var d=b[c];switch(d){case"videoId":if(!a.hasOwnProperty("videoId"))return this._fail("The ID for the main video must be specified.");if("string"!=typeof a.videoId)return this._fail("The ID for the main video must be a String.");if(""===a.videoId)return this._fail("The ID for the main video cannot be an empty string.");break;case"mediaType":if(!a.hasOwnProperty("mediaType"))return this._fail("The media type for the main video must be specified.");if("string"!=typeof a.mediaType)return this._fail("The media type for the main video must be a String.");if(""===a.mediaType)return this._fail("The stream type for the main video cannot be an empty string.");break;case"streamType":if(!a.hasOwnProperty("streamType"))return this._fail("The stream type for the main video must be specified.");if("string"!=typeof a.streamType)return this._fail("The stream type for the main video must be a String.");if(""===a.streamType)return this._fail("The stream type for the main video cannot be an empty string.");break;case"playerName":if(!a.hasOwnProperty("playerName"))return this._fail("The player name for the main video must be specified.");if("string"!=typeof a.playerName)return this._fail("The player name for the main video must be a String.");if(""===a.playerName)return this._fail("The player name for the main video cannot be an empty string.");break;case"videoLength":if(!a.hasOwnProperty("videoLength"))return this._fail("The length of the main video must be specified.");if("number"!=typeof a.videoLength)return this._fail("The length of the main video must be a Number.");if(isNaN(a.videoLength))return this._fail("The length of the main video cannot be NaN.");break;case"podPlayerName":if(!a.hasOwnProperty("podPlayerName"))return this._fail("The player name for the ad-break must be specified.");if("string"!=typeof a.podPlayerName)return this._fail("The player name for the ad-break must be a String.");if(""===a.podPlayerName)return this._fail("The player name for the ad-break cannot be an empty string.");break;case"podPosition":if(!a.hasOwnProperty("podPosition"))return this._fail("Position (index) of the ad-break must be specified.");if("number"!=typeof a.podPosition)return this._fail("Position (index) of the ad-break must be a Number.");if(isNaN(a.podPosition))return this._fail("Position (index) of the ad-break cannot be NaN.");break;case"adId":if(!a.hasOwnProperty("adId"))return this._fail("The ad ID must be specified.");if("string"!=typeof a.adId)return this._fail("The ad ID must be a String.");if(""===a.adId)return this._fail("The ad ID cannot be an empty string.");break;case"adPosition":if(!a.hasOwnProperty("adPosition"))return this._fail("Position (index) of the ad must be specified.");if("number"!=typeof a.adPosition)return this._fail("Position (index) of the ad must be a Number.");if(isNaN(a.adPosition))return this._fail("Position (index) of the ad cannot be NaN.");break;case"adLength":if(!a.hasOwnProperty("adLength"))return this._fail("The length of the ad must be specified.");if("number"!=typeof a.adLength)return this._fail("The length of the ad must be a Number.");if(isNaN(a.adLength))return this._fail("The length of the ad cannot be NaN.");break;default:return this._fail("Unable to validate unknown parameter: "+d)}}return!0},c.prototype._fail=function(a){var b=new d("Invalid input data",a);return this._onFail.fn&&this._onFail.fn.call(this._onFail.ctx,b),!1},b.InputDataValidator=c}(a.ADB.va,b),function(a){"use strict";function b(){this.channel=c,this.debugLogging=!1}var c="";a.AdobeAnalyticsPluginConfig=b}(b),function(a){"use strict";function b(){}b.prototype.onError=function(a){},a.AdobeAnalyticsPluginDelegate=b}(b),function(a,b,c,d){"use strict";function e(a){this._aaPlugin=a}function f(a,b){if(f.__super__.constructor.call(this,s),!a)throw new Error("The reference to the AppMeasurement object cannot be NULL.");if(a.unsupportedBrowser)throw new Error("AppMeasurement is not supported in current browser.");this._appMeasurement=a,this._appMeasurementBridge=new e(this),this._delegate=b,this._videoMetadata={},this._adMetadata={},this._chapterMetadata={},this._errorInfo=null,this._appMeasurementReady=!1,this._beginReporting=!1,this._workQueue=new l(!0,x),this._inputDataValidator=new r(function(a){this._errorInfo=a,this._logger.error(this._logTag,a.getMessage()+" | "+a.getDetails());var b=this;setTimeout(function(){b._trigger(y,a),b._delegate&&b._delegate.onError(b._errorInfo)},0)},this),this._appMeasurement.isReadyToTrack(),this._setupDataResolver()}var g=a.Trigger,h=a.plugin.BasePlugin,i=a.plugin.ParamMapping,j=a.radio.Channel,k=a.radio.Command,l=a.radio.CommandQueue,m=b.ErrorInfo,n=c.md5,o=c.StringUtils,p=c.ObjectUtils,q=d.AdobeAnalyticsPluginConfig,r=d.InputDataValidator;e.prototype.onAppMeasurementReady=function(){this._aaPlugin&&this._aaPlugin._onAppMeasurementReady()},e.prototype.release=function(){this._aaPlugin=null},a.extend(f,h),f.prototype.configure=function(a){if(!a)throw new Error("Reference to the configuration data cannot be NULL.");if(!(a instanceof q))throw new Error("Expected config data to be instance of AdobeAnalyticsPluginConfig.");this._config=a,this._config.debugLogging?this._logger.enable():this._logger.disable(),this._logger.debug(this._logTag,"#configure({trackingServer="+this._config.debugLogging+", channel="+this._config.channel+", ssl="+this._appMeasurement.ssl+"})")},f.prototype.bootstrap=function(a){f.__super__.bootstrap.call(this,a),this._registerCommands(),this._registerBehaviours()},f.prototype.setup=function(){this._appMeasurement.isReadyToTrack()?this._onAppMeasurementReady():this._appMeasurement.callbackWhenReadyToTrack(this._appMeasurementBridge,this._appMeasurementBridge.onAppMeasurementReady,[]),f.__super__.setup.call(this)},f.prototype.setVideoMetadata=function(a){this._videoMetadata=p.clone(a)},f.prototype.setAdMetadata=function(a){this._adMetadata=p.clone(a)},f.prototype.setChapterMetadata=function(a){this._chapterMetadata=p.clone(a)},f.prototype._teardown=function(){this._logger.debug(this._logTag,"#_teardown()"),this._appMeasurementBridge.release()},f.prototype._canProcess=function(){return this._errorInfo?(this._logger.error(this._logTag,"#_canProcess() > In ERROR state."),!1):f.__super__._canProcess.call(this)},f.prototype._cmdVideoLoad=function(a){this._errorInfo=null},f.prototype._cmdBeginReporting=function(a){this._logger.debug(this._logTag,"#_cmdBeginReporting()"),this._beginReporting=!0,this._resumeWorkQueue()},f.prototype._cmdVideoStart=function(a){this._logger.debug(this._logTag,"#_cmdVideoStart()"),this._canProcess()&&this._workQueue.addCommand(new k(this._executeOpen,this,[a]))},f.prototype._cmdAdStart=function(a){this._logger.debug(this._logTag,"#_cmdAdStart()"),this._canProcess()&&this._workQueue.addCommand(new k(this._executeOpenAd,this,[a]))},f.prototype._cmdHeartbeatPluginError=function(a){this._errorInfo||(this._errorInfo=new m("Internal error","HeartbeatPlugin is in ERROR state."),this._trigger(y,this._errorInfo),this._delegate&&this._delegate.onError(this._errorInfo))},f.prototype._track=function(a){try{var b=this._appMeasurement.linkTrackVars;this._appMeasurement.linkTrackVars="",this._appMeasurement.track(a),this._appMeasurement.linkTrackVars=b}catch(a){this._logger.warn(this._logTag,"appMeasurement.track() call threw an exception.")}},f.prototype._executeOpen=function(a){if(this._logger.debug(this._logTag,"#_executeOpen(id="+a.videoId+", videoName="+a.videoName+", mediaType="+a.mediaType+", streamType="+a.streamType+", length="+a.videoLength+", playerName="+a.playerName+", channel="+a.channel+", isPrimetime="+a.isPrimetime+", sessionId="+a.sessionId+")"),this._canProcess()&&this._inputDataValidator.validateFields(a,["videoId","mediaType","streamType","videoLength","playerName"])){var b={};for(var c in a.metaVideo)a.metaVideo.hasOwnProperty(c)&&(b[c]=a.metaVideo[c]);if(a.metaNielsen)for(var c in a.metaNielsen)a.metaNielsen.hasOwnProperty(c)&&(b[c]=a.metaNielsen[c]);b["a.contentType"]=a.streamType,b["a.media.name"]=a.videoId,b["a.media.friendlyName"]=a.videoName||"",b["a.media.length"]=Math.floor(a.videoLength)||"0.0",b["a.media.playerName"]=a.playerName,b["a.media.channel"]=a.channel||"",b["a.media.view"]=!0,b["a.media.vsid"]=a.sessionId;var d={};d.contextData=b,"audio"===a.mediaType?(d.pev3=B,d.ms_a="1"):d.pev3=z,d.pe=a.isPrimetime?E:D,this._track(d);var e=this;setTimeout(function(){e._trigger(H,a)},0)}},f.prototype._executeOpenAd=function(a){var b=n(a.videoId)+"_"+a.podPosition;if(this._logger.debug(this._logTag,"#_executeOpenAd(id="+a.adId+", mediaType="+a.mediaType+", streamType="+a.streamType+", length="+a.adLength+", podPlayerName="+a.podPlayerName+", parentId="+a.videoId+", podId="+b+", parentPodPosition="+a.adPosition+", podSecond="+a.podSecond+")"),this._canProcess()&&this._inputDataValidator.validateFields(a,["videoId","mediaType","streamType","playerName","adId","adLength","podPlayerName","adPosition"])){a.podSecond=null==a.podSecond||isNaN(a.podSecond)?a.playhead:a.podSecond;var c,d={};for(c in a.metaVideo)a.metaVideo.hasOwnProperty(c)&&(d[c]=a.metaVideo[c]);for(c in a.metaAd)a.metaAd.hasOwnProperty(c)&&(d[c]=a.metaAd[c]);if(a.metaNielsen)for(var c in a.metaNielsen)a.metaNielsen.hasOwnProperty(c)&&(d[c]=a.metaNielsen[c]);d["a.contentType"]=a.streamType,d["a.media.name"]=a.videoId,d["a.media.playerName"]=a.playerName,d["a.media.channel"]=a.channel||"",d["a.media.vsid"]=a.sessionId,d["a.media.friendlyName"]=a.videoName||"",d["a.media.length"]=Math.floor(a.videoLength)||"0.0",d["a.media.ad.name"]=a.adId,d["a.media.ad.friendlyName"]=a.adName||"",d["a.media.ad.podFriendlyName"]=a.podName||"",d["a.media.ad.length"]=Math.floor(a.adLength)||"0.0",d["a.media.ad.playerName"]=a.podPlayerName,d["a.media.ad.pod"]=b,d["a.media.ad.podPosition"]=Math.floor(a.adPosition)||"0.0",d["a.media.ad.podSecond"]=Math.floor(a.podSecond)||"0.0",d["a.media.ad.view"]=!0;var e={};e.contextData=d,"audio"===a.mediaType?(e.pev3=C,e.ms_a="1"):e.pev3=A,e.pe=a.isPrimetime?G:F,this._track(e);var f=this;setTimeout(function(){f._trigger(I,a)},0)}},f.prototype._setupDataResolver=function(){var a={},b=this;a.rsid=function(){return b._appMeasurement.account},a.tracking_server=function(){return b._appMeasurement.ssl&&b._appMeasurement.trackingServerSecure?b._appMeasurement.trackingServerSecure:b._appMeasurement.trackingServer},a.ssl=function(){return b._appMeasurement.ssl},a.vid=function(){return b._appMeasurement.visitorID},a.aid=function(){return b._appMeasurement.analyticsVisitorID},a.mid=function(){return b._appMeasurement.marketingCloudVisitorID},a.blob=function(){return b._appMeasurement.audienceManagerBlob},a.loc_hint=function(){return b._appMeasurement.audienceManagerLocationHint?parseInt(b._appMeasurement.audienceManagerLocationHint):""},a.customerIDs=function(){var a={},c=b._appMeasurement.visitor.getCustomerIDs();for(var d in c)if(c.hasOwnProperty(d)){var e=c[d];if("object"==typeof e){for(var f in e)e.hasOwnProperty(f)&&("authState"==f?a[d+".as"]=e[f]:a[d+"."+f]=e[f]);a[d+".as"]||(a[d+".as"]="0")}}return a},a.channel=function(){return b._config?b._config.channel:null},a.meta=function(a){var c=a.split(".");if(c.length<2)return null;var d=c.shift();switch(a=c.join("."),d){case"video":return a==j.WILDCARD?b._videoMetadata:b._videoMetadata[a];case"ad":return a==j.WILDCARD?b._adMetadata:b._adMetadata[a];case"chapter":return a==j.WILDCARD?b._chapterMetadata:b._chapterMetadata[a];default:return null}},this._dataResolver=function(b){if(!b||0==b.length)return null;for(var c=null,d=0;d<b.length;d++){var e=b[d];c=c||{},o.startsWith(e,"meta.")?c[e]=a.meta(e.split("meta.")[1]):c[e]=a.hasOwnProperty(e)?a[e].call(this):null}return c}},f.prototype._registerCommands=function(){this._pluginManager.comply(this,"handleVideoLoad",this._cmdVideoLoad),this._pluginManager.comply(this,"handleBeginReporting",this._cmdBeginReporting),this._pluginManager.comply(this,"handleVideoStart",this._cmdVideoStart),this._pluginManager.comply(this,"handleAdStart",this._cmdAdStart),this._pluginManager.comply(this,"handleHeartbeatPluginError",this._cmdHeartbeatPluginError)},f.prototype._registerBehaviours=function(){this._pluginManager.registerBehaviour(new g(v,J),this,"handleVideoLoad"),this._pluginManager.registerBehaviour(new g(v,M),this,"handleBeginReporting"),this._pluginManager.registerBehaviour(new g(v,K),this,"handleVideoStart",[new i(v,"video.id","videoId"),new i(v,"video.mediaType","mediaType"),new i(v,"video.streamType","streamType"),new i(v,"video.name","videoName"),new i(v,"video.length","videoLength"),new i(v,"video.playerName","playerName"),new i(v,"video.streamType","streamType"),new i(w,"is_primetime","isPrimetime"),new i(w,"session_id","sessionId"),new i(t,"channel","channel"),new i(t,"meta.video.*","metaVideo"),new i(u,"meta","metaNielsen")]),this._pluginManager.registerBehaviour(new g(v,L),this,"handleAdStart",[new i(v,"video.id","videoId"),new i(v,"video.mediaType","mediaType"),new i(v,"video.streamType","streamType"),new i(v,"video.playhead","playhead"),new i(v,"video.playerName","playerName"),new i(v,"video.name","videoName"),new i(v,"video.length","videoLength"),new i(v,"ad.id","adId"),new i(v,"ad.length","adLength"),new i(v,"ad.position","adPosition"),new i(v,"ad.name","adName"),new i(v,"pod.name","podName"),new i(v,"pod.position","podPosition"),new i(v,"pod.playerName","podPlayerName"),new i(v,"pod.startTime","podSecond"),new i(w,"is_primetime","isPrimetime"),new i(w,"session_id","sessionId"),new i(t,"channel","channel"),new i(t,"meta.video.*","metaVideo"),new i(t,"meta.ad.*","metaAd"),new i(u,"meta","metaNielsen")]),this._pluginManager.registerBehaviour(new g(w,y),this,"handleHeartbeatPluginError")},f.prototype._onAppMeasurementReady=function(){this._logger.debug(this._logTag,"#_onAppMeasurementReady"),this._appMeasurementReady=!0,this._resumeWorkQueue()},f.prototype._resumeWorkQueue=function(){this._appMeasurementReady&&this._beginReporting&&(this._logger.debug(this._logTag,"#_resumeWorkQueue"),this._workQueue.resume())};var s="adobe-analytics",t=s,u="nielsen",v="player",w="adobe-heartbeat",x=2e3,y="error",z="video",A="videoAd",B="audio",C="audioAd",D="ms_s",E="msp_s",F="msa_s",G="mspa_s",H="aa_start",I="sc_ad_start",J="video_load",K="video_start",L="ad_start",M="video_begin_reporting";d.AdobeAnalyticsPlugin=f}(a.ADB.core,a.ADB.va,a.ADB.va.utils,b),function(a){"use strict";var b={SHOW:"a.media.show",SEASON:"a.media.season",EPISODE:"a.media.episode",ASSET_ID:"a.media.asset",GENRE:"a.media.genre",FIRST_AIR_DATE:"a.media.airDate",FIRST_DIGITAL_DATE:"a.media.digitalDate",RATING:"a.media.rating",ORIGINATOR:"a.media.originator",NETWORK:"a.media.network",SHOW_TYPE:"a.media.type",AD_LOAD:"a.media.adLoad",MVPD:"a.media.pass.mvpd",AUTHORIZED:"a.media.pass.auth",DAY_PART:"a.media.dayPart",FEED:"a.media.feed",STREAM_FORMAT:"a.media.format"},c={ARTIST:"a.media.artist",ALBUM:"a.media.album",LABEL:"a.media.label",AUTHOR:"a.media.author",STATION:"a.media.station",PUBLISHER:"a.media.publisher"},d={ADVERTISER:"a.media.ad.advertiser",CAMPAIGN_ID:"a.media.ad.campaign",CREATIVE_ID:"a.media.ad.creative",PLACEMENT_ID:"a.media.ad.placement",SITE_ID:"a.media.ad.site",CREATIVE_URL:"a.media.ad.creativeURL"};a.VideoMetadataKeys=b,a.AudioMetadataKeys=c,a.AdMetadataKeys=d}(b),a.ADB.va.plugins.aa||(a.ADB.va.plugins.aa=b)}(this);\n\n// MediaHeartbeat\n!function(a){!function(a,b){"use strict";function c(){this._processAction=!0,this._store={}}function d(a){if(!a)throw new Error("Reference to the logger object cannot be NULL");this._logger=a,this._rules=[]}c.prototype.setRuleName=function(a){this._ruleName=a},c.prototype.getRuleName=function(a,b){return this._ruleName},c.prototype.setData=function(a,b){this._store[a]=b},c.prototype.getData=function(a){return this._store[a]},c.prototype.shouldProcessAction=function(){return this._processAction},c.prototype.stopProcessingAction=function(){this._processAction=!1},c.prototype.startProcessingAction=function(){this._processAction=!0},d.createContext=function(){return new c},d.createPredicate=function(a,b,c){return{fn:a,expectedValue:b,msg:c}},d.prototype.registerRule=function(a,b,c,d,e){this._rules.push({name:a,desc:b,preconditions:c,actions:d,scope:e})},d.prototype.registerEnterExitAction=function(a,b){this._enterAction=a,this._exitAction=b},d.prototype._handleFailure=function(a,b){this._logger.error(e,a.desc+" -  "+b.msg)},d.prototype._getRule=function(a){for(var b=0;b<this._rules.length;++b)if(this._rules[b].name===a)return this._rules[b];return null},d.prototype.processRule=function(a,b){var c=!0,f=this._getRule(a);if(f){var g=f.scope;b||(b=d.createContext()),b.setRuleName(a);for(var h=!1,i=0;i<f.preconditions.length;++i){var j=f.preconditions[i];if(h=!!j.fn.call(g,b)!==j.expectedValue){this._handleFailure(f,j);break}}if(h)c=!1;else{b.startProcessingAction(),this._enterAction&&this._enterAction.call(g,b);for(var i=0;i<f.actions.length;++i){var k=f.actions[i];if(!b.shouldProcessAction()){this._logger.info(e,"Stopping actions for "+f.desc);break}k.call(g,b)}this._exitAction&&b.shouldProcessAction()&&this._exitAction.call(g,b)}}else this._logger.warn(e,"No registered event found for ruleName "+a),c=!1;return c};var e="RuleEngine";b._RuleEngine=d}(a.ADB.core,a.ADB.va),function(a,b){"use strict";function c(a,b,c){this.taskFn=a,this.scope=b,this.interval=c,this.remainingInterval=c}function d(a){if(!a)throw new Error("Reference to the logger object cannot be NULL");this._logger=a,this._tasks=[],this._pausedTasks=[]}c.prototype.elapsedTime=function(a){this.remainingInterval-=a},c.prototype.shouldExecute=function(){return this.remainingInterval<=0},c.prototype.execute=function(){this.taskFn.call(this.scope)},d.prototype._getCurrentTimeInMS=function(){return(new Date).getTime()},d.prototype._runTasksForTime=function(a){var b=[],c=a-this._lastTickTime;this._lastTickTime=a;for(var d=0;d<this._tasks.length;){var e=this._tasks[d];e.elapsedTime(c),e.shouldExecute()?(b.push(e),this._tasks.splice(d,1)):++d}this._checkStopTimer();for(var d=0;d<b.length;++d)b[d].execute()},d.prototype._onTick=function(){var a=this._getCurrentTimeInMS();this._runTasksForTime(a)},d.prototype._startTimer=function(){var a=this;this._timer||(this._logger.info(e,"#startTimer()"),a._lastTickTime=this._getCurrentTimeInMS(),this._timer=window.setInterval(function(){a._onTick()},f))},d.prototype._stopTimer=function(){this._timer&&(this._logger.info(e,"#stopTimer()"),window.clearInterval(this._timer),this._timer=null)},d.prototype._checkStartTimer=function(){this._tasks.length>0&&this._startTimer()},d.prototype._checkStopTimer=function(){0===this._tasks.length&&this._stopTimer()},d.prototype._removeTask=function(a,b){for(var c=0;c<a.length;++c)if(a[c]===b)return a.splice(c,1),!0;return!1},d.prototype.scheduleTask=function(a,b,d){if(this._logger.info(e,"#scheduleTask()"),!a)throw new Error("Reference to the taskFn cannot be NULL");var f=new c(a,b,d);return this._tasks.push(f),this._checkStartTimer(),f},d.prototype.cancelTask=function(a){this._logger.info(e,"#cancelTask()"),this._removeTask(this._tasks,a),this._checkStopTimer()},d.prototype.pauseTask=function(a){this._logger.info(e,"#pauseTask()"),this._removeTask(this._tasks,a)&&this._pausedTasks.push(a),this._checkStopTimer()},d.prototype.resumeTask=function(a){this._logger.info(e,"#resumeTask()"),this._removeTask(this._pausedTasks,a)&&this._tasks.push(a),this._checkStartTimer()},d.prototype.clearTasks=function(){this._stopTimer(),this._tasks=[],this._pausedTasks=[]};var e="TaskScheduler",f=250;b._TaskScheduler=d}(a.ADB.core,a.ADB.va),function(a){"use strict";function b(){this.trackingServer=void 0,this.channel=void 0,this.ovp=void 0,this.appVersion=void 0,this.playerName=void 0,this.ssl=!1,this.debugLogging=!1}a.MediaHeartbeatConfig=b,a.MediaHeartbeatConfig.sharedInstance=new b}(a.ADB.va),function(a){"use strict";function b(){this.data={}}var c=a.plugins.videoplayer.VideoInfo,d=a.plugins.videoplayer.AdBreakInfo,e=a.plugins.videoplayer.AdInfo,f=a.plugins.videoplayer.ChapterInfo,g=a.plugins.videoplayer.QoSInfo;b.MEDIAINFO_KEY_NAME="a.name",b.MEDIAINFO_KEY_VIDEOID="a.videoId",b.MEDIAINFO_KEY_ADID="a.adId",b.MEDIAINFO_KEY_LENGTH="a.length",b.MEDIAINFO_KEY_PLAYHEAD="a.playhead",b.MEDIAINFO_KEY_MEDIATYPE="a.mediaType",b.MEDIAINFO_KEY_STREAMTYPE="a.streamType",b.MEDIAINFO_KEY_POSITION="a.position",b.MEDIAINFO_KEY_STARTTIME="a.startTime",b.MEDIAINFO_KEY_BITRATE="a.bitrate",b.MEDIAINFO_KEY_FPS="a.fps",b.MEDIAINFO_KEY_DROPPEDFRAMES="a.droppedFrames",b.MEDIAINFO_KEY_STARTUPTIME="a.startupTime",b.MEDIAINFO_KEY_TIMEDMETADATA="a.timedMetadata",b.prototype.setValue=function(a,b){this.data[a]=b},b.prototype.getValue=function(a){return this.data.hasOwnProperty(a)?this.data[a]:null},b.prototype.createVideoInfo=function(){var a=new c;return a.id=null!=this.getValue(b.MEDIAINFO_KEY_VIDEOID)?this.getValue(b.MEDIAINFO_KEY_VIDEOID):"",a.name=null!=this.getValue(b.MEDIAINFO_KEY_NAME)?this.getValue(b.MEDIAINFO_KEY_NAME):"",a.length=null!=this.getValue(b.MEDIAINFO_KEY_LENGTH)?this.getValue(b.MEDIAINFO_KEY_LENGTH):0,a.playhead=null!=this.getValue(b.MEDIAINFO_KEY_PLAYHEAD)?this.getValue(b.MEDIAINFO_KEY_PLAYHEAD):0,a.mediaType=null!=this.getValue(b.MEDIAINFO_KEY_MEDIATYPE)?this.getValue(b.MEDIAINFO_KEY_MEDIATYPE):"",a.streamType=null!=this.getValue(b.MEDIAINFO_KEY_STREAMTYPE)?this.getValue(b.MEDIAINFO_KEY_STREAMTYPE):"",a},b.prototype.createAdBreakInfo=function(){var a=new d;return a.name=null!=this.getValue(b.MEDIAINFO_KEY_NAME)?this.getValue(b.MEDIAINFO_KEY_NAME):"",a.position=null!=this.getValue(b.MEDIAINFO_KEY_POSITION)?this.getValue(b.MEDIAINFO_KEY_POSITION):0,a.startTime=null!=this.getValue(b.MEDIAINFO_KEY_STARTTIME)?this.getValue(b.MEDIAINFO_KEY_STARTTIME):0,a},b.prototype.createAdInfo=function(){var a=new e;return a.id=null!=this.getValue(b.MEDIAINFO_KEY_ADID)?this.getValue(b.MEDIAINFO_KEY_ADID):"",a.name=null!=this.getValue(b.MEDIAINFO_KEY_NAME)?this.getValue(b.MEDIAINFO_KEY_NAME):"",a.length=null!=this.getValue(b.MEDIAINFO_KEY_LENGTH)?this.getValue(b.MEDIAINFO_KEY_LENGTH):0,a.position=null!=this.getValue(b.MEDIAINFO_KEY_POSITION)?this.getValue(b.MEDIAINFO_KEY_POSITION):0,a},b.prototype.createChapterInfo=function(){var a=new f;return a.name=null!=this.getValue(b.MEDIAINFO_KEY_NAME)?this.getValue(b.MEDIAINFO_KEY_NAME):"",a.length=null!=this.getValue(b.MEDIAINFO_KEY_LENGTH)?this.getValue(b.MEDIAINFO_KEY_LENGTH):0,a.startTime=null!=this.getValue(b.MEDIAINFO_KEY_STARTTIME)?this.getValue(b.MEDIAINFO_KEY_STARTTIME):0,a.position=null!=this.getValue(b.MEDIAINFO_KEY_POSITION)?this.getValue(b.MEDIAINFO_KEY_POSITION):0,a},b.prototype.createQoSInfo=function(){var a=new g;return a.bitrate=null!=this.getValue(b.MEDIAINFO_KEY_BITRATE)?this.getValue(b.MEDIAINFO_KEY_BITRATE):0,a.fps=null!=this.getValue(b.MEDIAINFO_KEY_FPS)?this.getValue(b.MEDIAINFO_KEY_FPS):0,a.droppedFrames=null!=this.getValue(b.MEDIAINFO_KEY_DROPPEDFRAMES)?this.getValue(b.MEDIAINFO_KEY_DROPPEDFRAMES):0,a.startupTime=null!=this.getValue(b.MEDIAINFO_KEY_STARTUPTIME)?this.getValue(b.MEDIAINFO_KEY_STARTUPTIME):0,a},b.prototype.isEqual=function(a){if(this===a)return!0;if(!a||"object"!=typeof a||"function"!=typeof a.getValue)return!1;for(var c=[b.MEDIAINFO_KEY_NAME,b.MEDIAINFO_KEY_VIDEOID,b.MEDIAINFO_KEY_ADID,b.MEDIAINFO_KEY_LENGTH,b.MEDIAINFO_KEY_PLAYHEAD,b.MEDIAINFO_KEY_STREAMTYPE,b.MEDIAINFO_KEY_MEDIATYPE,b.MEDIAINFO_KEY_POSITION,b.MEDIAINFO_KEY_STARTTIME,b.MEDIAINFO_KEY_BITRATE,b.MEDIAINFO_KEY_FPS,b.MEDIAINFO_KEY_DROPPEDFRAMES,b.MEDIAINFO_KEY_STARTUPTIME,b.MEDIAINFO_KEY_TIMEDMETADATA],d=0;d<c.length;++d){var e=c[d];if(this.getValue(e)!==a.getValue(e))return!1}return!0},a.MediaObject=b}(a.ADB.va),function(a){"use strict";function b(a,c){if(!c)throw new Error("Visitor instance cannot be NULL");this._visitor=c,this._logger=a,this._status=b.OPT_UNKNOWN,this._optInFetchPermissionsCallback=this._optInFetchPermissionsCallback.bind(this)}var c="PrivacyManager";b.prototype.getStatus=function(){return this._status},b.prototype.configure=function(a){this.reset(),this._callback=a,this._optIn=window.adobe&&window.adobe.optIn?window.adobe.optIn:void 0,this._optIn&&this._optIn.doesOptInApply?(this._logger.info(c,"OptIn service enabled"),this._waitingForOptInCallback=!0,this._optInMediaApproved=!1):this._logger.info(c,"OptIn service does not apply"),this._waitingForVisitorCallback=!0,this._visitorOptOut=!1,this._fetchVisitorOptOut(),this._fetchOptIn(),this._updateStatus()},b.prototype.reset=function(){this._unsubscribeOptIn(),this._status=b.OPT_UNKNOWN,this._callback=null},b.prototype._fetchVisitorOptOut=function(){this._logger.info(c,"Fetching Visitor.isOptedOut");try{var a=this;this._visitor.isOptedOut(function(b){a._logger.info(c,"Visitor.isOptedOut : "+b),a._waitingForVisitorCallback=!1,a._visitorOptOut=b,a._updateStatus()},void 0,!0)}catch(a){this._logger.warn(c,"Error fetching Visitor.isOptedOut"),this._waitingForVisitorCallback=!1}},b.prototype._fetchOptIn=function(){try{if(!this._optIn||!this._optIn.doesOptInApply)return;this._logger.info(c,"Fetching permissions from OptIn service"),this._optInListenerRegistered||(this._optIn.fetchPermissions(this._optInFetchPermissionsCallback,!0),this._optInListenerRegistered=!0)}catch(a){this._logger.warn(c,"Error fetching permissions from OptIn service"),this._waitingForOptInCallback=!1}},b.prototype._unsubscribeOptIn=function(){try{this._optIn&&this._optInListenerRegistered&&(this._optIn.off("complete",this._optInFetchPermissionsCallback),this._optInListenerRegistered=!1)}catch(a){this._logger.error(c,"Error unsubscribing from OptIn service")}},b.prototype._optInFetchPermissionsCallback=function(){this._waitingForOptInCallback=!1;var a=this._optIn.isApproved(this._optIn.Categories.ECID),b=this._optIn.isApproved(this._optIn.Categories.ANALYTICS),d=void 0===this._optIn.Categories.MEDIA_ANALYTICS||this._optIn.isApproved(this._optIn.Categories.MEDIA_ANALYTICS);this._optInMediaApproved=a&&b&&d,this._logger.info(c,"OptIn fetchPermissions ECID : "+a+" Analytics : "+b+" Media : "+d),this._updateStatus()},b.prototype._updateStatus=function(){if(!(this._waitingForVisitorCallback||this._optIn&&this._optIn.doesOptInApply&&this._waitingForOptInCallback)){var a=this._visitorOptOut||this._optIn&&this._optIn.doesOptInApply&&!this._optInMediaApproved,d=a?b.OPT_OUT:b.OPT_IN;if(this._status!==d){this._logger.info(c,"Privacy changed from "+this._status+" to "+d),this._status=d;var e=this;setTimeout(function(){try{e._callback&&e._callback(d)}catch(a){}},0)}}},b.OPT_OUT="optout",b.OPT_IN="optin",b.OPT_UNKNOWN="optunknown",a._PrivacyManager=b}(a.ADB.va),function(a,b){"use strict";function c(a){c.__super__.constructor.call(this),this._heartbeat=a}function d(a){d.__super__.constructor.call(this),this._heartbeat=a}function e(a){e.__super__.constructor.call(this),this._heartbeat=a}function f(a){f.__super__.constructor.call(this),this._heartbeat=a}a.extend(c,b.plugins.aa.AdobeAnalyticsPluginDelegate),c.prototype.onError=function(a){this._heartbeat&&this._heartbeat._onDelegateError(a)},a.extend(d,b.plugins.ah.AdobeHeartbeatPluginDelegate),d.prototype.onError=function(a){this._heartbeat&&this._heartbeat._onDelegateError(a)},d.prototype.onTrackingDisabled=function(){this._heartbeat&&this._heartbeat._onDelegateTrackingDisabled()},a.extend(e,b.HeartbeatDelegate),e.prototype.onError=function(a){this._heartbeat&&this._heartbeat._onDelegateError(a)},a.extend(f,b.plugins.videoplayer.VideoPlayerPluginDelegate),f.prototype.getVideoInfo=function(){return this._heartbeat&&this._heartbeat._videoInfo?(this._heartbeat._delegate&&(this._heartbeat._videoInfo.playhead=this._heartbeat._delegate.getCurrentPlaybackTime()),this._heartbeat._videoInfo):null},f.prototype.getAdBreakInfo=function(){return this._heartbeat&&this._heartbeat._adBreakInfo?this._heartbeat._adBreakInfo:null},f.prototype.getAdInfo=function(){return this._heartbeat&&this._heartbeat._adInfo?this._heartbeat._adInfo:null},f.prototype.getChapterInfo=function(){return this._heartbeat&&this._heartbeat._chapterInfo?this._heartbeat._chapterInfo:null},f.prototype.getQoSInfo=function(){if(this._heartbeat&&this._heartbeat._delegate&&this._heartbeat._delegate.getQoSObject()){var a=this._heartbeat._delegate.getQoSObject();if(a&&"object"==typeof a&&a.setValue)return a.createQoSInfo()}return null},b._MediaAnalyticsPluginDelegate=c,b._MediaHeartbeatPluginDelegate=d,b._ADBMediaHeartbeatDelegate=e,b._MediaHeartbeatVideoPlayerPluginDelegate=f}(a.ADB.core,a.ADB.va),function(a,b){"use strict";function c(a,d){c.__super__.constructor.call(this),this._heartbeat=a,this._logger=d,this._validator=new b.plugins.nielsen.MetadataValidator(d)}var d="MediaHeartbeatNielsenPluginDelegate",e={NielsenContentMetadata:"media_nielsen_content_metadata",NielsenChannelMetadata:"media_nielsen_channel_metadata",NielsenAdMetadata:"media_nielsen_ad_metadata"};b.plugins.nielsen&&a.extend(c,b.plugins.nielsen.NielsenPluginDelegate),c.prototype.getMetadataInfo=function(){if(this._heartbeat&&this._heartbeat._currentMediaObject){var a=this._heartbeat._currentMediaObject.getValue(e.NielsenContentMetadata);if(a&&"object"==typeof a)return this._validator.validateContentMetadata(a,"MediaHeartbeat.NielsenContentMetadataKeys"),a;this._logger.warn(d,"We expect a valid object for MediaHeartbeat.MediaObjectKey.NielsenContentMetadata in MediaObject")}return null},c.prototype.getAdMetadataInfo=function(){if(this._heartbeat&&this._heartbeat._currentAdObject){var a=this._heartbeat._currentAdObject.getValue(e.NielsenAdMetadata);if(a&&"object"==typeof a)return this._validator.validateAdMetadata(a,"MediaHeartbeat.NielsenAdMetadataKeys"),a;this._logger.warn(d,"We expect a valid object for MediaHeartbeat.MediaObjectKey.NielsenAdMetadata in MediaObject")}return null},c.prototype.getChannelInfo=function(){if(this._heartbeat&&this._heartbeat._currentMediaObject){var a=this._heartbeat._currentMediaObject.getValue(e.NielsenChannelMetadata);if(a&&"object"==typeof a)return this._validator.validateChannelMetadata(a,"MediaHeartbeat.NielsenChannelMetadataKeys"),a;this._logger.warn(d,"We expect a valid object for MediaHeartbeat.MediaObjectKey.NielsenChannelMetadata in MediaObject")}return null},c.prototype.onError=function(a){this._heartbeat&&this._heartbeat._onDelegateError(a)},b.plugins.nielsen&&(b._NielsenObjectKey=e,b._NielsenPluginDelegate=c)}(a.ADB.core,a.ADB.va),function(b,c){"use strict";function d(){}function e(b,d,e){if(this._appMeasurement=e||a.s,!this._appMeasurement)throw new Error("MediaHeartbeat needs a valid AppMeasurement instance.");if(!this._appMeasurement.visitor||!this._appMeasurement.visitor.marketingCloudOrgID)throw new Error("MediaHeartbeat needs a valid visitor instance with marketingCloudOrgId set.");if(!b)throw new Error("MediaHeartbeat needs a valid delegate object.");if(!d||"object"!=typeof d||!d.trackingServer)throw new Error("MediaHeartbeat needs a valid config object with trackingServer set.");this._config=d,this._delegate=b,this._debugLogging=c.MediaHeartbeat._debugLogging||this._config.debugLogging,this._logger=new f,this._debugLogging?this._logger.enable():this._logger.disable(),this._ruleEngine=new t(this._logger),this._taskScheduler=new u(this._logger),this._privacyManager=new v(this._logger,this._appMeasurement.visitor),this._resetState(),this._setupRules()}var f=b.Logger,g=c.MediaObject,h=c.Heartbeat,i=c.HeartbeatConfig,j=c._ADBMediaHeartbeatDelegate,k=c.plugins.videoplayer.VideoPlayerPlugin,l=c.plugins.videoplayer.VideoPlayerPluginConfig,m=c._MediaHeartbeatVideoPlayerPluginDelegate,n=c.plugins.aa.AdobeAnalyticsPlugin,o=c.plugins.aa.AdobeAnalyticsPluginConfig,p=c._MediaAnalyticsPluginDelegate,q=c.plugins.ah.AdobeHeartbeatPlugin,r=c.plugins.ah.AdobeHeartbeatPluginConfig,s=c._MediaHeartbeatPluginDelegate,t=c._RuleEngine,u=c._TaskScheduler,v=c._PrivacyManager,w=c.utils.ObjectUtils,x=c.utils.VersionUtils;if(d.prototype.getCurrentPlaybackTime=function(){return null},d.prototype.getQoSObject=function(){return null},e.MediaType={Video:"video",Audio:"audio"},e.Event={AdBreakStart:"adBreakStart",AdBreakComplete:"adBreakComplete",AdStart:"adStart",AdComplete:"adComplete",AdSkip:"adSkip",ChapterStart:"chapterStart",ChapterComplete:"chapterComplete",ChapterSkip:"chapterSkip",SeekStart:"seekStart",SeekComplete:"seekComplete",BufferStart:"bufferStart",BufferComplete:"bufferComplete",BitrateChange:"bitrateChange",TimedMetadataUpdate:"timedMetadataUpdate"},e.StreamType={VOD:"vod",LIVE:"live",LINEAR:"linear",PODCAST:"podcast",AUDIOBOOK:"audiobook",AOD:"aod"},e.MediaObjectKey={StandardVideoMetadata:"media_standard_content_metadata",StandardMediaMetadata:"media_standard_content_metadata",StandardAdMetadata:"media_standard_ad_metadata",VideoResumed:"resumed",MediaResumed:"resumed",PrerollTrackingWaitingTime:"preroll_tracking_waiting_time"},e.VideoMetadataKeys=c.plugins.aa.VideoMetadataKeys,e.AudioMetadataKeys=c.plugins.aa.AudioMetadataKeys,e.AdMetadataKeys=c.plugins.aa.AdMetadataKeys,e.createMediaObject=function(a,b,c,d,f){var h=new g;h.setValue(g.MEDIAINFO_KEY_VIDEOID,b),h.setValue(g.MEDIAINFO_KEY_NAME,a),h.setValue(g.MEDIAINFO_KEY_LENGTH,c),h.setValue(g.MEDIAINFO_KEY_PLAYHEAD,0);var i=d||e.StreamType.VOD;return h.setValue(g.MEDIAINFO_KEY_STREAMTYPE,i),("string"!=typeof f||f!=e.MediaType.Video&&f!=e.MediaType.Audio)&&(f=e.MediaType.Video),h.setValue(g.MEDIAINFO_KEY_MEDIATYPE,f),h},e.createAdBreakObject=function(a,b,c){var d=new g;return d.setValue(g.MEDIAINFO_KEY_NAME,a),d.setValue(g.MEDIAINFO_KEY_POSITION,b),d.setValue(g.MEDIAINFO_KEY_STARTTIME,c),d},e.createAdObject=function(a,b,c,d){var e=new g;return e.setValue(g.MEDIAINFO_KEY_NAME,a),e.setValue(g.MEDIAINFO_KEY_ADID,b),e.setValue(g.MEDIAINFO_KEY_POSITION,c),e.setValue(g.MEDIAINFO_KEY_LENGTH,d),e},e.createChapterObject=function(a,b,c,d){var e=new g;return e.setValue(g.MEDIAINFO_KEY_NAME,a),e.setValue(g.MEDIAINFO_KEY_POSITION,b),e.setValue(g.MEDIAINFO_KEY_LENGTH,c),e.setValue(g.MEDIAINFO_KEY_STARTTIME,d),e},e.createQoSObject=function(a,b,c,d){var e=new g;return e.setValue(g.MEDIAINFO_KEY_BITRATE,a),e.setValue(g.MEDIAINFO_KEY_FPS,c),e.setValue(g.MEDIAINFO_KEY_DROPPEDFRAMES,d),e.setValue(g.MEDIAINFO_KEY_STARTUPTIME,b),e},e.createTimedMetadataObject=function(a){var b=new g;return b.setValue(g.MEDIAINFO_KEY_TIMEDMETADATA,a),b},e.version=function(){return c.Version.getVersion()},e.prototype.trackSessionStart=function(a,b){this._logger.info(D,"#::trackSessionStart()");var c=t.createContext();c.setData(E,a),c.setData(J,this._cleanContextData(b)),this._processRule(B.SessionStart,c)},e.prototype.trackPlay=function(){this._logger.info(D,"#::trackPlay()"),this._processRule(B.Play)},e.prototype.trackPause=function(){this._logger.info(D,"#::trackPause()"),this._processRule(B.Pause)},e.prototype.trackComplete=function(){this._logger.info(D,"#::trackComplete()"),this._processRule(B.VideoComplete)},e.prototype.trackSessionEnd=function(){this._logger.info(D,"#::trackSessionEnd()"),this._processRule(B.SessionEnd)},e.prototype.trackError=function(a){this._logger.info(D,"#::trackError()");var b=t.createContext();b.setData(K,a),this._processRule(B.Error,b)},e.prototype.trackEvent=function(a,b,c){this._logger.info(D,"#::trackEvent() - "+a);var d,f=t.createContext();switch(a){case e.Event.AdBreakStart:f.setData(F,b),f.setData(J,this._cleanContextData(c)),d=B.AdBreakStart;break;case e.Event.AdBreakComplete:d=B.AdBreakComplete;break;case e.Event.AdStart:f.setData(G,b),f.setData(J,this._cleanContextData(c)),d=B.AdStart;break;case e.Event.AdComplete:d=B.AdComplete;break;case e.Event.AdSkip:d=B.AdSkip;break;case e.Event.SeekStart:d=B.SeekStart;break;case e.Event.SeekComplete:d=B.SeekComplete;break;case e.Event.ChapterStart:f.setData(H,b),f.setData(J,this._cleanContextData(c)),d=B.ChapterStart;break;case e.Event.ChapterComplete:d=B.ChapterComplete;break;case e.Event.ChapterSkip:d=B.ChapterSkip;break;case e.Event.BufferStart:d=B.BufferStart;break;case e.Event.BufferComplete:d=B.BufferComplete;break;case e.Event.BitrateChange:d=B.BitrateChange;break;case e.Event.TimedMetadataUpdate:d=B.TimedMetadataUpdate,f.setData(I,b);break;default:return void this._logger.error(D,"Incorrect event name.")}this._processRule(d,f)},c.plugins.nielsen){var y=c.MediaHeartbeatConfig;y.prototype.nielsenConfigKey=void 0,y.prototype.nielsenAppInfo=void 0;var z=c._NielsenObjectKey;e.MediaObjectKey.NielsenContentMetadata=z.NielsenContentMetadata,e.MediaObjectKey.NielsenAdMetadata=z.NielsenAdMetadata,e.MediaObjectKey.NielsenChannelMetadata=z.NielsenChannelMetadata,e.NielsenContentMetadataKeys=c.plugins.nielsen.ContentMetadataKeys,e.NielsenChannelMetadataKeys=c.plugins.nielsen.ChannelMetadataKeys,e.NielsenAdMetadataKeys=c.plugins.nielsen.AdMetadataKeys,e.prototype.nielsenLoadMetadata=function(a){this._nielsenPlugin&&this._nielsenPlugin.loadMetadata(a)}}e.prototype._setState=function(a,b){this._mediaState[a]=b},e.prototype._isInState=function(a){return this._mediaState[a]},e.prototype._isTrackingDisabled=function(a){return this._mediaHeartbeatDisabled},e.prototype._isInSession=function(a){return this._isInState(A.Session)},e.prototype._isInMedia=function(a){return this._isInState(A.Media)},e.prototype._isInAd=function(a){return this._isInState(A.Ad)},e.prototype._isInAdBreak=function(a){return this._isInState(A.AdBreak)},e.prototype._isInChapter=function(a){return this._isInState(A.Chapter)},e.prototype._isInPlay=function(a){return this._isInState(A.PlayPause)},e.prototype._isInPause=function(a){return!this._isInState(A.PlayPause)},e.prototype._isInBuffer=function(a){return this._isInState(A.Buffer)},e.prototype._isInSeek=function(a){return this._isInState(A.Seek)},e.prototype._isPlatformTrackingSupported=function(a){return!this._appMeasurement.unsupportedBrowser},e.prototype._isAudioTrackingSupported=function(a){return a.getData(E).getValue(g.MEDIAINFO_KEY_MEDIATYPE)!==e.MediaType.Audio||x.isGreaterThanEqual(this._appMeasurement.version,"2.11.0")},e.prototype._isValidMediaObject=function(a){var b=a.getData(E);if(b&&b instanceof g){var c=b.getValue(e.MediaObjectKey.MediaResumed);null!=c&&"boolean"!=typeof c&&this._logger.warn(D,"Ignoring value set for MediaHeartbeat.MediaObjectKey.MediaResumed in MediaObject as we expect a boolean value");var d=b.getValue(e.MediaObjectKey.PrerollTrackingWaitingTime);if(null!=d){("string"==typeof d||"number"==typeof d)&&!isNaN(d)||this._logger.warn(D,"Ignoring value set for MediaHeartbeat.MediaObjectKey.PrerollTrackingWaitingTime in MediaObject as we expect a valid duration as number in milliseconds.")}var f=b.getValue(e.MediaObjectKey.StandardMediaMetadata);return null!=f&&"object"!=typeof f&&this._logger.warn(D,"Ignoring value set for MediaHeartbeat.MediaObjectKey.StandardMediaMetadata in MediaObject as we expect a valid object with kv pairs."),!0}return!1},e.prototype._isValidAdBreakObject=function(a){var b=a.getData(F);return b&&b instanceof g},e.prototype._isDifferentAdBreakObject=function(a){var b=a.getData(F);return!(this._currentAdBreakObject&&this._currentAdBreakObject.isEqual(b))},e.prototype._isValidAdObject=function(a){var b=a.getData(G);if(b&&b instanceof g){var c=b.getValue(N);null!=c&&"boolean"!=typeof c&&this._logger.warn(D,"Ignoring value set for MediaHeartbeat.MediaObjectKey.GranularAdTracking in AdObject as we expect a boolean value.");var d=b.getValue(e.MediaObjectKey.StandardAdMetadata);return null!=d&&"object"!=typeof d&&this._logger.warn(D,"Ignoring value set for MediaHeartbeat.MediaObjectKey.StandardAdMetadata in AdObject as we expect a valid object with kv pairs."),!0}return!1},e.prototype._isDifferentAdObject=function(a){var b=a.getData(G);return!(this._currentAdObject&&this._currentAdObject.isEqual(b))},e.prototype._isValidChapterObject=function(a){var b=a.getData(H);return b&&b instanceof g},e.prototype._isDifferentChapterObject=function(a){var b=a.getData(H);return!(this._currentChapterObject&&this._currentChapterObject.isEqual(b))},e.prototype._isValidTimedMetadataObject=function(a){var b=a.getData(I);if(b&&b instanceof g){var c=b.getValue(g.MEDIAINFO_KEY_TIMEDMETADATA);return c&&"string"==typeof c}return!1},e.prototype._shouldAllowPlayerStateChange=function(a){return!(this._isInState(A.AdBreak)&&!this._isInState(A.Ad))},e.prototype._didBeginReporting=function(a){return this._isInState(A.Reporting)},e.prototype._deferredTrackPlay=function(){this._prerollWaitEnabled&&(this._logger.info(D,"Executing deferred API:trackPlay."),this._prerollWaitEnabled=!1,this._playTaskHandle=null,this._processRule(B.Play))},e.prototype._cmdEnterAction=function(a){var b=a.getRuleName();if(this._prerollWaitEnabled)if(this._playReceived)switch(b){case B.SeekStart:case B.BufferStart:this._logger.info(D,"Cancelling scheduled API:trackPlay because of SeekStart/BufferStart event"),this._taskScheduler.cancelTask(this._playTaskHandle),this._playTaskHandle=null;break;case B.SeekComplete:case B.BufferComplete:this._logger.info(D,"Rescheduled API:trackPlay after SeekComplete/BufferComplete event"),this._playTaskHandle=this._taskScheduler.scheduleTask(this._deferredTrackPlay,this,this._prerollWaitTime);break;case B.Play:this._logger.info(D,"Dropping API:trackPlay as we already have a API:trackPlay scheduled."),a.stopProcessingAction();break;case B.Pause:this._logger.info(D,"Cancelling scheduled API:trackPlay because of API:trackPause call."),this._taskScheduler.cancelTask(this._playTaskHandle),this._playTaskHandle=null,this._prerollWaitEnabled=!1;break;case B.AdBreakStart:this._logger.info(D,"Received API:trackEvent(AdBreakStart) within "+this._prerollWaitTime+" ms after API:trackPlay. We will track this as preroll AdBreak."),this._taskScheduler.cancelTask(this._playTaskHandle),this._playTaskHandle=null,this._prerollWaitEnabled=!1,this._playAfterAdStart=!0}else switch(b){case B.Play:this._logger.info(D,"Deferring API:trackPlay for "+this._prerollWaitTime+" ms."),this._playReceived=!0,this._playUnhandledFromPrerollWaitTime=!0,this._playTaskHandle=this._taskScheduler.scheduleTask(this._deferredTrackPlay,this,this._prerollWaitTime),a.stopProcessingAction();break;case B.Pause:this._logger.info(D,"Received trackPause before first trackPlay."),this._prerollWaitEnabled=!1;break;case B.AdBreakStart:this._logger.info(D,"Received trackEvent(AdBreakStart) before first trackPlay."),this._prerollWaitEnabled=!1}},e.prototype._cmdExitAction=function(a){var b=a.getRuleName();this._playAfterAdStart&&(b===B.AdStart?(this._cmdPlay(a),this._playAfterAdStart=!1):b===B.AdBreakComplete&&(this._playAfterAdStart=!1)),b!==B.AdStart||this._isInState(A.FPlayPause)||this._cmdPlay(a),this._prerollWaitEnabled||!this._playUnhandledFromPrerollWaitTime||b!==B.BufferComplete&&b!==B.SeekComplete&&b!==B.AdBreakComplete||this._isInState(A.FPlayPause)||this._isInState(A.Buffer)||this._isInState(A.Seek)||(this._logger.info(D,"Executing pending API:trackPlay. This case most likely happens tracking Preroll AdBreak without any Ads."),this._cmdPlay(a))},e.prototype._cmdConfigure=function(a){this._configureAdobeAnalyticsPlugin(),this._configureAdobeHearbeatPlugin(),this._configureVideoPlayerPlugin(),this._configureOtherPlugins(),this._configureHeartbeat(),this._privacyManager.configure(this._onPrivacyChange.bind(this))},e.prototype._cmdBeginReporting=function(a){this._playerPlugin&&this._playerPlugin.beginReporting(),this._setState(A.Reporting,!0)},e.prototype._cmdSessionStart=function(a){var b=a.getData(E),c=a.getData(J);this._currentMediaObject=b,this._videoInfo=b.createVideoInfo(),this._videoInfo.playerName=this._config.playerName?this._config.playerName:"";var d=b.getValue(e.MediaObjectKey.StandardMediaMetadata);d&&"object"==typeof d||(d=null);var f=b.getValue(e.MediaObjectKey.MediaResumed);"boolean"==typeof f&&(this._videoInfo.resumed=f);var g=b.getValue(e.MediaObjectKey.PrerollTrackingWaitingTime);"string"!=typeof g&&"number"!=typeof g||isNaN(g)||(this._prerollWaitTime=Number(g),this._prerollWaitTime<=0&&(this._prerollWaitEnabled=!1));var h=this._prepareMetadata(d,c);h[L]=this._videoInfo.mediaType,this._aaPlugin.setVideoMetadata(h),this._playerPlugin.trackVideoLoad(),this._playerPlugin.trackSessionStart(),this._setState(A.Session,!0),this._setState(A.Media,!0)},e.prototype._destroyHeartbeat=function(a,b){a&&a.trackVideoUnload(),b&&b.destroy()},e.prototype._cmdVideoEnd=function(a){var b=a.getRuleName()===B.VideoComplete;if(this._isInState(A.Reporting)){var c=this,d=this._heartbeat,e=this._playerPlugin;this._playerPlugin.trackComplete(function(){c._destroyHeartbeat(e,d)},b)}else this._destroyHeartbeat(this._playerPlugin,this._heartbeat);this._setState(A.Media,!1)},e.prototype._cmdHandleMediaComplete=function(a){this._isInMedia(a)||(this._logger.info(D,"API:trackComplete has already cleaned up Heartbeat instance."),this._cmdSessionEnd(a),a.stopProcessingAction())},e.prototype._cmdSessionEnd=function(a){this._setState(A.Session,!1),this._resetState()},e.prototype._cmdDisableTracking=function(a){this._logger.info(D,"#_cmdDisableTracking: ADBMediaHeartbeat Tracking Disabled Remotely."),this._mediaHeartbeatDisabled=!0},e.prototype._cmdBufferStart=function(a){this._playerPlugin.trackBufferStart(),this._setState(A.Buffer,!0)},e.prototype._cmdBufferComplete=function(a){this._isInState(A.Buffer)&&this._playerPlugin.trackBufferComplete(),this._setState(A.Buffer,!1)},e.prototype._cmdSeekStart=function(a){this._playerPlugin.trackSeekStart(),this._setState(A.Seek,!0)},e.prototype._cmdSeekComplete=function(a){this._isInState(A.Seek)&&this._playerPlugin.trackSeekComplete(),this._setState(A.Seek,!1)},e.prototype._cmdPlay=function(a){this._playerPlugin.trackPlay(),this._setState(A.PlayPause,!0),this._setState(A.FPlayPause,!0),this._playUnhandledFromPrerollWaitTime=!1},e.prototype._cmdPause=function(a){this._playerPlugin.trackPause(),this._setState(A.PlayPause,!1),this._setState(A.FPlayPause,!0)},e.prototype._cmdAdBreakStart=function(a){var b=a.getData(F);this._currentAdBreakObject=b,this._adBreakInfo=b.createAdBreakInfo(),this._adBreakInfo.playerName=this._config.playerName?this._config.playerName:"",this._playerPlugin.trackAdBreakStart(),this._setState(A.AdBreak,!0)},e.prototype._cmdAdBreakComplete=function(a){this._currentAdBreakObject=null,this._adBreakInfo=null,this._isInState(A.AdBreak)&&this._playerPlugin.trackAdBreakComplete(),this._setState(A.AdBreak,!1)},e.prototype._cmdAdStart=function(a){var b=a.getData(G),c=a.getData(J);this._currentAdObject=b,this._adInfo=b.createAdInfo();var d=b.getValue(N);"boolean"==typeof d&&(this._adInfo.granularTracking=d);var f=b.getValue(e.MediaObjectKey.StandardAdMetadata);f&&"object"==typeof f||(f=null);var g=this._prepareMetadata(f,c);this._aaPlugin.setAdMetadata(g),this._playerPlugin.trackAdStart(),this._setState(A.Ad,!0)},e.prototype._cmdAdComplete=function(a){this._currentAdObject=null,this._adInfo=null,this._isInState(A.Ad)&&this._playerPlugin.trackAdComplete(),this._setState(A.Ad,!1)},e.prototype._cmdAdSkip=function(a){this._currentAdObject=null,this._adInfo=null,this._isInState(A.Ad)&&this._playerPlugin.trackAdSkip(),this._setState(A.Ad,!1)},e.prototype._cmdChapterStart=function(a){var b=a.getData(H),c=a.getData(J);this._currentChapterObject=b,this._chapterInfo=b.createChapterInfo();var d=this._prepareMetadata(null,c);this._aaPlugin.setChapterMetadata(d),this._playerPlugin.trackChapterStart(),this._setState(A.Chapter,!0)},e.prototype._cmdChapterComplete=function(a){this._currentChapterObject=null,this._chapterInfo=null,this._isInState(A.Chapter)&&this._playerPlugin.trackChapterComplete(),this._setState(A.Chapter,!1)},e.prototype._cmdChapterSkip=function(a){this._currentChapterObject=null,this._chapterInfo=null,this._isInState(A.Chapter)&&this._playerPlugin.trackChapterSkip(),this._setState(A.Chapter,!1)},e.prototype._cmdError=function(a){var b=a.getData(K);b||(b="unknown_error_id"),this._playerPlugin.trackVideoPlayerError(b)},e.prototype._cmdBitrate=function(a){this._playerPlugin.trackBitrateChange()},e.prototype._cmdTimedMetadataUpdate=function(a){var b=a.getData(I),c=b.getValue(g.MEDIAINFO_KEY_TIMEDMETADATA);this._playerPlugin.trackTimedMetadata(c)},e.prototype._processRule=function(a,b){return this._ruleEngine.processRule(a,b)},e.prototype._setupRules=function(){this._ruleEngine.registerEnterExitAction(this._cmdEnterAction,this._cmdExitAction),this._ruleEngine.registerRule(B.SessionStart,"API:trackSessionStart",[t.createPredicate(this._isPlatformTrackingSupported,!0,C.ErrUnSupportedPlatform),t.createPredicate(this._isTrackingDisabled,!1,C.ErrTrackingDisabled),t.createPredicate(this._isInSession,!1,C.ErrInSession),t.createPredicate(this._isValidMediaObject,!0,C.ErrInvalidMediaObject),t.createPredicate(this._isAudioTrackingSupported,!0,C.ErrAudioTrackingNotSupported)],[this._cmdConfigure,this._cmdSessionStart],this),this._ruleEngine.registerRule(B.SessionEnd,"API:trackSessionEnd",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession)],[this._cmdHandleMediaComplete,this._cmdAdSkip,this._cmdAdBreakComplete,this._cmdChapterSkip,this._cmdVideoEnd,this._cmdSessionEnd],this),this._ruleEngine.registerRule(B.VideoComplete,"API:trackComplete",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia)],[this._cmdAdSkip,this._cmdAdBreakComplete,this._cmdChapterSkip,this._cmdVideoEnd],this),this._ruleEngine.registerRule(B.Error,"API:trackError",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia)],[this._cmdError],this),this._ruleEngine.registerRule(B.Play,"API:trackPlay",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._shouldAllowPlayerStateChange,!0,C.ErrInvalidPlayerState)],[this._cmdSeekComplete,this._cmdBufferComplete,this._cmdPlay],this),this._ruleEngine.registerRule(B.Pause,"API:trackPause",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._shouldAllowPlayerStateChange,!0,C.ErrInvalidPlayerState),t.createPredicate(this._isInBuffer,!1,C.ErrInBuffer),t.createPredicate(this._isInSeek,!1,C.ErrInSeek)],[this._cmdPause],this),this._ruleEngine.registerRule(B.BufferStart,"API:trackEvent(BufferStart)",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._shouldAllowPlayerStateChange,!0,C.ErrInvalidPlayerState),t.createPredicate(this._isInBuffer,!1,C.ErrInBuffer),t.createPredicate(this._isInSeek,!1,C.ErrInSeek)],[this._cmdBufferStart],this),this._ruleEngine.registerRule(B.BufferComplete,"API:trackEvent(BufferComplete)",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._shouldAllowPlayerStateChange,!0,C.ErrInvalidPlayerState),t.createPredicate(this._isInBuffer,!0,C.ErrNotInBuffer)],[this._cmdBufferComplete],this),this._ruleEngine.registerRule(B.SeekStart,"API:trackEvent(SeekStart)",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._shouldAllowPlayerStateChange,!0,C.ErrInvalidPlayerState),t.createPredicate(this._isInSeek,!1,C.ErrInSeek),t.createPredicate(this._isInBuffer,!1,C.ErrInBuffer)],[this._cmdSeekStart],this),this._ruleEngine.registerRule(B.SeekComplete,"API:trackEvent(SeekComplete)",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._shouldAllowPlayerStateChange,!0,C.ErrInvalidPlayerState),t.createPredicate(this._isInSeek,!0,C.ErrNotInSeek)],[this._cmdSeekComplete],this),this._ruleEngine.registerRule(B.AdBreakStart,"API:trackEvent(AdBreakStart)",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._isValidAdBreakObject,!0,C.ErrInvalidAdBreakObject),t.createPredicate(this._isDifferentAdBreakObject,!0,C.ErrDuplicateAdBreakObject)],[this._cmdAdSkip,this._cmdAdBreakComplete,this._cmdAdBreakStart],this),this._ruleEngine.registerRule(B.AdBreakComplete,"API:trackEvent(AdBreakComplete)",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._isInAdBreak,!0,C.ErrNotInAdBreak)],[this._cmdAdSkip,this._cmdAdBreakComplete],this),this._ruleEngine.registerRule(B.AdStart,"API:trackEvent(AdStart)",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._isInAdBreak,!0,C.ErrNotInAdBreak),t.createPredicate(this._isValidAdObject,!0,C.ErrInvalidAdObject),t.createPredicate(this._isDifferentAdObject,!0,C.ErrDuplicateAdObject)],[this._cmdAdSkip,this._cmdAdStart],this),this._ruleEngine.registerRule(B.AdComplete,"API:trackEvent(AdComplete)",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._isInAdBreak,!0,C.ErrNotInAdBreak),t.createPredicate(this._isInAd,!0,C.ErrNotInAd)],[this._cmdAdComplete],this),this._ruleEngine.registerRule(B.AdSkip,"API:trackEvent(AdSkip)",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._isInAdBreak,!0,C.ErrNotInAdBreak),t.createPredicate(this._isInAd,!0,C.ErrNotInAd)],[this._cmdAdSkip],this),this._ruleEngine.registerRule(B.ChapterStart,"API:trackEvent(ChapterStart)",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._isValidChapterObject,!0,C.ErrInvalidChapterObject),t.createPredicate(this._isDifferentChapterObject,!0,C.ErrDuplicateChapterObject)],[this._cmdChapterSkip,this._cmdChapterStart],this),this._ruleEngine.registerRule(B.ChapterComplete,"API:trackEvent(ChapterComplete)",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._isInChapter,!0,C.ErrNotInChapter)],[this._cmdChapterComplete],this),this._ruleEngine.registerRule(B.ChapterSkip,"API:trackEvent(ChapterSkip)",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._isInChapter,!0,C.ErrNotInChapter)],[this._cmdChapterSkip],this),this._ruleEngine.registerRule(B.BitrateChange,"API:trackEvent(BitrateChange)",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia)],[this._cmdBitrate],this),this._ruleEngine.registerRule(B.TimedMetadataUpdate,"API:trackEvent(TimedMetadataUpdate)",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._isValidTimedMetadataObject,!0,C.ErrInvalidTimedMetadataObject)],[this._cmdTimedMetadataUpdate],this),this._ruleEngine.registerRule(B.DisableTracking,"Internal::DisableTracking",[t.createPredicate(this._isTrackingDisabled,!1,C.ErrTrackingDisabled)],[this._cmdDisableTracking],this),this._ruleEngine.registerRule(B.BeginReporting,"Internal::BeginReporting",[t.createPredicate(this._isInSession,!0,C.ErrNotInSession),t.createPredicate(this._isInMedia,!0,C.ErrNotInMedia),t.createPredicate(this._didBeginReporting,!1,C.ErrBeginReporting)],[this._cmdBeginReporting],this)},e.prototype._configureAdobeAnalyticsPlugin=function(){this._aaPlugin=new n(this._appMeasurement,new p(this));var a=new o;a.channel=this._config.channel?this._config.channel:"",a.debugLogging=c.MediaHeartbeat._debugLogging||this._config.debugLogging,this._aaPlugin.configure(a),this._plugins.push(this._aaPlugin)},e.prototype._configureAdobeHearbeatPlugin=function(){var a=this._appMeasurement.visitor?this._appMeasurement.visitor.marketingCloudOrgID:"";this._ahPlugin=new q(new s(this));var b=new r(this._config.trackingServer,a);b.debugLogging=c.MediaHeartbeat._debugLogging||this._config.debugLogging,b.ovp=this._config.ovp?this._config.ovp:"",b.ssl=this._config.ssl,b.sdk=this._config.appVersion?this._config.appVersion:"";var d=this._primetimeTVSDKVersion();d&&d.length>0&&(b.__primetime=!0,b.__psdkVersion=d),this._ahPlugin.configure(b),this._plugins.push(this._ahPlugin)},e.prototype._configureVideoPlayerPlugin=function(){this._playerPlugin=new k(new m(this));var a=new l;a.debugLogging=c.MediaHeartbeat._debugLogging||this._config.debugLogging,this._playerPlugin.configure(a),this._plugins.push(this._playerPlugin)},e.prototype._configureOtherPlugins=function(){if(c.plugins.nielsen&&this._config.nielsenConfigKey&&this._config.nielsenAppInfo){this._nielsenPlugin=new c.plugins.nielsen.NielsenPlugin(new c._NielsenPluginDelegate(this,this._logger));var a=new c.plugins.nielsen.NielsenPluginConfig;a.debugLogging=c.MediaHeartbeat._debugLogging||this._config.debugLogging,a.appInfo=this._config.nielsenAppInfo,a.configKey=this._config.nielsenConfigKey,this._nielsenPlugin.configure(a),this._plugins.push(this._nielsenPlugin)}},e.prototype._configureHeartbeat=function(){var a=new i;a.debugLogging=c.MediaHeartbeat._debugLogging||this._config.debugLogging,this._heartbeat=new h(new j(this),this._plugins),this._heartbeat.configure(a)},e.prototype._resetState=function(){this._taskScheduler.clearTasks(),this._privacyManager.reset(),this._mediaState={},this._plugins=[],this._playerPlugin=null,this._aaPlugin=null,this._ahPlugin=null,this._nielsenPlugin=null,this._heartbeat=null,this._currentMediaObject=null,this._currentAdBreakObject=null,this._currentAdObject=null,this._currentChapterObject=null,this._videoInfo=null,this._adBreakInfo=null,this._adInfo=null,this._chapterInfo=null,this._prerollWaitEnabled=!0,this._prerollWaitTime=O,this._playReceived=!1,this._playUnhandledFromPrerollWaitTime=!1,this._playTaskHandle=null,this._playAfterAdStart=!1},e.prototype._primetimeTVSDKVersion=function(){return this._currentMediaObject?this._currentMediaObject.getValue(M):null},e.prototype._cleanContextData=function(a){if(null==a||"object"!=typeof a)return null;var b={};for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];"number"!=typeof d&&"string"!=typeof d&&"boolean"!=typeof d||(b[c]=d)}return b},e.prototype._prepareMetadata=function(a,b){var c={};if(b&&w.append(c,b),a){var d=this._cleanContextData(a);w.append(c,d)}return delete c[L],c},e.prototype._onDelegateError=function(a){this._logger.error(D,a.getMessage()+" | "+a.getDetails())},e.prototype._onDelegateTrackingDisabled=function(){this._processRule(B.SessionEnd),this._processRule(B.DisableTracking)},e.prototype._onPrivacyChange=function(a){this._logger.info(D,"#_onPrivacyChange: Privacy Status: "+a),a===v.OPT_IN?this._processRule(B.BeginReporting):a===v.OPT_OUT&&this._processRule(B.SessionEnd)};var A={Session:0,Media:1,AdBreak:2,Ad:3,Chapter:4,PlayPause:5,Buffer:6,Seek:7,FPlayPause:8,Reporting:9},B={SessionStart:0,SessionEnd:1,VideoComplete:2,Play:3,Pause:4,Error:5,AdBreakStart:6,AdBreakComplete:7,AdStart:8,AdComplete:9,AdSkip:10,ChapterStart:11,ChapterComplete:12,ChapterSkip:13,SeekStart:14,SeekComplete:15,BufferStart:16,BufferComplete:17,BitrateChange:18,TimedMetadataUpdate:19,DisableTracking:20,BeginReporting:21},C={ErrUnSupportedPlatform:"MediaHeartbeat does not support tracking due to AppMeasurement or VisitorAPI not supporting the browser.",ErrNotInSession:\'MediaHeartbeat is not in active tracking session, call "API:trackSessionStart" to begin a new tracking session.\',ErrInSession:\'MediaHeartbeat is in active tracking session, call "API:trackSessionEnd" to end current tracking session.\',ErrNotInMedia:\'MediaHeartbeat has completed tracking session, call "API:trackSessionEnd" first to end current session and then begin a new tracking session.\',ErrInBuffer:\'MediaHeartbeat is tracking buffer events, call "API:trackEvent(BufferComplete)" first to stop tracking buffer events.\',ErrNotInBuffer:\'MediaHeartbeat is not tracking buffer events, call "API:trackEvent(BufferStart)" before "API:trackEvent(BufferComplete)".\',ErrInSeek:\'MediaHeartbeat is tracking seek events, call "API:trackEvent(SeekComplete)" first to stop tracking seek events.\',ErrNotInSeek:\'MediaHeartbeat is not tracking seek events, call "API:trackEvent(SeekStart)" before "API:trackEvent(SeekComplete)".\',ErrNotInAdBreak:\'MediaHeartbeat is not tracking any AdBreak, call "API:trackEvent(AdBreakStart)" to begin tracking AdBreak\',ErrNotInAd:\'MediaHeartbeat is not tracking any Ad, call "API:trackEvent(AdStart)" to begin tracking Ad\',ErrNotInChapter:\'MediaHeartbeat is not tracking any Chapter, call "API:trackEvent(ChapterStart)" to begin tracking Chapter\',ErrInvalidMediaObject:\'MediaInfo passed into "API:trackSessionStart" is invalid.\',ErrInvalidAdBreakObject:\'AdBreakInfo passed into "API:trackEvent(AdBreakStart)" is invalid.\',ErrDuplicateAdBreakObject:\'MediaHeartbeat is currently tracking the AdBreak passed into "API:trackEvent(AdBreakStart)".\',ErrInvalidAdObject:\'AdInfo passed into "API:trackEvent(AdStart)" is invalid.\',ErrDuplicateAdObject:\'MediaHeartbeat is currently tracking the Ad passed into "API:trackEvent(AdStart)".\',ErrInvalidChapterObject:\'ChapterInfo passed into "API:trackEvent(ChapterStart)" is invalid.\',ErrDuplicateChapterObject:\'MediaHeartbeat is currently tracking the Chapter passed into "API:trackEvent(ChapterStart)".\',ErrInvalidTimedMetadataObject:\'TimedMetadata passed into "API:trackEvent(TimedMetadataUpdate)" is invalid.\',ErrInvalidPlayerState:"MediaHeartbeat is tracking an AdBreak but not tracking any Ad and will drop any calls to track player state (Play, Pause, Buffer or Seek) in this state.",ErrAudioTrackingNotSupported:"Upgrade your AppMeasurement library to version >= \'2.11.0\' to support tracking audio content.",ErrTrackingDisabled:"MediaHeartbeat tracking is disabled for this publisher. Please contact Adobe Representative to enable tracking.",ErrBeginReporting:"MediaHeartbeat has already started reporting."},D="MediaHeartbeat",E="key_media_object",F="key_adbreak_object",G="key_ad_object",H="key_chapter_object",I="key_timed_metadata_object",J="key_custom_metadata",K="key_error_id",L="a.media.streamType",M="a.__pttvsdkVersion",N="granular_ad_tracking",O=250;c._MediaHeartbeatRule=B,c._MediaHeartbeatErrorMessage=C,c.MediaHeartbeatDelegate=d,c.MediaHeartbeat=e,c.MediaHeartbeat._debugLogging=!1}(a.ADB.core,a.ADB.va),a.ADB||(a.ADB={}),a.ADB.core||(a.ADB.core=core),a.ADB.va||(a.ADB.va=va),a.ADB.va.plugins||(a.ADB.va.plugins={})}(this);\n\n  }).call(lib);\n  exports.va = lib.ADB.va;\n  exports.core = lib.ADB.core;\n}));\n',
language:"javascript"},timeout:2e3,delayNext:!0},{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"(function() {\n\n  /* global ADB, AppMeasurement, visitor*/\n  /* TODO:\n     Verify report suites are getting data\n\n    TODO?:\n    Verify/configure tracker:\n    `window.s`\n  */\n\n  waitForObjAvailable(['AppMeasurement', 'visitor', 'ADB'], 40, function() {\n    setupHeartbeat();\n  });\n\n  var setupHeartbeat = function() {\n    'use strict';\n\n    // privates\n    var _appMeasurement = null;\n    var _mediaHeartbeatConfig = null;\n    var _mediaHeartbeatInstance = null;\n\n    // Alias ADB.va.MediaHeartbeat...\n    var MediaHeartbeat = ADB.va.MediaHeartbeat;\n    var MediaHeartbeatConfig = ADB.va.MediaHeartbeatConfig;\n\n    if ((!_appMeasurement || !_mediaHeartbeatConfig) && !_mediaHeartbeatInstance) {\n      var appMAccount = 'nbcucnbcglobal,nbcutve'; // hardcode account to correct report suite from \"old\" launch\n      _appMeasurement = new AppMeasurement(appMAccount);\n      // Set-up the AppMeasurement component using values from \"old\" launch\n      _appMeasurement.charSet = 'ISO-8859-1';\n      _appMeasurement.currencyCode = 'USD';\n      _appMeasurement.dynamicVariablePrefix = 'D=';\n      _appMeasurement.linkDownloadFileTypes = 'doc,docx,eps,jpg,png,svg,xls,ppt,pptx,pdf,xlsx,tab,csv,zip,txt,vsd,vxd,xml,js,css,rar,exe,wma,mov,avi,wmv,mp3,wav,m4v';\n      _appMeasurement.ssl = true;\n      _appMeasurement.trackExternalLinks = true;\n      _appMeasurement.trackInlineStats = true;\n      _appMeasurement.trackingServer = 'nbcume.sc.omtrdc.net';\n      _appMeasurement.trackingServerSecure = 'nbcume.sc.omtrdc.net';\n      _appMeasurement.usePlugins = true;\n      _appMeasurement.visitor = visitor;\n\n      // MediaHeartbeatConfig initialization\n      _mediaHeartbeatConfig = new MediaHeartbeatConfig();\n      _mediaHeartbeatConfig.trackingServer = 'nbcume.hb.omtrdc.net';\n      _mediaHeartbeatConfig.trackingServerSecure = 'nbcume.sc.omtrdc.net';\n      _mediaHeartbeatConfig.playerName = 'cnbclinear-web-player';\n      _mediaHeartbeatConfig.debugLogging = true; // \"old\" launch extension always logs\n      _mediaHeartbeatConfig.ssl = true;\n      _mediaHeartbeatConfig.appVersion = 'Media SDK 2.2.1';\n      _mediaHeartbeatConfig.ovp = 'theplatform';\n      _mediaHeartbeatConfig.channel = 'On-Domain';\n\n      // Add getInstance() function to global MediaHeartbeat class\n      // Creates new MediaHeartbeat instance if one does not exist\n      // Returns _mediaHeartbeatInstance\n      MediaHeartbeat.getInstance = function(delegates, config) {\n        if (!_mediaHeartbeatInstance) {\n          // Check that required delegates are passed for new MediaHeartbeat class\n          const requiredDelegates = ['getCurrentPlaybackTime', 'getQoSObject'];\n          if (typeof delegates !== 'object' || !Object.keys(delegates).every(delegate => requiredDelegates.includes(delegate))) {\n            return Promise.reject(new Error('Adobe Heartbeat MediaSDK failed to initialize: incorrect/missing delegates'));\n          }\n\n          // Replace keys in hardcoded config with param values\n          for (let key of Object.keys(config)) {\n            if (Object.prototype.hasOwnProperty.call(_mediaHeartbeatConfig, key)) {\n              _mediaHeartbeatConfig[key] = config[key];\n            }\n          }\n\n          // Instantiate new MediaHeartbeat class\n          _mediaHeartbeatInstance = new MediaHeartbeat(delegates, _mediaHeartbeatConfig, _appMeasurement);\n        }\n\n        return Promise.resolve(_mediaHeartbeatInstance);\n      };\n    }\n\n    // Attach MediaHeartbeat to window.ADB for usage on CNBC\n    window.ADB.MediaHeartbeat = MediaHeartbeat;\n  };\n\n  function waitForObjAvailable(objStrArray, tries, callback, interval=100){\n    var allObjsAvailable = function(objStrArray){\n      for (var i = 0; i < objStrArray.length; i++) {\n        var obj = ('.'+objStrArray[i]).split('.').reduce(function(prev, cur){return prev[cur]? prev[cur] : window[cur];});\n        if (typeof obj === 'undefined') {\n          return false;\n        }\n      }\n      return true;\n    };\n    if (!allObjsAvailable(objStrArray)) {\n      if (tries > 0) {\n        setTimeout(function() {\n          waitForObjAvailable(objStrArray, tries - 1, callback);\n        }, interval);\n      } else {\n        console.log('Not all objects available:%o', objStrArray);\n      }\n    } else {\n      callback();\n    }\n  }\n})();",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLd8a61eaf8fb34bd6ada3c7880a3ac4cc",name:"50 - BI Data - $t logging [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"// $t debug\n(function () {\n    if (window.$t && window.BI && window.BI.console) {\n        window.$t('bindTrack', function (e, trackingEvent) {\n            window.BI.console.log(trackingEvent.eventType, trackingEvent.eventData, '$t');\n        });\n    }\n})();",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLe8757e2eaf0a4ad880c00f366b6dc4ed",name:"20 - MPS - global Loader JS include - onetrust init",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:20}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"/* global OneTrust */\n(function() {\n  /* globals BI */\n  //** SET THIS SETTING Manualy! Needs to be \"false\" before relesaed!\n  var isStaging = false;//window?._satellite?.environment?.stage !== 'production';\n  var allBrandSettings = {\n    'cnbc.com': {\n      src: 'https://cdn.cookielaw.org/consent/29fbab1a-4edf-4f34-9e94-35f9113beb8b/otSDKStub.js',\n      integrity:'sha384-TKdmlzVmoD70HzftTw4WtOzIBL5mNx8mXSRzEvwrWjpIJ7FZ/EuX758yMDWXtRUN',\n      data: '29fbab1a-4edf-4f34-9e94-35f9113beb8b'\n    },\n    'cnbc.com_test': {\n      src: 'https://cdn.cookielaw.org/consent/29fbab1a-4edf-4f34-9e94-35f9113beb8b-test/otSDKStub.js',\n      integrity:'sha384-TKdmlzVmoD70HzftTw4WtOzIBL5mNx8mXSRzEvwrWjpIJ7FZ/EuX758yMDWXtRUN',\n      data: '29fbab1a-4edf-4f34-9e94-35f9113beb8b-test'\n    },\n  };\n  var topLevelDomain = document.location.hostname.match(/[^./]+\\.[^./]+$/)[0];\n  var brandSettings = isStaging && allBrandSettings[topLevelDomain + '_test']?allBrandSettings[topLevelDomain + '_test']:allBrandSettings[topLevelDomain];\n\n  var logEvent = (window.BI && BI.console && BI.console.build('OneTrust Init')) || Function.prototype;\n\n  /*  OneTrust Cookies Consent Notice start */\n  //Init Callback for Consent Action\n  window.addEventListener('OTConsentApplied', function () {\n    logEvent('Got consent from user ');\n    location.reload();\n  });\n\n  //Init OneTrust Library\n  (function () {\n    let ot_status = false;\n    let script_element = document.getElementsByTagName('script');\n    if(script_element) {\n      for(let i = 0; i < script_element.length; i++) {\n        if(script_element[i].src == brandSettings.src) {\n          ot_status = true;\n          logEvent('onetrust script');\n        }\n      }\n      if(ot_status == false) {\n        var s = document.createElement('script');\n        s.type = 'text/javascript';\n        s.charset = 'UTF-8';\n        s.setAttribute('data-domain-script', brandSettings.data);\n        s.setAttribute('integrity', brandSettings.integrity);\n        s.setAttribute('crossorigin', 'anonymous');\n        s.async = 0;\n        s.src = brandSettings.src;\n        var d = document.getElementsByTagName('script')[0];\n        d.parentNode.insertBefore(s, d);\n      }\n    }\n\n  })();\n  // function to pull cookie value\n  window.getCookie = function getCookie(name) {\n    var value = '; ' + document.cookie;\n    var parts = value.split('; ' + name + '=');\n    if (parts.length == 2) return parts.pop().split(';').shift();\n  };\n\n\n  // Defining a helper function to check for missing button text\n  // on elemens related to cookie preferences, and attempt to\n  // fill the missing values.\n  function populateFailedFooterButtonText({ retries = 10, millisBetweenTries = 1500 } = {}) {\n    var retriesRemaining = retries;\n    var interval = setInterval(tryPopulatingText, millisBetweenTries);\n\n    function tryPopulatingText() {\n      try {\n        retriesRemaining -= 1;\n\n        if (retriesRemaining < 0) {\n          return clearInterval(interval);\n        }\n\n        var button = document\n          .querySelector('.CNBCFooter-privacyLink.ot-sdk-show-settings');\n\n        if (button && button.innerText === '') {\n          button.innerText = OneTrust.GetDomainData().CookieSettingButtonText;\n        }\n\n        else {\n          clearInterval(interval);\n        }\n      }\n      catch {\n        // Errors most likely indicate that a necessary\n        // element or global object was not available.\n      }\n    }\n  }\n\n  window.OptanonWrapper = function() {\n    logEvent('OptanonWrapper called');\n\n    // Handling cases where the footer button that lets users manage their\n    // cookie preferences has no text to display because of timing issues.\n    populateFailedFooterButtonText();\n\n    // var OABCcookieName = 'OptanonAlertBoxClosed';\n    // var bannerAcceptBtn = document.getElementById('onetrust-accept-btn-handler');\n    // var pcAllowAllBtn = document.getElementById('accept-recommended-btn-handler');\n    // var pcSaveBtn = document.getElementsByClassName('save-preference-btn-handler onetrust-close-btn-handler button-theme')[0];\n    // var OABCcookie = getCookie(OABCcookieName);\n\n    // IF logic needed here because ot-banner-sdk DIV is not injected on page loads if banner is not exposed\n    /* Disabled individual button actions to test callback refresh\n    if (!OABCcookie && bannerAcceptBtn) {\n      bannerAcceptBtn.addEventListener('click', function() {\n          console.log(\"Allowed all via Banner\");\n          location.reload();\n      });\n    }\n    if (pcAllowAllBtn) {\n    pcAllowAllBtn.addEventListener('click', function() {\n      console.log(\"Allowed all via Preference Center\");\n      location.reload();\n    });\n    }\n    if (pcSaveBtn) {\n    pcSaveBtn.addEventListener('click', function() {\n      console.log(\"Set custom settings via Preference Center\");\n      location.reload();\n    });\n    }\n    */\n  };\n\n  /*  OOneTrust IAB US Privacy (USP)  */\n  (function() {\n    var s = document.createElement('script');\n    s.type = 'text/javascript';\n    s.charset = 'UTF-8';\n    s.setAttribute('ccpa-opt-out-ids', 'USP');\n    s.setAttribute('ccpa-opt-out-geo', 'US');\n    s.setAttribute('ccpa-opt-out-lspa', 'false');\n    s.async = 0;\n    s.src = 'https://cdn.cookielaw.org/opt-out/otCCPAiab.js';\n    var d = document.getElementsByTagName('script')[0];\n    d.parentNode.insertBefore(s, d);\n  })();\n  /*  OOneTrust IAB US Privacy (USP) end  */\n  logEvent('OneTrust: Optanon Init Load');\n  /*  OneTrust Cookies Consent Notice end */\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLec6830233f674710ba14c4f0d4db17a3",name:"50 - True Anthem Tag [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"/* globals BI, mps */\nfunction trueAnthemTag() {\n  var head = document.getElementsByTagName('head')[0];\n  var script = document.createElement('script');\n  var address = 'https://tru.am/scripts/custom/nbcuniversal.js';\n\n  script.type = 'text/javascript';\n  script.src = address;\n  head.appendChild(script);\n}\n\n// OneTrust GDPR Wrapper for True Anthem Tag\n// Category 4 - Marketing, Targeted Advertising and General Analytics\n(function() {\n  BI.waitForObjAvailable(['mps', 'mps.geo', 'mps.geo.data'], 40, function() {\n    if (mps) {\n      mps.optCAT4Enabled = true;\n      var optanonCookie =\n        document &&\n        document.cookie &&\n        document.cookie\n          .split(';')\n          .map(s => s.trim())\n          .find(s => s.startsWith('OptanonConsent'));\n      var categoryEnabledRegexC4 = /groups=[^&]*%2C4%3A1/;\n      mps.optConsentAdMeasurement = categoryEnabledRegexC4.test(optanonCookie);\n\n      if (mps.geo.inGroup('eea')) {\n        if (mps.optConsentAdMeasurement) {\n          mps.optCAT4Enabled = true;\n        } else {\n          mps.optCAT4Enabled = false;\n        }\n      }\n\n      if(mps.optCAT4Enabled == true) {\n        //Marketing and Targeted Advertising tracking code goes here\n        console.log('True Anthem Tag - CAT4 - Enabled');\n        trueAnthemTag();\n      } else {\n        console.log('True Anthem Tag - CAT4 - Disabled');\n      }\n    }\n  });\n})();",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLee41d97b35964a4993013a38d4df1448",name:"50 - GTag - pixel_tracking_request [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3},{modulePath:"core/src/lib/conditions/pathAndQuerystring.js",settings:{paths:[{value:"https://www.cnbc.com/the-chart-signals-that-top-investing-pros-use/?__source=Pro|paid|wpromote|search|google|leadgen|chartsignalstopinvestingprosuse&tpcc=Pro|paid|wpromote|search|google|leadgen|chartsignalstopinvestingprosuse#no_universal_links",valueIsRegex:!0}]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"/* globals BI */\nfunction loadScript(script) {\n  var s = document.createElement('script'),\n    el = document.getElementsByTagName('script')[0];\n  s.async = true;\n  s.src = (document.location.protocol == 'https:' ? 'https://' : 'http://') + script;\n  el.parentNode.insertBefore(s, el);\n}\n\n\n(function() {\n  function captureEmailLanding() {\n\n    loadScript('www.googletagmanager.com/gtag/js?id=AW-304008397');\n\n    window.dataLayer = window.dataLayer || [];\n\n    function gtag() {\n      window.dataLayer.push(arguments);\n    }\n\n    gtag('js', new Date());\n    gtag('config', 'AW-304008397');\n\n    const reportGtagConversion = function (sendTo) {\n      gtag('event', 'conversion', {\n        send_to: sendTo,\n      });\n    };\n\n    const buttonElementConditions = function (buttonNodeEvent) {\n      const componentSubmitId = buttonNodeEvent.id === 'whitePaperFormSubmit';\n      const freeDownloadTextContent = buttonNodeEvent.textContent === 'FREE DOWNLOAD';\n      const typeSubmit = buttonNodeEvent.type === 'submit';\n\n      return componentSubmitId && freeDownloadTextContent && typeSubmit;\n\n    };\n\n    const clickEventFilter = function (bteEvent) {\n      const hasEventObject = Object.prototype.hasOwnProperty.call(bteEvent, 'eventObject');\n      const isObject = typeof bteEvent.eventObject === 'object';\n      const isHTMLElement = bteEvent.eventObject instanceof HTMLElement;\n\n      if (hasEventObject && isObject && isHTMLElement) {\n        const nodeEvent = bteEvent.eventObject;\n        if (nodeEvent.tagName === 'BUTTON') {\n          return buttonElementConditions(nodeEvent);\n        }\n      }\n      return false;\n\n    };\n\n    BI.waitForObjAvailable(['__EventBus__'], 50, function() {\n      window.__EventBus__.on('click', function (e) {\n        if (clickEventFilter(e)) {\n          reportGtagConversion('AW-304008397/UiuHCOn9svICEM2Z-5AB');\n        }\n      });\n    });\n  }\n\n  BI.wrapWithOneTrust({\n    fn: captureEmailLanding,\n    featureName: 'Email Landing Gtag Conversion Capture',\n    categories: [4,7]\n  });\n})();",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLf1cc118a2f7e49c3b89bafa147762aaf",name:"30 - Parsely [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return new Promise((function(e){BI.waitForObjAvailable(["__CNBC_META_DATA","__CNBC_META_DATA.queryParams"],50,(function(){const t=["mobile-native","native-tablet","native-android-mobile","native-android-tablet"];(e=>{if("object"!=typeof e||!e.$DEVICE$)return!1;const n=e?.$DEVICE$;return"string"==typeof n?t.includes(n):!!Array.isArray(n)&&n.some((e=>t.includes(e)))})(__CNBC_META_DATA.queryParams)?e(!1):e(!0)}))}))}},timeout:6e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"/* global mps, BI, PARSELY, __CNBC_META_DATA */\n(function() {\n  function resolveUser({timeLimit = 3000 } = {}) {\n    return new Promise((resolve) => {\n      let didTimeout = false;\n\n      let timeout = setTimeout(function() {\n        didTimeout = true;\n        resolve(undefined);\n      }, timeLimit);\n\n      BI.waitForObjAvailable(['__CNBC_META_DATA.user'], (timeLimit/100), function() {\n        if (didTimeout) return;\n\n        clearTimeout(timeout);\n        resolve(__CNBC_META_DATA.user);\n      });\n    });\n  }\n  function loadParsely(){\n    const cnbcParsely = {\n      autotrack: false,\n      onReady: function() {\n        const getUserType = async function () {\n          const user = await resolveUser();\n          let usertyperesult;\n          if (!user) {\n            usertyperesult = 'anonymous';\n          } else if (user.isPro) {\n            usertyperesult = 'logged-in-pro';\n          } else if (user.isInvestingClubUser) {\n            usertyperesult = 'logged-in-investingclub';\n          } else {\n            usertyperesult = 'logged-in';\n          }\n          return usertyperesult;\n        };\n        const getContentType = function () {\n          let isInvestingClubContent = false;\n          let contentypestatus;\n          if (__CNBC_META_DATA && __CNBC_META_DATA.contentClassification && __CNBC_META_DATA.contentClassification.includes('investingClub')) {\n            isInvestingClubContent = true;\n          }\n          if (__CNBC_META_DATA.premium == true && __CNBC_META_DATA.native != true){\n            contentypestatus = 'Pro' ;\n          }\n          else if (isInvestingClubContent) {\n            contentypestatus = 'investingclub';\n          }\n          else{\n            contentypestatus ='free';\n          }\n          return contentypestatus;\n        };\n        getUserType().then((userType) => {\n          PARSELY.updateDefaults({\n            data: {\n              user_type: userType,\n              content_type: getContentType()\n            }\n          });\n          PARSELY.beacon.trackPageView();\n        });\n      }\n    };\n    window.PARSELY = window.PARSELY ? Object.assign( window.PARSELY, cnbcParsely ) : cnbcParsely;\n    (function(d) {\n      // replace with the domain of your site (e.g. parsely.com)\n      switch (true)\n      {\n        case location.hostname == 'www.cnbc.com':\n        case location.hostname == 'dealornodeal.cnbc.com':\n          mps.site = 'cnbc.com';\n          break;\n        case location.hostname == 'stg-02deal.cnbc.com':\n          mps.site = 'stg-02web.cnbc.com';\n          break;\n        case (location.hostname.indexOf('qa') != -1 ) && (location.hostname.indexOf('buffett.cnbc.com') != -1):\n        case (location.hostname.indexOf('dev') != -1 ) && (location.hostname.indexOf('buffett.cnbc.com') != -1):\n          mps.site = 'sandbox.buffett.cnbc.com';\n          break;\n        case (location.hostname.indexOf('qa') != -1 ) && (location.hostname.indexOf('acorns.com') != -1):\n        case (location.hostname.indexOf('dev') != -1 ) && (location.hostname.indexOf('acorns.com') != -1):\n          mps.site = 'sandbox.grow.acorns.com';\n          break;\n        case (location.hostname.indexOf('qa') != -1 ) && (location.hostname.indexOf('cnbc.com') != -1):\n        case (location.hostname.indexOf('dev') != -1 ) && (location.hostname.indexOf('cnbc.com') != -1):\n        case (location.hostname.indexOf('sandbox') != -1 ) && (location.hostname.indexOf('cnbc.com') != -1):\n        case (location.hostname.indexOf('localhost') != -1 ):\n          mps.site = 'sandbox.cnbc.com';\n          break;\n        default:\n          mps.site = location.hostname;\n      }\n      if (!window.PARSELY){\n        window.PARSELY = {video:{autotrack:false}};\n      }\n      if(!location.href.includes('/datapreview/')){\n        const site = mps.site,\n          b = d.body,\n          e = d.createElement('div');\n        e.innerHTML = '<span id=\"parsely-cfg\" data-parsely-site=\"'+site+'\"></span>';\n        e.id = 'parsely-root';\n        e.style.display = 'none';\n        b.appendChild(e);\n      }\n    })(document);\n    (function(s, p, d) {\n      const h = d.location.protocol;\n      const i = p+'-'+s;\n      const r = d.getElementById(p+'-root');\n      const u = h==='https:' ? 'd1z2jf7jlzjs58.cloudfront.net'\n        :'static.'+p+'.com';\n      let e = d.getElementById(i);\n      if (e) return;\n      e = d.createElement(s); e.id = i; e.async = true;\n      e.src = h+'//'+u+'/p.js'; r.appendChild(e);\n    })('script', 'parsely', document);\n    (function() {\n      if(__CNBC_META_DATA && (__CNBC_META_DATA.id == 100003784 || __CNBC_META_DATA.id == 404 || __CNBC_META_DATA.id == 405)) {\n        return;\n      }\n      let count = 0;\n      const timer = setInterval(function(){\n        if(count > 60 || (window.PARSELY && PARSELY.config && PARSELY.config.parsely_site_uuid) ) {\n          clearInterval(timer);\n          profileBeacon();\n        }\n        count++;\n      }, 1000);\n      function profileBeacon() {\n        const uuid = (window.PARSELY && PARSELY.config && PARSELY.config.parsely_site_uuid) ? PARSELY.config.parsely_site_uuid : null;\n        if (!uuid) {return;}\n        const urlArray = window.location.href.split('?');\n        const url = urlArray[0];\n        const apikey = 'cnbc.com',\n          parsely_base = 'https://api.parsely.com/v2/profile?',\n          beacon = new Image();\n        beacon.src = parsely_base + 'apikey=' + apikey + '&url=' + encodeURIComponent(url) + '&uuid=' + uuid;\n      }\n    })();\n    (function () {\n      window.parselyOnRoute = window.parselyOnRoute || function (event) {\n        if (window.PARSELY && window.PARSELY.beacon) {\n          console.log('parselyOnRoute is fired on route change');\n          PARSELY.beacon.trackPageView({\n            url: event.newPath,\n            urlref: event.currentPath,\n            js: 1\n          });\n        }\n      };\n      window.__EventBus__.remove('route', window.parselyOnRoute);\n      window.__EventBus__.on('route', window.parselyOnRoute);\n    })();\n    console.log('Parsely - CAT7 - Enabled');\n  }\n  BI.wrapWithOneTrust({\n    fn: loadParsely,\n    featureName: 'Parsely Component',\n    categories: [7],\n  });\n})();",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLf4d8345d81004f6ba49ccead9b5d5f17",name:"60 - univideo - player adapter (jw player) [univideo, d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"\n(function () {\n  /* global $t */\n\n  var logEvent = (function() {\n    var logGroup = 'uni_jwplayer';\n    var logger = function (event, data) {\n\n      if (window.BI && window.BI.console) {\n        window.BI.console.log(event, data, logGroup);\n      }\n    };\n    logger.logGroup = logGroup;\n    return logger;\n  })();\n\n  // Setting up UniVideo helper variables\n  const uniEvent = window.uniVideo?.event ?? {};\n  const uniTrack = window.uniVideo?.buildUniTrack() ?? function() {};\n\n  let videoMetadata = null;\n  let unhandledEvents = [];\n  let unhandledMetadata = {};\n\n  // Defining an object that maps JW Player event names\n  // to their counterpart in UniVideo.\n  const JWToUniVideo = Object.entries({\n    adBreakEnd: uniEvent.AD_BREAK_COMPLETE,\n    adBreakStart: uniEvent.AD_BREAK_START,\n    adComplete: uniEvent.AD_COMPLETE,\n    adPlay: uniEvent.AD_PLAY,\n    complete: uniEvent.COMPLETE,\n    fullscreen: uniEvent.FULLSCREEN,\n    pause: uniEvent.PAUSE,\n    play: uniEvent.PLAY,\n    time: uniEvent.PROGRESS,\n    seek: null,\n    meta: uniEvent.VIDEO_LOADED\n  });\n\n\n  // Converting JW Player Events to UniVideo\n  $t('on', 'cnbc_jw_player_loaded', async function(_e, data) {\n    const { JWPlayer, callingEvent } = data;\n\n    // Defining metadata that needs to come from\n    // JW Player instead of the CMS\n    const newMetadata = {\n      streamType: callingEvent === 'jwPlayerLiveStreamReadyEvent'? 'linear' : 'vod',\n      playbackAdapter: 'JW Player'\n    };\n\n    if (videoMetadata) {\n      videoMetadata = { ...videoMetadata, ...newMetadata };\n    }\n\n    else {\n      unhandledMetadata = newMetadata;\n    }\n\n    for (const [JWEventName, UniVideoEventName] of JWToUniVideo) {\n      JWPlayer.on(JWEventName, function(data) {\n        let trackEvent = true;\n        if (!UniVideoEventName) return;\n\n        if(JWEventName === 'time') {\n          uniTrack.videoData({\n            playheadPosition: data.currentTime * 1000\n          });\n        }\n\n        if(JWEventName === 'meta' && data.metadata && data.metadata.metadataType === 'discontinuity') {\n          trackEvent = false;\n        }\n\n        if(JWEventName != 'time'){\n          //skip time events since its very often\n          logEvent(JWEventName, {data, videoMetadata, unhandledEvents, trackEvent});\n        }\n        if(trackEvent){\n          if (videoMetadata){\n            uniTrack(UniVideoEventName);\n          } else{\n            unhandledEvents.push(UniVideoEventName);\n          }\n        }\n      });\n    }\n\n  });\n\n  // Converting CNBC Video Metadata to UniVideo, and creating\n  // a reference to it for later use.\n  $t('on', 'cnbc_video_metadata_loaded', function(_e, data) {\n    videoMetadata = {\n      ...convertVideoMetadataToUniVideo(data),\n      ...unhandledMetadata,\n    };\n    videoMetadata.custom['appName'] = 'CNBC';\n    if (data.jwPlayerReference && data.jwPlayerReference.version) {\n      videoMetadata.custom['playerVersion'] = data.jwPlayerReference.version;\n    }\n    // Set custom value to indicate an Adobe Live Stream\n    // The CNBC Pro player needs to report the MediaHeartbeat asset as \"Live\"\n    if (data?.playerName === 'Universal_Player_Pro') {\n      videoMetadata.custom['adobeLiveStream'] = true;\n    }\n\n    uniTrack.videoData(videoMetadata);\n\n\n    // Re-firing events that were delayed\n    // while metadata was unavailable.\n    if (unhandledEvents.length !==0 ) {\n      //remove any other load even, and only set it to first one\n      unhandledEvents.filter(item => item !== uniEvent.VIDEO_LOADED).unshift(uniEvent.VIDEO_LOADED);\n      for (const eventName of unhandledEvents) {\n        uniTrack(eventName);\n      }\n    }else{\n      //if no events were fired, fire video loaded\n      uniTrack(uniEvent.VIDEO_LOADED);\n    }\n  });\n\n\n  function convertVideoMetadataToUniVideo(_data) {\n    // Sometimes, the relevant data is on the `0` property, other times not.\n    const data = _data[0] ?? _data;\n\n    const resultMetadata = {\n      adLength: '',\n      assetID: '',\n      dateBroadcast: data.airDate || '',\n      datePublished: data.datePublished || '',\n      duration: data.duration,\n      guid: String(data.vcpsId) || String(data.id) || '',\n      mpxId: '',\n      newsNetwork: data.network || data.brand || '',\n      playInitiate: data.initiate || 'Auto', // Continuous | Manual | Auto\n      playListId: '',\n      playListLabel: '',\n      playbackAdapter: '',\n      sentiment: '',\n      source: data.section && data.section.tagNameFormattedFull || '',\n      streamType: data.subType === 'Linear'?'linear':'vod', // linear | vod\n      title: data.title || '',\n      videoCount: '',\n      videoType: '',\n      custom: data // All other data\n    };\n\n    return resultMetadata;\n  }\n\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLf9aa21d9298d4a06ad39f3bc2eb11dbf",name:"50 - Action - Piano Template [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){function e({deps:e=[],tries:t=20,interval:n=250}={}){return new Promise(((a,i)=>{let r=setTimeout((()=>{i("Objects not available")}),(t+1)*n);BI.waitForObjAvailable(e,t,(()=>{a(!0),clearTimeout(r)}),n)}))}return new Promise((async t=>{try{await e({deps:["__CNBC_META_DATA","__CNBC_META_DATA.queryParams"]});const n=["mobile-native","native-tablet","native-android-mobile","native-android-tablet"];t(!(e=>{if("object"!=typeof e||!e.$DEVICE$)return!1;const t=e?.$DEVICE$;return"string"==typeof t?n.includes(t):!!Array.isArray(t)&&t.some((e=>n.includes(e)))})(__CNBC_META_DATA.queryParams))}catch(e){t(!0)}}))}},timeout:6e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:"/* globals BI, s, $t, __CNBC_META_DATA */\n(function () {\n  const trackAdobe = (event) => {\n    const actionContextData = {\n      'cnbc.action': event.action,\n      'cnbc.platform': event.platform,\n      'cnbc.brand': event.brand,\n      'cnbc.templateId': event.templateId,\n      'cnbc.templateVariantId': event.templateVariantId,\n      'cnbc.experienceId': event.experienceId,\n      'cnbc.displayMode': event.displayMode,\n    };\n\n    s.contextData = {};\n    s.contextData = actionContextData;\n    const combinedLinkTrackVars = Object.keys(actionContextData).map((key) => `contextData.${key}`);\n    s.linkTrackVars = combinedLinkTrackVars.join(',');\n    s.tl(true, 'o', event.action);\n    s.manageVars('clearVars');\n  };\n\n  const registerTracking = () => {\n    $t('on', 'bte_event', (e, { data, eventName }) => {\n      if (eventName === 'pianoTemplateOnLoad') {\n        BI.waitForObjAvailable(['s', 's.tl', '__CNBC_META_DATA', '__CNBC_META_DATA.id'], 50, () => {\n          const eventData = {\n            action: `pianoTemplateLoaded:${__CNBC_META_DATA.id}`,\n            platform: 'web',\n            ...data.dataset,\n          };\n          // track events in Adobe\n          trackAdobe(eventData);\n        });\n      }\n    });\n  };\n\n  BI.wrapWithOneTrust({\n    fn: registerTracking,\n    featureName: 'Piano Template Tracking',\n    categories: [4,7],\n  });\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0}]},{id:"RLfa89983f3dc94f1cad69f0bbf9ffdeae",name:"50 - Action - Account Subscription [d:cnbc.com]",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["cnbc.com"]},timeout:2e3}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,
source:"/* globals BI, __CNBC_META_DATA, mParticle, s, $t */\n(function () {\n  function trackAdobe(event) {\n    const actionContextData = {\n      'cnbc.action': event.action,\n      'cnbc.brand': event.brand,\n      'cnbc.platform': event.platform,\n    };\n    if (event.autoRenewFlag) actionContextData['cnbc.autorenewflag'] = event.autoRenewFlag;\n\n    s.contextData = { ...s.contextData, ...actionContextData };\n    s.linkTrackVars = false;\n    const combinedLinkTrackVars = Object.keys(actionContextData).map(key => `contextData.${key}`);\n    s.linkTrackVars = combinedLinkTrackVars.join(',');\n    s.tl(true, 'o', event.action, null, 'navigate');\n\n    for (var item in actionContextData) {\n      delete s.contextData[item];\n    }\n  }\n\n  function trackMparticle(event) {\n    const actionContextData = {\n      'Page Name': event.pageName,\n      'Page Type': event.pageType,\n      'Article ID': event.articleId,\n      'Flow': event.flow,\n      'Platform': event.platform,\n      'Product': event.product,\n      'Referrer': event.referrer,\n      'User Agent': event.userAgent,\n      'Page URL': event.pageUrl,\n    };\n    if (event.autoRenewFlag) actionContextData['Auto Renew Flag'] = event.autoRenewFlag;\n\n    mParticle.logEvent(\n      event.action, // Event Name\n      mParticle.EventType.Navigation, // Event Type\n      actionContextData, // Event Attributes (custom)\n    );\n  }\n\n  // Builds an object of all values used by Adobe and mParticle from\n  // raw event data, __CNBC_META_DATA, window, and document properties\n  function convertEventData(raw) {\n    const eventObject = {\n      action: raw.action,\n      articleId: __CNBC_META_DATA.id || 'null',\n      brand: __CNBC_META_DATA.brand || 'NA',\n      flow: raw.flowName,\n      platform: raw.platform,\n      product: raw.product,\n      referrer: document.referrer,\n      userAgent: navigator.userAgent,\n      pageName: __CNBC_META_DATA.pageName || 'null',\n      pageType: __CNBC_META_DATA.type || 'null',\n      pageUrl: window.location.toString(),\n    };\n    // Add autorenewflag if it exists. Cast boolean to string.\n    if (Object.prototype.hasOwnProperty.call(raw,'autorenewflag') && raw.autorenewflag !== null) eventObject.autoRenewFlag = `${raw.autorenewflag}`;\n\n    return eventObject;\n  }\n\n  $t('on', 'bte_event', (e, { data, eventName }) => {\n    if (\n      eventName === 'subscriptionsFlow' &&\n      data.dataset?.analyticId?.startsWith('Account:Subscription:')\n    ) {\n      const {\n        analyticId: action,\n        autorenewflag = null,\n        analyticFlow = null,\n      } = data.dataset; // Destructure data from BTE event\n\n      // Build event object\n      const eventData = convertEventData({\n        action,\n        autorenewflag,\n        analyticFlow,\n        flowName: 'Account Subscriptions', // Hardcoded: friendly string\n        platform: 'web', // Hardcoded: should come from the page\n        product: 'cnbc.com', // Hardcoded: should come from the page\n      });\n\n      BI.waitForObjAvailable(['mParticle', 's', 's.tl'], 50, () => {\n        // track events in Adobe & mParticle\n        trackAdobe(eventData);\n        trackMparticle(eventData);\n      });\n    }\n  });\n})();\n",language:"javascript"},timeout:2e3,delayNext:!0}]}]};var _satellite=function(){"use strict";function e(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function t(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach((function(e){a[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}function n(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})})),t}function a(e){var t={exports:{}};return e(t,t.exports),t.exports}function i(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))}function r(e){return Boolean(e&&void 0!==e.length)}function o(){}function s(e,t){return function(){e.apply(t,arguments)}}function c(e){if(!(this instanceof c))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],h(e,this)}function l(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,c._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var a;try{a=n(e._value)}catch(e){return void u(t.promise,e)}d(t.promise,a)}else(1===e._state?d:u)(t.promise,e._value)}))):e._deferreds.push(t)}function d(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof c)return e._state=3,e._value=t,void p(e);if("function"==typeof n)return void h(s(n,t),e)}e._state=1,e._value=t,p(e)}catch(t){u(e,t)}}function u(e,t){e._state=2,e._value=t,p(e)}function p(e){2===e._state&&0===e._deferreds.length&&c._immediateFn((function(){e._handled||c._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)l(e,e._deferreds[t]);e._deferreds=null}function g(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function h(e,t){var n=!1;try{e((function(e){n||(n=!0,d(t,e))}),(function(e){n||(n=!0,u(t,e))}))}catch(e){if(n)return;n=!0,u(t,e)}}function _(e){return!0===Ve(e)&&"[object Object]"===Object.prototype.toString.call(e)}function f(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function m(e){return"string"==typeof e&&-1!==e.indexOf("[")&&-1!==e.indexOf("]")}function b(e){return e.substr(0,e.indexOf("["))}function v(e,t,n){if(e.length&&Ue(t)){var a=e[0];if(1!==e.length){var i=e.slice(1);if(!m(a))return v(i,t[a],n);var r=t[a=b(a)];Array.isArray(r)&&r.forEach((function(e){return v(i,e,n)}))}else t.hasOwnProperty(a)&&"string"==typeof t[a]&&(t[a]=n(t[a]))}}if(window.atob){var y=document,E=Object.getOwnPropertySymbols,S=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable,T=t()?Object.assign:function(t){for(var n,a,i=e(t),r=1;r<arguments.length;r++){for(var o in n=Object(arguments[r]))S.call(n,o)&&(i[o]=n[o]);if(E){a=E(n);for(var s=0;s<a.length;s++)P.call(n,a[s])&&(i[a[s]]=n[a[s]])}}return i},A=T,C=window,k=function(e,t,n,a){var i,r=Boolean(t&&Array.isArray(n)),o=Boolean(r&&e),s=document.createElement("a");if(r){var c=function(){var e=new Error("Unable to find the Library Embed Code for Dynamic Host Resolution.");throw e.code="dynamic_host_resolver_constructor_error",e};if(e&&(/^((https?:)?\/\/).+/.test(e)||c(),/^\/\/.+/.test(e)?s.href=C.location.protocol+e:s.href=e),s.hostname||c(),-1===n.indexOf(s.hostname)){var l=new Error("This library is not authorized for this domain. Please contact your CSM for more information.");throw l.code="dynamic_host_not_allowed",l}}var d=function(){if(null!=i)return i;if(o){var e=s.host;/:80$/.test(e)?e=e.replace(":80",""):/:80\/$/.test(e)?e=e.replace(":80/",""):/:443$/.test(e)?e=e.replace(":443",""):/:443\/$/.test(e)&&(e=e.replace(":443/","")),i=s.protocol+"//"+e}else i="";return i},u=function(e){return o&&"string"==typeof e?[d(),"/"===e.charAt(0)?e.slice(1):e].join("/"):e},p={getTurbineHost:d,decorateWithDynamicHost:u,get isDynamicEnforced(){return r}};return C&&a.onDebugChanged((function(e){e?C.dynamicHostResolver=p:delete C.dynamicHostResolver})),p},w=function(e){var t=[];return e.forEach((function(e){e.events&&e.events.forEach((function(n){t.push({rule:e,event:n})}))})),t.sort((function(e,t){return e.event.ruleOrder-t.event.ruleOrder}))},I="debug",D=function(e,t){var n=function(){return"true"===e.getItem(I)},a=function(t){e.setItem(I,t)},i=[],r=function(e){i.push(e)};return t.outputEnabled=n(),{onDebugChanged:r,getDebugEnabled:n,setDebugEnabled:function(e){n()!==e&&(a(e),t.outputEnabled=e,i.forEach((function(t){t(e)})))}}},N="Module did not export a function.",B=function(e,t,n){return function(a,i,r){r=r||[];var o=e.getModuleExports(a.modulePath);if("function"!=typeof o)throw new Error(N);var s=e.getModuleDefinition(a.modulePath),c=a.settings||{};!a.hasTransformedFilePaths&&s.filePaths&&(n(c,s.filePaths,a.modulePath),a.hasTransformedFilePaths=!0);var l=t(c,i);return o.bind(null,l).apply(null,r)}},O=function(e){return"string"==typeof e?e.replace(/\s+/g," ").trim():e},M={LOG:"log",INFO:"info",DEBUG:"debug",WARN:"warn",ERROR:"error"},L="\ud83d\ude80",R=10===parseInt((/msie (\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1])?"[Launch]":L,x=!1,j=function(e){if(x&&window.console){var t=Array.prototype.slice.call(arguments,1);t.unshift(R),e!==M.DEBUG||window.console[e]||(e=M.INFO),window.console[e].apply(window.console,t)}},F=j.bind(null,M.LOG),V=j.bind(null,M.INFO),U=j.bind(null,M.DEBUG),H=j.bind(null,M.WARN),K=j.bind(null,M.ERROR),Y=function(){var e=x;x=!0,j.apply(null,Array.prototype.concat(M.WARN,Array.prototype.slice.call(arguments))),e||(x=!1)},q={log:F,info:V,debug:U,warn:H,error:K,deprecation:Y,get outputEnabled(){return x},set outputEnabled(e){x=e},createPrefixedLogger:function(e){var t="["+e+"]";return{log:F.bind(null,t),info:V.bind(null,t),debug:U.bind(null,t),warn:H.bind(null,t),error:K.bind(null,t)}}},G="com.adobe.reactor.",W=function(e,t){var n=G+(t||"");return{getItem:function(t){try{return C[e].getItem(n+t)}catch(e){return null}},setItem:function(t,a){try{return C[e].setItem(n+t,a),!0}catch(e){return!1}}}},$="dataElements.",z=W("sessionStorage",$),Q=W("localStorage",$),J={PAGEVIEW:"pageview",SESSION:"session",VISITOR:"visitor"},Z={},X=function(e){var t;try{t=JSON.stringify(e)}catch(e){}return t},ee={setValue:function(e,t,n){var a;switch(t){case J.PAGEVIEW:return void(Z[e]=n);case J.SESSION:return void((a=X(n))&&z.setItem(e,a));case J.VISITOR:return void((a=X(n))&&Q.setItem(e,a))}},getValue:function(e,t){var n;switch(t){case J.PAGEVIEW:return Z.hasOwnProperty(e)?Z[e]:null;case J.SESSION:return null===(n=z.getItem(e))?n:JSON.parse(n);case J.VISITOR:return null===(n=Q.getItem(e))?n:JSON.parse(n)}}},te=function(e,t,n,a){return"Failed to execute data element module "+e.modulePath+" for data element "+t+". "+n+(a?"\n"+a:"")},ne=function(e,t,n,a,i){return function(r,o){var s=t(r);if(!s)return a?"":void 0;var c,l,d=s.storageDuration;try{c=e.getModuleExports(s.modulePath),l=e.getModuleDefinition(s.modulePath)}catch(e){return void q.error(te(s,r,e.message,e.stack))}if("function"==typeof c){var u,p=s.settings||{};!s.hasTransformedFilePaths&&l.filePaths&&(i(p,l.filePaths,s.modulePath),s.hasTransformedFilePaths=!0);try{u=c(n(p,o),o)}catch(e){return void q.error(te(s,r,e.message,e.stack))}return d&&(null!=u?ee.setValue(r,d,u):u=ee.getValue(r,d)),null==u&&null!=s.defaultValue&&(u=s.defaultValue),"string"==typeof u&&(s.cleanText&&(u=O(u)),s.forceLowerCase&&(u=u.toLowerCase())),u}q.error(te(s,r,"Module did not export a function."))}},ae={text:function(e){return e.textContent},cleanText:function(e){return O(e.textContent)}},ie=function(e,t,n){for(var a,i=e,r=0,o=t.length;r<o;r++){if(null==i)return;var s=t[r];if(n&&"@"===s.charAt(0)){var c=s.slice(1);i=ae[c](i)}else if(i.getAttribute&&(a=s.match(/^getAttribute\((.+)\)$/))){var l=a[1];i=i.getAttribute(l)}else i=i[s]}return i},re=function(e,t,n){return function(a,i){var r;if(t(a))r=n(a,i);else{var o=a.split("."),s=o.shift();"this"===s?i&&(r=ie(i.element,o,!0)):"event"===s?i&&(r=ie(i,o)):"target"===s?i&&(r=ie(i.target,o)):r=ie(e[s],o)}return r}},oe=function(e,t){return function(n){var a=n.split(".")[0];return Boolean(t(n)||"this"===a||"event"===a||"target"===a||e.hasOwnProperty(a))}},se=function(e,t,n){var a={exports:{}};return e.call(a.exports,a,a.exports,t,n),a.exports},ce=function(){var e={},t=function(t){var n=e[t];if(!n)throw new Error("Module "+t+" not found.");return n},n=function(){Object.keys(e).forEach((function(e){try{a(e)}catch(n){var t="Error initializing module "+e+". "+n.message+(n.stack?"\n"+n.stack:"");q.error(t)}}))},a=function(e){var n=t(e);return n.hasOwnProperty("exports")||(n.exports=se(n.definition.script,n.require,n.turbine)),n.exports};return{registerModule:function(t,n,a,i,r){var o={definition:n,extensionName:a,require:i,turbine:r};o.require=i,e[t]=o},hydrateCache:n,getModuleExports:a,getModuleDefinition:function(e){return t(e).definition},getModuleExtensionName:function(e){return t(e).extensionName}}},le=!1,de=function(e){return function(t,n){var a=e._monitors;a&&(le||(q.warn("The _satellite._monitors API may change at any time and should only be used for debugging."),le=!0),a.forEach((function(e){e[t]&&e[t](n)})))}},ue=function(e,t,n){var a,i,r,o,s=[],c=function(a,i,r){if(!e(i))return a;s.push(i);var o=t(i,r);return s.pop(),null==o&&n?"":o};return a=function(e,t){var n=/^%([^%]+)%$/.exec(e);return n?c(e,n[1],t):e.replace(/%(.+?)%/g,(function(e,n){return c(e,n,t)}))},i=function(e,t){for(var n={},a=Object.keys(e),i=0;i<a.length;i++){var r=a[i],s=e[r];n[r]=o(s,t)}return n},r=function(e,t){for(var n=[],a=0,i=e.length;a<i;a++)n.push(o(e[a],t));return n},o=function(e,t){return"string"==typeof e?a(e,t):Array.isArray(e)?r(e,t):"object"==typeof e&&null!==e?i(e,t):e},function(e,t){return s.length>10?(q.error("Data element circular reference detected: "+s.join(" -> ")),e):o(e,t)}},pe=function(e){return function(){if("string"==typeof arguments[0])e[arguments[0]]=arguments[1];else if(arguments[0]){var t=arguments[0];for(var n in t)e[n]=t[n]}}},ge="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},he=setTimeout;c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){var n=new this.constructor(o);return l(this,new g(e,t,n)),n},c.prototype.finally=i,c.all=function(e){return new c((function(t,n){function a(e,r){try{if(r&&("object"==typeof r||"function"==typeof r)){var s=r.then;if("function"==typeof s)return void s.call(r,(function(t){a(e,t)}),n)}i[e]=r,0==--o&&t(i)}catch(e){n(e)}}if(!r(e))return n(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(e);if(0===i.length)return t([]);for(var o=i.length,s=0;s<i.length;s++)a(s,i[s])}))},c.resolve=function(e){return e&&"object"==typeof e&&e.constructor===c?e:new c((function(t){t(e)}))},c.reject=function(e){return new c((function(t,n){n(e)}))},c.race=function(e){return new c((function(t,n){if(!r(e))return n(new TypeError("Promise.race accepts an array"));for(var a=0,i=e.length;a<i;a++)c.resolve(e[a]).then(t,n)}))},c._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){he(e,0)},c._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var _e=n(Object.freeze({__proto__:null,default:c})),fe="undefined"!=typeof window&&window.Promise||void 0!==ge&&ge.Promise||_e.default||_e,me=function(e,t,n){return function(a,i,r,o){return o.then((function(){var o,s=a.delayNext;return new fe((function(t,n){var i=e(a,r,[r]);if(!s)return t();var c=a.timeout,l=new fe((function(e,t){o=setTimeout((function(){t(new Error("A timeout occurred because the action took longer than "+c/1e3+" seconds to complete. "))}),c)}));fe.race([i,l]).then(t,n)})).catch((function(e){return clearTimeout(o),e=t(e),n(a,i,e),fe.reject(e)})).then((function(){clearTimeout(o)}))}))}},be=function(e,t,n,a,i){return function(r,o,s,c){return c.then((function(){var c;return new fe((function(t,n){var a=e(r,s,[s]),i=r.timeout,o=new fe((function(e,t){c=setTimeout((function(){t(new Error("A timeout occurred because the condition took longer than "+i/1e3+" seconds to complete. "))}),i)}));fe.race([a,o]).then(t,n)})).catch((function(e){return clearTimeout(c),e=t(e),a(r,o,e),fe.reject(e)})).then((function(e){if(clearTimeout(c),!n(r,e))return i(r,o),fe.reject()}))}))}},ve=fe.resolve(),ye=function(e,t,n){return function(a,i){return a.conditions&&a.conditions.forEach((function(t){ve=e(t,a,i,ve)})),a.actions&&a.actions.forEach((function(e){ve=t(e,a,i,ve)})),ve=(ve=ve.then((function(){n(a)}))).catch((function(){}))}},Ee=function(e){return Boolean(e&&"object"==typeof e&&"function"==typeof e.then)},Se=function(e,t,n,a){return function(i,r){var o;if(i.conditions)for(var s=0;s<i.conditions.length;s++){o=i.conditions[s];try{var c=e(o,r,[r]);if(Ee(c))throw new Error("Rule component sequencing must be enabled on the property for this condition to function properly.");if(!t(o,c))return n(o,i),!1}catch(e){return a(o,i,e),!1}}return!0}},Pe=function(e,t){return function(n,a){e(n,a)&&t(n,a)}},Te=function(e){return function(t){var n=e.getModuleDefinition(t.modulePath);return n&&n.displayName||t.modulePath}},Ae=function(e){return function(t){var n=t.rule,a=t.event,i=e.getModuleDefinition(a.modulePath).name;return{$type:e.getModuleExtensionName(a.modulePath)+"."+i,$rule:{id:n.id,name:n.name}}}},Ce=function(e,t,n,a,i,r){return function(o,s){var c=s.rule,l=s.event;l.settings=l.settings||{};try{var d=i(s);t(l,null,[function(t){var a=n(d,t);o((function(){e(a,c)}))}])}catch(e){r.error(a(l,c,e))}}},ke=function(e,t,n,a){return function(i,r,o){var s=t(i);n.error(e(s,r.name,o)),a("ruleActionFailed",{rule:r,action:i})}},we=function(e,t,n,a){return function(i,r,o){var s=t(i);n.error(e(s,r.name,o)),a("ruleConditionFailed",{rule:r,condition:i})}},Ie=function(e,t,n){return function(a,i){var r=e(a);t.log('Condition "'+r+'" for rule "'+i.name+'" was not met.'),n("ruleConditionFailed",{rule:i,condition:a})}},De=function(e,t){return function(n){e.log('Rule "'+n.name+'" fired.'),t("ruleCompleted",{rule:n})}},Ne=function(e,t,n){return function(a,i){var r;if(a.actions)for(var o=0;o<a.actions.length;o++){r=a.actions[o];try{e(r,i,[i])}catch(e){return void t(r,a,e)}}n(a)}},Be=function(e,t,n,a){return function(i,r){a("ruleTriggered",{rule:r}),e?n(r,i):t(r,i)}},Oe=function(e,t,n){return'Failed to execute "'+e+'" for "'+t+'" rule. '+n.message+(n.stack?"\n"+n.stack:"")},Me=function(e,t){return t&&!e.negate||!t&&e.negate},Le=[],Re=!1,xe=function(e){Re?e():Le.push(e)},je=function(e,t,n){e(t).forEach((function(e){n(xe,e)})),Re=!0,Le.forEach((function(e){e()})),Le=[]},Fe=function(e){if(e||(e=new Error("The extension triggered an error, but no error information was provided.")),!(e instanceof Error)){var t="object"==typeof e?JSON.stringify(e):String(e);e=new Error(t)}return e},Ve=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)},Ue=function(e){var t,n;return!1!==_(e)&&("function"==typeof(t=e.constructor)&&(!1!==_(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))},He=function(e,t){return Ue(t=t||{})?t=A({},t,e):A(t,e),t.hasOwnProperty("type")||Object.defineProperty(t,"type",{get:function(){return q.deprecation("Accessing event.type in Adobe Launch has been deprecated and will be removed soon. Please use event.$type instead."),t.$type}}),t},Ke=function(e,t){return function(n,a){var i=e[n];if(i){var r=i.modules;if(r)for(var o=Object.keys(r),s=0;s<o.length;s++){var c=o[s],l=r[c];if(l.shared&&l.name===a)return t.getModuleExports(c)}}}},Ye=function(e,t){return function(){return t?e(t):{}}},qe=function(e,t,n){return function(a){if(n){var i=a.split(".");i.splice(i.length-1||1,0,"min"),a=i.join(".")}return e(t)+a}},Ge=".js",We=function(e){return e.substr(0,e.lastIndexOf("/"))},$e=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},ze=function(e,t){$e(t,Ge)||(t+=Ge);var n=t.split("/"),a=We(e).split("/");return n.forEach((function(e){e&&"."!==e&&(".."===e?a.length&&a.pop():a.push(e))})),a.join("/")},Qe=a((function(e){!function(t){if(e.exports=t(),!!0){var n=window.Cookies,a=window.Cookies=t();a.noConflict=function(){return window.Cookies=n,a}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var a in n)t[a]=n[a]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function n(a){function i(){}function r(t,n,r){if("undefined"!=typeof document){"number"==typeof(r=e({path:"/"},i.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var o=JSON.stringify(n);/^[\{\[]/.test(o)&&(n=o)}catch(e){}n=a.write?a.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in r)r[c]&&(s+="; "+c,!0!==r[c]&&(s+="="+r[c].split(";")[0]));return document.cookie=t+"="+n+s}}function o(e,n){if("undefined"!=typeof document){for(var i={},r=document.cookie?document.cookie.split("; "):[],o=0;o<r.length;o++){var s=r[o].split("="),c=s.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=t(s[0]);if(c=(a.read||a)(c,l)||t(c),n)try{c=JSON.parse(c)}catch(e){}if(i[l]=c,e===l)break}catch(e){}}return e?i[e]:i}}return i.set=r,i.get=function(e){return o(e,!1)},i.getJSON=function(e){return o(e,!0)},i.remove=function(t,n){r(t,"",e(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}return n((function(){}))}))})),Je={get:Qe.get,set:Qe.set,remove:Qe.remove},Ze=function(e,t){return new fe((function(n,a){t.onload=function(){n(t)},t.onerror=function(){a(new Error("Failed to load script "+e))}}))},Xe=function(e){var t=document.createElement("script");t.src=e,t.async=!0;var n=Ze(e,t);return document.getElementsByTagName("head")[0].appendChild(t),n},et=function(e,t,n,a){t=t||"&",n=n||"=";var i={};if("string"!=typeof e||0===e.length)return i;var r=/\+/g;e=e.split(t);var o=1e3;a&&"number"==typeof a.maxKeys&&(o=a.maxKeys);var s=e.length;o>0&&s>o&&(s=o);for(var c=0;c<s;++c){var l,d,u,p,g=e[c].replace(r,"%20"),h=g.indexOf(n);h>=0?(l=g.substr(0,h),d=g.substr(h+1)):(l=g,d=""),u=decodeURIComponent(l),p=decodeURIComponent(d),f(i,u)?Array.isArray(i[u])?i[u].push(p):i[u]=[i[u],p]:i[u]=p}return i},tt=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},nt=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(a){var i=encodeURIComponent(tt(a))+n;return Array.isArray(e[a])?e[a].map((function(e){return i+encodeURIComponent(tt(e))})).join(t):i+encodeURIComponent(tt(e[a]))})).join(t):a?encodeURIComponent(tt(a))+n+encodeURIComponent(tt(e)):""},at=a((function(e,t){t.decode=t.parse=et,t.encode=t.stringify=nt})),it="@adobe/reactor-",rt={cookie:Je,document:y,"load-script":Xe,"object-assign":A,promise:fe,"query-string":{parse:function(e){return"string"==typeof e&&(e=e.trim().replace(/^[?#&]/,"")),at.parse(e)},stringify:function(e){return at.stringify(e)}},window:C},ot=function(e){return function(t){if(0===t.indexOf(it)){var n=t.substr(it.length),a=rt[n];if(a)return a}if(0===t.indexOf("./")||0===t.indexOf("../"))return e(t);throw new Error('Cannot resolve module "'+t+'".')}},st=function(e,t,n,a,i,r,o){var s=e.extensions,c=e.buildInfo,l=e.environment,d=e.property.settings;if(s){var u=Ke(s,t);Object.keys(s).forEach((function(p){var g=s[p],h=g.settings;Array.isArray(g.filePaths)&&(h=r(h,g.filePaths));var _=Ye(a,h);if(g.modules){var f=q.createPrefixedLogger(g.displayName),m=qe(o,g.hostedLibFilesBaseUrl,c.minified),b={buildInfo:c,environment:l,property:{name:e.property.name,id:e.property.id},getDataElementValue:i,getExtensionSettings:_,getHostedLibFileUrl:m,getSharedModule:u,logger:f,propertySettings:d,replaceTokens:a,onDebugChanged:n.onDebugChanged,get debugEnabled(){return n.getDebugEnabled()}};Object.keys(g.modules).forEach((function(e){var n=g.modules[e],a=ot((function(n){var a=ze(e,n);return t.getModuleExports(a)}));t.registerModule(e,n,p,a,b)}))}})),t.hydrateCache()}return t},ct=function(e,t,n,a,i){var r=q.createPrefixedLogger("Custom Script");e.track=function(e){q.log('"'+e+'" does not match any direct call identifiers.')},e.getVisitorId=function(){return null},e.property={name:t.property.name,id:t.property.id},e.company=t.company,e.buildInfo=t.buildInfo,e.environment=t.environment,e.logger=r,e.notify=function(e,t){switch(q.deprecation("_satellite.notify is deprecated. Please use the `_satellite.logger` API."),t){case 3:r.info(e);break;case 4:r.warn(e);break;case 5:r.error(e);break;default:r.log(e)}},e.getVar=a,e.setVar=i,e.setCookie=function(e,t,n){var a="",i={};n&&(a=", { expires: "+n+" }",i.expires=n);var r='_satellite.setCookie is deprecated. Please use _satellite.cookie.set("'+e+'", "'+t+'"'+a+").";q.deprecation(r),Je.set(e,t,i)},e.readCookie=function(e){return q.deprecation('_satellite.readCookie is deprecated. Please use _satellite.cookie.get("'+e+'").'),Je.get(e)},e.removeCookie=function(e){q.deprecation('_satellite.removeCookie is deprecated. Please use _satellite.cookie.remove("'+e+'").'),Je.remove(e)},e.cookie=Je,e.pageBottom=function(){},e.setDebug=n;var o=!1;Object.defineProperty(e,"_container",{get:function(){return o||(q.warn("_satellite._container may change at any time and should only be used for debugging."),o=!0),t}})},lt=function(e,t){return function(n,a,i){return e&&Ue(n)&&Object.keys(n).length&&Array.isArray(a)&&a.length?(a.forEach((function(e){Boolean(null!=i&&/^core\/.*actions.*\/customCode\.js$/.test(i))&&"source"===e&&!n.isExternal||v(e.split("."),n,t)})),n):n}},dt=window._satellite;if(dt&&!window.__satelliteLoaded){window.__satelliteLoaded=!0;var ut=dt.container;delete dt.container;var pt=A({},ut.buildInfo);Object.defineProperty(pt,"environment",{get:function(){return q.deprecation("container.buildInfo.environment is deprecated.Please use `container.environment.stage` instead"),ut.environment.stage}}),ut.buildInfo=pt;var gt,ht=D(W("localStorage"),q),_t="";y.currentScript&&y.currentScript.getAttribute("src")&&(_t=y.currentScript.getAttribute("src"));try{gt=k(_t,Boolean(ut.company.dynamicCdnEnabled),ut.company.cdnAllowList,ht)}catch(e){throw q.warn("Please review the following error:"),e}var ft,mt=lt(gt.isDynamicEnforced,gt.decorateWithDynamicHost),bt=ce(),vt=ut.property.settings.undefinedVarsReturnEmpty,yt=ut.property.settings.ruleComponentSequencingEnabled,Et=ut.dataElements||{},St=function(e){return Et[e]},Pt=function(){return ft.apply(null,arguments)},Tt=ne(bt,St,Pt,vt,mt),At={},Ct=pe(At),kt=oe(At,St),wt=re(At,St,Tt);ft=ue(kt,wt,vt),ct(dt,ut,ht.setDebugEnabled,wt,Ct),st(ut,bt,ht,ft,Tt,mt,gt.decorateWithDynamicHost);var It=de(dt),Dt=B(bt,ft,mt),Nt=Te(bt),Bt=Ie(Nt,q,It),Ot=we(Oe,Nt,q,It),Mt=ke(Oe,Nt,q,It),Lt=De(q,It),Rt=Ce(Be(yt,Pe(Se(Dt,Me,Bt,Ot),Ne(Dt,Mt,Lt)),ye(be(Dt,Fe,Me,Ot,Bt),me(Dt,Fe,Mt),Lt),It),Dt,He,Oe,Ae(bt),q);je(w,ut.rules||[],Rt)}return dt}console.warn("Adobe Launch is unsupported in IE 9 and below.")}();